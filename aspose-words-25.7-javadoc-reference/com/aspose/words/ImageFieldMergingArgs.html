<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 19 Jul 2025 -->
<TITLE>ImageFieldMergingArgs</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Class ImageFieldMergingArgs</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A>
      <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>com.aspose.words.ImageFieldMergingArgs</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>ImageFieldMergingArgs </B><DT>extends <A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></DL>
</PRE>

<P>

<summary>
             Provides data for the <cref><A HREF="IFieldMergingCallback.html#imageFieldMerging(com.aspose.words.ImageFieldMergingArgs)" title="method in class com.aspose.words.IFieldMergingCallback">IFieldMergingCallback.imageFieldMerging(com.aspose.words.ImageFieldMergingArgs)</A></cref> event.
             <p>To learn more, visit the <a href="https://docs.aspose.com/words/net/mail-merge-and-reporting/">Mail Merge and Reporting</a> documentation article.</p></summary><remarks><p>This event occurs during mail merge when an image mail merge
             field is encountered in the document. You can respond to this event to return a
             file name, stream, or an <cref><tt>java.awt.image.BufferedImage</tt></cref> object to the mail merge
             engine so it is inserted into the document.</p><p>There are three properties available <cref><A HREF="#ImageFileName" title="property in class com.aspose.words.ImageFieldMergingArgs">ImageFileName</A></cref>,
             <cref><A HREF="#ImageStream" title="property in class com.aspose.words.ImageFieldMergingArgs">ImageStream</A></cref> and <cref><A HREF="#Image" title="property in class com.aspose.words.ImageFieldMergingArgs">Image</A></cref> to specify where the image must be taken from.
             Set only one of these properties.</p><p>To insert an image mail merge field into a document in Word, select Insert/Field command,
             then select MergeField and type Image:MyFieldName.</p></remarks><example><p><b>Example:</b></p>Shows how to insert images stored in a database BLOB field into a report.<pre>
public void imageFromBlob() throws Exception {
    Document doc = new Document(getMyDir() + "Mail merge destination - Northwind employees.docx");

    // Set up the event handler for image fields
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeImageFieldFromBlob());

    // Loads the driver
    Class.forName("net.ucanaccess.jdbc.UcanaccessDriver");

    // Open the database connection
    String connString = "jdbc:ucanaccess://" + getDatabaseDir() + "Northwind.accdb";

    // DSN-less DB connection
    java.sql.Connection conn = java.sql.DriverManager.getConnection(connString, "Admin", "");

    // Create and execute a command
    java.sql.Statement statement = conn.createStatement();
    java.sql.ResultSet resultSet = statement.executeQuery("SELECT * FROM Employees");

    DataTable table = new DataTable(resultSet, "Employees");

    // Perform mail merge
    doc.getMailMerge().executeWithRegions(table);

    // Close the database
    conn.close();

    doc.save(getArtifactsDir() + "MailMergeEvent.ImageFromBlob.docx");
}

private class HandleMergeImageFieldFromBlob implements IFieldMergingCallback {
    public void fieldMerging(final FieldMergingArgs args) {
        // Do nothing
    }

    // This is called when mail merge engine encounters Image:XXX merge field in the document.
    // You have a chance to return an Image object, file name or a stream that contains the image.
    public void imageFieldMerging(final ImageFieldMergingArgs e) {
        // The field value is a byte array, just cast it and create a stream on it
        ByteArrayInputStream imageStream = new ByteArrayInputStream((byte[]) e.getFieldValue());
        // Now the mail merge engine will retrieve the image from the stream
        e.setImageStream(imageStream);
    }
}</pre></example><example><p><b>Example:</b></p>Shows how to set the dimensions of images as MERGEFIELDS accepts them during a mail merge.<pre>
public void mergeFieldImageDimension() throws Exception {
    Document doc = new Document();

    // Insert a MERGEFIELD that will accept images from a source during a mail merge. Use the field code to reference
    // a column in the data source containing local system filenames of images we wish to use in the mail merge.
    DocumentBuilder builder = new DocumentBuilder(doc);
    FieldMergeField field = (FieldMergeField) builder.insertField("MERGEFIELD Image:ImageColumn");

    // The data source should have such a column named "ImageColumn".
    Assert.assertEquals("Image:ImageColumn", field.getFieldName());

    // Create a suitable data source.
    DataTable dataTable = new DataTable("Images");
    dataTable.getColumns().add(new DataColumn("ImageColumn"));
    dataTable.getRows().add(getImageDir() + "Logo.jpg");
    dataTable.getRows().add(getImageDir() + "Transparent background logo.png");
    dataTable.getRows().add(getImageDir() + "Enhanced Windows MetaFile.emf");

    // Configure a callback to modify the sizes of images at merge time, then execute the mail merge.
    doc.getMailMerge().setFieldMergingCallback(new MergedImageResizer(200.0, 200.0, MergeFieldImageDimensionUnit.POINT));
    doc.getMailMerge().execute(dataTable);

    doc.updateFields();
    doc.save(getArtifactsDir() + "Field.MERGEFIELD.ImageDimension.docx");
}

/// &lt;summary&gt;
/// Sets the size of all mail merged images to one defined width and height.
/// &lt;/summary&gt;
private static class MergedImageResizer implements IFieldMergingCallback {
    public MergedImageResizer(final double imageWidth, final double imageHeight, final int unit) {
        mImageWidth = imageWidth;
        mImageHeight = imageHeight;
        mUnit = unit;
    }

    public void fieldMerging(final FieldMergingArgs args) {
        throw new UnsupportedOperationException();
    }

    public void imageFieldMerging(final ImageFieldMergingArgs args) {
        args.setImageFileName(args.getFieldValue().toString());
        args.setImageWidth(new MergeFieldImageDimension(mImageWidth, mUnit));
        args.setImageHeight(new MergeFieldImageDimension(mImageHeight, mUnit));

        Assert.assertEquals(mImageWidth, args.getImageWidth().getValue());
        Assert.assertEquals(mUnit, args.getImageWidth().getUnit());
        Assert.assertEquals(mImageHeight, args.getImageHeight().getValue());
        Assert.assertEquals(mUnit, args.getImageHeight().getUnit());
        Assert.assertNull(args.getShape());
    }

    private final double mImageWidth;
    private final double mImageHeight;
    private final int mUnit;
}</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="IFieldMergingCallback.html" title="interface in com.aspose.words">IFieldMergingCallback</A></cref></DD></DL>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ========== PROPERTY SUMMARY =========== -->

<A NAME="property_summary"><!-- --></A>
<TABLE RULES="GROUPS" BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Property Getters/Setters Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="Document.html" title="class in com.aspose.words">Document</A></CODE></TD><TD><CODE><B><A HREF="#Document">getDocument</A></B>()</CODE></TD><TD ALIGN="right" ><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns the <cref><A HREF="#Document" title="property in class com.aspose.words.ImageFieldMergingArgs">Document</A></cref> object for which the mail merge is performed.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#DocumentFieldName">getDocumentFieldName</A></B>()</CODE></TD><TD ALIGN="right" ><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the name of the merge field as specified in the document.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="FieldMergeField.html" title="class in com.aspose.words">FieldMergeField</A></CODE></TD><TD><CODE><B><A HREF="#Field">getField</A></B>()</CODE></TD><TD ALIGN="right" ><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the object that represents the current merge field.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#FieldName">getFieldName</A></B>()</CODE></TD><TD ALIGN="right" ><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the name of the merge field in the data source.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.Object</CODE></TD><TD><CODE><B><A HREF="#FieldValue">getFieldValue</A></B>()</CODE></TD><TD ALIGN="right" ><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#FieldValue">setFieldValue</A></B>(java.lang.Object&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets or sets the value of the field from the data source.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.awt.image.BufferedImage</CODE></TD><TD><CODE><B><A HREF="#Image">getImage</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#Image">setImage</A></B>(java.awt.image.BufferedImage&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Specifies the image that the mail merge engine must insert into the document.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#ImageFileName">getImageFileName</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#ImageFileName">setImageFileName</A></B>(java.lang.String&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Sets the file name of the image that the mail merge engine must insert into the document.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A></CODE></TD><TD><CODE><B><A HREF="#ImageHeight">getImageHeight</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#ImageHeight">setImageHeight</A></B>(<A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A>&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Specifies the image height for the image to insert into the document.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.io.InputStream</CODE></TD><TD><CODE><B><A HREF="#ImageStream">getImageStream</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#ImageStream">setImageStream</A></B>(java.io.InputStream&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Specifies the stream for the mail merge engine to read an image from.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A></CODE></TD><TD><CODE><B><A HREF="#ImageWidth">getImageWidth</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#ImageWidth">setImageWidth</A></B>(<A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A>&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Specifies the image width for the image to insert into the document.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>int</CODE></TD><TD><CODE><B><A HREF="#RecordIndex">getRecordIndex</A></B>()</CODE></TD><TD ALIGN="right" ><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the zero based index of the record that is being merged.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="Shape.html" title="class in com.aspose.words">Shape</A></CODE></TD><TD><CODE><B><A HREF="#Shape">getShape</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#Shape">setShape</A></B>(<A HREF="Shape.html" title="class in com.aspose.words">Shape</A>&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Specifies the shape that the mail merge engine must insert into the document.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#TableName">getTableName</A></B>()</CODE></TD><TD ALIGN="right" ><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the name of the data table for the current merge operation or empty string if the name is not available.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ============ PROPERTY DETAIL ========== -->

<A NAME="property_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Property Getters/Setters Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="Document"><!-- --></A><A NAME="getDocument()"><!-- --></A><A NAME="getDocument--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getDocument</H3></TD><TD ALIGN="right" VALIGN="top"><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="Document.html" title="class in com.aspose.words">Document</A>&nbsp;<B>getDocument</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns the <cref><A HREF="#Document" title="property in class com.aspose.words.ImageFieldMergingArgs">Document</A></cref> object for which the mail merge is performed.
            </summary><example><p><b>Example:</b></p>Shows how to execute a mail merge with a custom callback that handles merge data in the form of HTML documents.<pre>
public void insertHtml() throws Exception {
    Document doc = new Document(getMyDir() + "Field sample - MERGEFIELD.docx");

    // Add a handler for the MergeField event
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertHtml());

    final String htmlText = "&lt;html&gt;\r\n&lt;h1&gt;Hello world!&lt;/h1&gt;\r\n&lt;/html&gt;";

    // Execute mail merge
    doc.getMailMerge().execute(new String[]{"htmlField1"}, new String[]{htmlText});

    // Save resulting document with a new name
    doc.save(getArtifactsDir() + "MailMergeEvent.InsertHtml.docx");
}

private class HandleMergeFieldInsertHtml implements IFieldMergingCallback {
    // This is called when merge field is actually merged with data in the document.
    public void fieldMerging(final FieldMergingArgs args) throws Exception {
        // All merge fields that expect HTML data should be marked with some prefix, e.g. 'html'
        if (args.getDocumentFieldName().startsWith("html") &amp;&amp; args.getField().getFieldCode().contains("\\b")) {
            FieldMergeField field = args.getField();

            // Insert the text for this merge field as HTML data, using DocumentBuilder
            DocumentBuilder builder = new DocumentBuilder(args.getDocument());
            builder.moveToMergeField(args.getDocumentFieldName());
            builder.write(field.getTextBefore());
            builder.insertHtml((String) args.getFieldValue());

            // The HTML text itself should not be inserted
            // We have already inserted it as an HTML
            args.setText("");
        }
    }

    public void /*IFieldMergingCallback.*/imageFieldMerging(ImageFieldMergingArgs args) {
        // Do nothing
    }
}</pre></example>
</DL>
<HR>

<A NAME="DocumentFieldName"><!-- --></A><A NAME="getDocumentFieldName()"><!-- --></A><A NAME="getDocumentFieldName--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getDocumentFieldName</H3></TD><TD ALIGN="right" VALIGN="top"><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getDocumentFieldName</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the name of the merge field as specified in the document.
            </summary><remarks><p>If you have a mapping from a document field name to a different data source field name,
            then this is the original field name as specified in the document.</p><p>If you specified a field name prefix, for example "Image:MyFieldName" in the document,
            then <cref><A HREF="#DocumentFieldName" title="property in class com.aspose.words.ImageFieldMergingArgs">DocumentFieldName</A></cref> returns field name without the prefix, that is "MyFieldName".</p></remarks><example><p><b>Example:</b></p>Shows how to execute a mail merge with a custom callback that handles merge data in the form of HTML documents.<pre>
public void insertHtml() throws Exception {
    Document doc = new Document(getMyDir() + "Field sample - MERGEFIELD.docx");

    // Add a handler for the MergeField event
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertHtml());

    final String htmlText = "&lt;html&gt;\r\n&lt;h1&gt;Hello world!&lt;/h1&gt;\r\n&lt;/html&gt;";

    // Execute mail merge
    doc.getMailMerge().execute(new String[]{"htmlField1"}, new String[]{htmlText});

    // Save resulting document with a new name
    doc.save(getArtifactsDir() + "MailMergeEvent.InsertHtml.docx");
}

private class HandleMergeFieldInsertHtml implements IFieldMergingCallback {
    // This is called when merge field is actually merged with data in the document.
    public void fieldMerging(final FieldMergingArgs args) throws Exception {
        // All merge fields that expect HTML data should be marked with some prefix, e.g. 'html'
        if (args.getDocumentFieldName().startsWith("html") &amp;&amp; args.getField().getFieldCode().contains("\\b")) {
            FieldMergeField field = args.getField();

            // Insert the text for this merge field as HTML data, using DocumentBuilder
            DocumentBuilder builder = new DocumentBuilder(args.getDocument());
            builder.moveToMergeField(args.getDocumentFieldName());
            builder.write(field.getTextBefore());
            builder.insertHtml((String) args.getFieldValue());

            // The HTML text itself should not be inserted
            // We have already inserted it as an HTML
            args.setText("");
        }
    }

    public void /*IFieldMergingCallback.*/imageFieldMerging(ImageFieldMergingArgs args) {
        // Do nothing
    }
}</pre></example>
</DL>
<HR>

<A NAME="Field"><!-- --></A><A NAME="getField()"><!-- --></A><A NAME="getField--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getField</H3></TD><TD ALIGN="right" VALIGN="top"><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="FieldMergeField.html" title="class in com.aspose.words">FieldMergeField</A>&nbsp;<B>getField</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the object that represents the current merge field.
            </summary><example><p><b>Example:</b></p>Shows how to execute a mail merge with a custom callback that handles merge data in the form of HTML documents.<pre>
public void insertHtml() throws Exception {
    Document doc = new Document(getMyDir() + "Field sample - MERGEFIELD.docx");

    // Add a handler for the MergeField event
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertHtml());

    final String htmlText = "&lt;html&gt;\r\n&lt;h1&gt;Hello world!&lt;/h1&gt;\r\n&lt;/html&gt;";

    // Execute mail merge
    doc.getMailMerge().execute(new String[]{"htmlField1"}, new String[]{htmlText});

    // Save resulting document with a new name
    doc.save(getArtifactsDir() + "MailMergeEvent.InsertHtml.docx");
}

private class HandleMergeFieldInsertHtml implements IFieldMergingCallback {
    // This is called when merge field is actually merged with data in the document.
    public void fieldMerging(final FieldMergingArgs args) throws Exception {
        // All merge fields that expect HTML data should be marked with some prefix, e.g. 'html'
        if (args.getDocumentFieldName().startsWith("html") &amp;&amp; args.getField().getFieldCode().contains("\\b")) {
            FieldMergeField field = args.getField();

            // Insert the text for this merge field as HTML data, using DocumentBuilder
            DocumentBuilder builder = new DocumentBuilder(args.getDocument());
            builder.moveToMergeField(args.getDocumentFieldName());
            builder.write(field.getTextBefore());
            builder.insertHtml((String) args.getFieldValue());

            // The HTML text itself should not be inserted
            // We have already inserted it as an HTML
            args.setText("");
        }
    }

    public void /*IFieldMergingCallback.*/imageFieldMerging(ImageFieldMergingArgs args) {
        // Do nothing
    }
}</pre></example>
</DL>
<HR>

<A NAME="FieldName"><!-- --></A><A NAME="getFieldName()"><!-- --></A><A NAME="getFieldName--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getFieldName</H3></TD><TD ALIGN="right" VALIGN="top"><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getFieldName</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the name of the merge field in the data source.
            </summary><remarks><p>If you have a mapping from a document field name to a different data source field name,
            then this is the mapped field name.</p><p>If you specified a field name prefix, for example "Image:MyFieldName" in the document,
            then <cref><A HREF="#FieldName" title="property in class com.aspose.words.ImageFieldMergingArgs">FieldName</A></cref> returns field name without the prefix, that is "MyFieldName".</p></remarks><example><p><b>Example:</b></p>Shows how to insert checkbox form fields into a document during mail merge.<pre>
public void insertCheckBox() throws Exception {
    Document doc = new Document();
    DocumentBuilder builder = new DocumentBuilder(doc);

    builder.startTable();
    builder.insertCell();
    builder.insertField(" MERGEFIELD  TableStart:StudentCourse ");
    builder.insertCell();
    builder.insertField(" MERGEFIELD  CourseName ");
    builder.insertCell();
    builder.insertField(" MERGEFIELD  TableEnd:StudentCourse ");
    builder.endTable();

    // Add a handler for the MergeField event
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertCheckBox());

    // Execute mail merge with regions
    DataTable dataTable = getStudentCourseDataTable();
    doc.getMailMerge().executeWithRegions(dataTable);

    // Save resulting document with a new name
    doc.save(getArtifactsDir() + "MailMergeEvent.InsertCheckBox.docx");
}

private class HandleMergeFieldInsertCheckBox implements IFieldMergingCallback {
    // This is called for each merge field in the document
    // when Document.MailMerge.ExecuteWithRegions is called.
    public void fieldMerging(final FieldMergingArgs args) throws Exception {
        if (args.getDocumentFieldName().equals("CourseName")) {
            // The name of the table that we are merging can be found here
            Assert.assertEquals(args.getTableName(), "StudentCourse");

            // Insert the checkbox for this merge field, using DocumentBuilder
            DocumentBuilder builder = new DocumentBuilder(args.getDocument());
            builder.moveToMergeField(args.getFieldName());
            builder.insertCheckBox(args.getDocumentFieldName() + mCheckBoxCount, false, 0);
            // Get the actual value of the field
            String fieldValue = args.getFieldValue().toString();

            // In this case, for every record index 'n', the corresponding field value is "Course n"
            Assert.assertEquals(args.getRecordIndex(), Character.getNumericValue(fieldValue.charAt(7)));

            builder.write(fieldValue);
            mCheckBoxCount++;
        }
    }

    public void imageFieldMerging(final ImageFieldMergingArgs args) {
        // Do nothing
    }

    // Counter for CheckBox name generation.
    private int mCheckBoxCount;
}

// Create DataTable and fill it with data.
// In real life this DataTable should be filled from a database.
private static DataTable getStudentCourseDataTable() throws Exception {
    DataTable dataTable = new DataTable("StudentCourse");
    dataTable.getColumns().add("CourseName");
    for (int i = 0; i &lt; 10; i++) {
        DataRow datarow = dataTable.newRow();
        dataTable.getRows().add(datarow);
        datarow.set(0, "Course " + i);
    }
    return dataTable;
}</pre></example>
</DL>
<HR>

<A NAME="FieldValue"><!-- --></A><A NAME="getFieldValue()"><!-- --></A><A NAME="getFieldValue--"><!-- --></A><A NAME="setFieldValue(java.lang.Object)"><!-- --></A><A NAME="setFieldValue-java.lang.Object-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getFieldValue/setFieldValue</H3></TD><TD ALIGN="right" VALIGN="top"><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.Object&nbsp;<B>getFieldValue</B>()&nbsp;/&nbsp;public void&nbsp;<B>setFieldValue</B>(java.lang.Object&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets or sets the value of the field from the data source.
            </summary><remarks>
            This property contains a value that has just been selected from your data source
            for this field by the mail merge engine. You can also replace the value by setting the property.
            </remarks><example><p><b>Example:</b></p>Shows how to use data source value of the field.<pre>
public void fieldFormats() throws Exception {
    Document doc = new Document();
    DocumentBuilder builder = new DocumentBuilder(doc);
    builder.insertField("MERGEFIELD TextField \\* Caps", null);
    builder.write(", ");
    builder.insertField("MERGEFIELD TextField2 \\* Upper", null);
    builder.write(", ");
    builder.insertField("MERGEFIELD NumericField \\# 0.0", null);

    builder.getDocument().getMailMerge().setFieldMergingCallback(new FieldValueMergingCallback());

    builder.getDocument().getMailMerge().execute(
            new String[]{"TextField", "TextField2", "NumericField"},
            new Object[]{"Original value", "Original value", 10});

    Assert.assertEquals("New Value, New value from FieldMergingArgs, 20.0", doc.getText().trim());
}

private static class FieldValueMergingCallback implements IFieldMergingCallback {
    /// &lt;summary&gt;
    /// This is called when merge field is actually merged with data in the document.
    /// &lt;/summary&gt;
    public void /*IFieldMergingCallback.*/fieldMerging(FieldMergingArgs e) {
        switch (e.getFieldName()) {
            case "TextField":
                Assert.assertEquals("Original value", e.getFieldValue());
                e.setFieldValue("New value");
                break;
            case "TextField2":
                Assert.assertEquals("Original value", e.getFieldValue());
                e.setText("New value from FieldMergingArgs");   // Should suppress e.FieldValue and ignore format
                e.setFieldValue("new value");
                break;
            case "NumericField":
                Assert.assertEquals(10, e.getFieldValue());
                e.setFieldValue(20);
                break;
        }
    }

    public void /*IFieldMergingCallback.*/imageFieldMerging(ImageFieldMergingArgs e) {
        // Do nothing
    }
}</pre></example>
</DL>
<HR>

<A NAME="Image"><!-- --></A><A NAME="getImage()"><!-- --></A><A NAME="getImage--"><!-- --></A><A NAME="setImage(java.awt.image.BufferedImage)"><!-- --></A><A NAME="setImage-java.awt.image.BufferedImage-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getImage/setImage</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.awt.image.BufferedImage&nbsp;<B>getImage</B>()&nbsp;/&nbsp;public void&nbsp;<B>setImage</B>(java.awt.image.BufferedImage&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Specifies the image that the mail merge engine must insert into the document.
            </summary><example><p><b>Example:</b></p>Shows how to use a callback to customize image merging logic.<pre>
public void mergeFieldImages() throws Exception {
    Document doc = new Document();

    // Insert a MERGEFIELD that will accept images from a source during a mail merge. Use the field code to reference
    // a column in the data source which contains local system filenames of images we wish to use in the mail merge.
    DocumentBuilder builder = new DocumentBuilder(doc);
    FieldMergeField field = (FieldMergeField) builder.insertField("MERGEFIELD Image:ImageColumn");

    // In this case, the field expects the data source to have such a column named "ImageColumn".
    Assert.assertEquals("Image:ImageColumn", field.getFieldName());

    // Filenames can be lengthy, and if we can find a way to avoid storing them in the data source,
    // we may considerably reduce its size.
    // Create a data source that refers to images using short names.
    DataTable dataTable = new DataTable("Images");
    dataTable.getColumns().add(new DataColumn("ImageColumn"));
    dataTable.getRows().add("Dark logo");
    dataTable.getRows().add("Transparent logo");

    // Assign a merging callback that contains all logic that processes those names,
    // and then execute the mail merge. 
    doc.getMailMerge().setFieldMergingCallback(new ImageFilenameCallback());
    doc.getMailMerge().execute(dataTable);

    doc.save(getArtifactsDir() + "Field.MERGEFIELD.Images.docx");
}

/// &lt;summary&gt;
/// Contains a dictionary that maps names of images to local system filenames that contain these images.
/// If a mail merge data source uses one of the dictionary's names to refer to an image,
/// this callback will pass the respective filename to the merge destination.
/// &lt;/summary&gt;
private static class ImageFilenameCallback implements IFieldMergingCallback {
    public ImageFilenameCallback() {
        mImageFilenames.put("Dark logo", getImageDir() + "Logo.jpg");
        mImageFilenames.put("Transparent logo", getImageDir() + "Transparent background logo.png");
    }

    public void fieldMerging(FieldMergingArgs args) {
        throw new UnsupportedOperationException();
    }

    public void imageFieldMerging(ImageFieldMergingArgs args) throws IOException {
        if (mImageFilenames.containsKey(args.getFieldValue().toString())) {
            args.setImage(ImageIO.read(new File(mImageFilenames.get(args.getFieldValue().toString()))));
        }

        Assert.assertNotNull(args.getImage());
    }

    private final HashMap&lt;String, String&gt; mImageFilenames = new HashMap&lt;&gt;();
}</pre></example>
</DL>
<HR>

<A NAME="ImageFileName"><!-- --></A><A NAME="getImageFileName()"><!-- --></A><A NAME="getImageFileName--"><!-- --></A><A NAME="setImageFileName(java.lang.String)"><!-- --></A><A NAME="setImageFileName-java.lang.String-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getImageFileName/setImageFileName</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getImageFileName</B>()&nbsp;/&nbsp;public void&nbsp;<B>setImageFileName</B>(java.lang.String&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Sets the file name of the image that the mail merge engine must insert into the document.
            </summary><example><p><b>Example:</b></p>Shows how to set the dimensions of images as MERGEFIELDS accepts them during a mail merge.<pre>
public void mergeFieldImageDimension() throws Exception {
    Document doc = new Document();

    // Insert a MERGEFIELD that will accept images from a source during a mail merge. Use the field code to reference
    // a column in the data source containing local system filenames of images we wish to use in the mail merge.
    DocumentBuilder builder = new DocumentBuilder(doc);
    FieldMergeField field = (FieldMergeField) builder.insertField("MERGEFIELD Image:ImageColumn");

    // The data source should have such a column named "ImageColumn".
    Assert.assertEquals("Image:ImageColumn", field.getFieldName());

    // Create a suitable data source.
    DataTable dataTable = new DataTable("Images");
    dataTable.getColumns().add(new DataColumn("ImageColumn"));
    dataTable.getRows().add(getImageDir() + "Logo.jpg");
    dataTable.getRows().add(getImageDir() + "Transparent background logo.png");
    dataTable.getRows().add(getImageDir() + "Enhanced Windows MetaFile.emf");

    // Configure a callback to modify the sizes of images at merge time, then execute the mail merge.
    doc.getMailMerge().setFieldMergingCallback(new MergedImageResizer(200.0, 200.0, MergeFieldImageDimensionUnit.POINT));
    doc.getMailMerge().execute(dataTable);

    doc.updateFields();
    doc.save(getArtifactsDir() + "Field.MERGEFIELD.ImageDimension.docx");
}

/// &lt;summary&gt;
/// Sets the size of all mail merged images to one defined width and height.
/// &lt;/summary&gt;
private static class MergedImageResizer implements IFieldMergingCallback {
    public MergedImageResizer(final double imageWidth, final double imageHeight, final int unit) {
        mImageWidth = imageWidth;
        mImageHeight = imageHeight;
        mUnit = unit;
    }

    public void fieldMerging(final FieldMergingArgs args) {
        throw new UnsupportedOperationException();
    }

    public void imageFieldMerging(final ImageFieldMergingArgs args) {
        args.setImageFileName(args.getFieldValue().toString());
        args.setImageWidth(new MergeFieldImageDimension(mImageWidth, mUnit));
        args.setImageHeight(new MergeFieldImageDimension(mImageHeight, mUnit));

        Assert.assertEquals(mImageWidth, args.getImageWidth().getValue());
        Assert.assertEquals(mUnit, args.getImageWidth().getUnit());
        Assert.assertEquals(mImageHeight, args.getImageHeight().getValue());
        Assert.assertEquals(mUnit, args.getImageHeight().getUnit());
        Assert.assertNull(args.getShape());
    }

    private final double mImageWidth;
    private final double mImageHeight;
    private final int mUnit;
}</pre></example>
</DL>
<HR>

<A NAME="ImageHeight"><!-- --></A><A NAME="getImageHeight()"><!-- --></A><A NAME="getImageHeight--"><!-- --></A><A NAME="setImageHeight(com.aspose.words.MergeFieldImageDimension)"><!-- --></A><A NAME="setImageHeight-com.aspose.words.MergeFieldImageDimension-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getImageHeight/setImageHeight</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A>&nbsp;<B>getImageHeight</B>()&nbsp;/&nbsp;public void&nbsp;<B>setImageHeight</B>(<A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A>&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Specifies the image height for the image to insert into the document.
            </summary><remarks><p>
            The value of this property initially comes from the corresponding MERGEFIELD's code, contained in the
            template document. To override the initial value, you should assign an instance of
            <cref><A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A></cref> class to this property or set the properties for the instance
            of <cref><A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A></cref> class, returned by this property.
            </p><p>
            To indicate that the original value of the image height should be applied, you should assign the <code>null</code>
            value to this property or set the <cref><A HREF="MergeFieldImageDimension.html#Value" title="property in class com.aspose.words.MergeFieldImageDimension">MergeFieldImageDimension.Value</A></cref> property for the instance
            of <cref><A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A></cref> class, returned by this property, to a negative value.
            </p></remarks><example><p><b>Example:</b></p>Shows how to set the dimensions of images as MERGEFIELDS accepts them during a mail merge.<pre>
public void mergeFieldImageDimension() throws Exception {
    Document doc = new Document();

    // Insert a MERGEFIELD that will accept images from a source during a mail merge. Use the field code to reference
    // a column in the data source containing local system filenames of images we wish to use in the mail merge.
    DocumentBuilder builder = new DocumentBuilder(doc);
    FieldMergeField field = (FieldMergeField) builder.insertField("MERGEFIELD Image:ImageColumn");

    // The data source should have such a column named "ImageColumn".
    Assert.assertEquals("Image:ImageColumn", field.getFieldName());

    // Create a suitable data source.
    DataTable dataTable = new DataTable("Images");
    dataTable.getColumns().add(new DataColumn("ImageColumn"));
    dataTable.getRows().add(getImageDir() + "Logo.jpg");
    dataTable.getRows().add(getImageDir() + "Transparent background logo.png");
    dataTable.getRows().add(getImageDir() + "Enhanced Windows MetaFile.emf");

    // Configure a callback to modify the sizes of images at merge time, then execute the mail merge.
    doc.getMailMerge().setFieldMergingCallback(new MergedImageResizer(200.0, 200.0, MergeFieldImageDimensionUnit.POINT));
    doc.getMailMerge().execute(dataTable);

    doc.updateFields();
    doc.save(getArtifactsDir() + "Field.MERGEFIELD.ImageDimension.docx");
}

/// &lt;summary&gt;
/// Sets the size of all mail merged images to one defined width and height.
/// &lt;/summary&gt;
private static class MergedImageResizer implements IFieldMergingCallback {
    public MergedImageResizer(final double imageWidth, final double imageHeight, final int unit) {
        mImageWidth = imageWidth;
        mImageHeight = imageHeight;
        mUnit = unit;
    }

    public void fieldMerging(final FieldMergingArgs args) {
        throw new UnsupportedOperationException();
    }

    public void imageFieldMerging(final ImageFieldMergingArgs args) {
        args.setImageFileName(args.getFieldValue().toString());
        args.setImageWidth(new MergeFieldImageDimension(mImageWidth, mUnit));
        args.setImageHeight(new MergeFieldImageDimension(mImageHeight, mUnit));

        Assert.assertEquals(mImageWidth, args.getImageWidth().getValue());
        Assert.assertEquals(mUnit, args.getImageWidth().getUnit());
        Assert.assertEquals(mImageHeight, args.getImageHeight().getValue());
        Assert.assertEquals(mUnit, args.getImageHeight().getUnit());
        Assert.assertNull(args.getShape());
    }

    private final double mImageWidth;
    private final double mImageHeight;
    private final int mUnit;
}</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A></cref>, <cref seealso=""><A HREF="MergeFieldImageDimensionUnit.html" title="Utility class in com.aspose.words">MergeFieldImageDimensionUnit</A></cref></DD></DL>
</DL>
<HR>

<A NAME="ImageStream"><!-- --></A><A NAME="getImageStream()"><!-- --></A><A NAME="getImageStream--"><!-- --></A><A NAME="setImageStream(java.io.InputStream)"><!-- --></A><A NAME="setImageStream-java.io.InputStream-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getImageStream/setImageStream</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.io.InputStream&nbsp;<B>getImageStream</B>()&nbsp;/&nbsp;public void&nbsp;<B>setImageStream</B>(java.io.InputStream&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Specifies the stream for the mail merge engine to read an image from.
            </summary><remarks><p>Aspose.Words closes this stream after it merges the image into the document.</p></remarks><example><p><b>Example:</b></p>Shows how to insert images stored in a database BLOB field into a report.<pre>
public void imageFromBlob() throws Exception {
    Document doc = new Document(getMyDir() + "Mail merge destination - Northwind employees.docx");

    // Set up the event handler for image fields
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeImageFieldFromBlob());

    // Loads the driver
    Class.forName("net.ucanaccess.jdbc.UcanaccessDriver");

    // Open the database connection
    String connString = "jdbc:ucanaccess://" + getDatabaseDir() + "Northwind.accdb";

    // DSN-less DB connection
    java.sql.Connection conn = java.sql.DriverManager.getConnection(connString, "Admin", "");

    // Create and execute a command
    java.sql.Statement statement = conn.createStatement();
    java.sql.ResultSet resultSet = statement.executeQuery("SELECT * FROM Employees");

    DataTable table = new DataTable(resultSet, "Employees");

    // Perform mail merge
    doc.getMailMerge().executeWithRegions(table);

    // Close the database
    conn.close();

    doc.save(getArtifactsDir() + "MailMergeEvent.ImageFromBlob.docx");
}

private class HandleMergeImageFieldFromBlob implements IFieldMergingCallback {
    public void fieldMerging(final FieldMergingArgs args) {
        // Do nothing
    }

    // This is called when mail merge engine encounters Image:XXX merge field in the document.
    // You have a chance to return an Image object, file name or a stream that contains the image.
    public void imageFieldMerging(final ImageFieldMergingArgs e) {
        // The field value is a byte array, just cast it and create a stream on it
        ByteArrayInputStream imageStream = new ByteArrayInputStream((byte[]) e.getFieldValue());
        // Now the mail merge engine will retrieve the image from the stream
        e.setImageStream(imageStream);
    }
}</pre></example>
</DL>
<HR>

<A NAME="ImageWidth"><!-- --></A><A NAME="getImageWidth()"><!-- --></A><A NAME="getImageWidth--"><!-- --></A><A NAME="setImageWidth(com.aspose.words.MergeFieldImageDimension)"><!-- --></A><A NAME="setImageWidth-com.aspose.words.MergeFieldImageDimension-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getImageWidth/setImageWidth</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A>&nbsp;<B>getImageWidth</B>()&nbsp;/&nbsp;public void&nbsp;<B>setImageWidth</B>(<A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A>&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Specifies the image width for the image to insert into the document.
            </summary><remarks><p>
            The value of this property initially comes from the corresponding MERGEFIELD's code, contained in the
            template document. To override the initial value, you should assign an instance of
            <cref><A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A></cref> class to this property or set the properties for the instance
            of <cref><A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A></cref> class, returned by this property.
            </p><p>
            To indicate that the original value of the image width should be applied, you should assign the <code>null</code>
            value to this property or set the <cref><A HREF="MergeFieldImageDimension.html#Value" title="property in class com.aspose.words.MergeFieldImageDimension">MergeFieldImageDimension.Value</A></cref> property for the instance
            of <cref><A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A></cref> class, returned by this property, to a negative value.
            </p></remarks><example><p><b>Example:</b></p>Shows how to set the dimensions of images as MERGEFIELDS accepts them during a mail merge.<pre>
public void mergeFieldImageDimension() throws Exception {
    Document doc = new Document();

    // Insert a MERGEFIELD that will accept images from a source during a mail merge. Use the field code to reference
    // a column in the data source containing local system filenames of images we wish to use in the mail merge.
    DocumentBuilder builder = new DocumentBuilder(doc);
    FieldMergeField field = (FieldMergeField) builder.insertField("MERGEFIELD Image:ImageColumn");

    // The data source should have such a column named "ImageColumn".
    Assert.assertEquals("Image:ImageColumn", field.getFieldName());

    // Create a suitable data source.
    DataTable dataTable = new DataTable("Images");
    dataTable.getColumns().add(new DataColumn("ImageColumn"));
    dataTable.getRows().add(getImageDir() + "Logo.jpg");
    dataTable.getRows().add(getImageDir() + "Transparent background logo.png");
    dataTable.getRows().add(getImageDir() + "Enhanced Windows MetaFile.emf");

    // Configure a callback to modify the sizes of images at merge time, then execute the mail merge.
    doc.getMailMerge().setFieldMergingCallback(new MergedImageResizer(200.0, 200.0, MergeFieldImageDimensionUnit.POINT));
    doc.getMailMerge().execute(dataTable);

    doc.updateFields();
    doc.save(getArtifactsDir() + "Field.MERGEFIELD.ImageDimension.docx");
}

/// &lt;summary&gt;
/// Sets the size of all mail merged images to one defined width and height.
/// &lt;/summary&gt;
private static class MergedImageResizer implements IFieldMergingCallback {
    public MergedImageResizer(final double imageWidth, final double imageHeight, final int unit) {
        mImageWidth = imageWidth;
        mImageHeight = imageHeight;
        mUnit = unit;
    }

    public void fieldMerging(final FieldMergingArgs args) {
        throw new UnsupportedOperationException();
    }

    public void imageFieldMerging(final ImageFieldMergingArgs args) {
        args.setImageFileName(args.getFieldValue().toString());
        args.setImageWidth(new MergeFieldImageDimension(mImageWidth, mUnit));
        args.setImageHeight(new MergeFieldImageDimension(mImageHeight, mUnit));

        Assert.assertEquals(mImageWidth, args.getImageWidth().getValue());
        Assert.assertEquals(mUnit, args.getImageWidth().getUnit());
        Assert.assertEquals(mImageHeight, args.getImageHeight().getValue());
        Assert.assertEquals(mUnit, args.getImageHeight().getUnit());
        Assert.assertNull(args.getShape());
    }

    private final double mImageWidth;
    private final double mImageHeight;
    private final int mUnit;
}</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="MergeFieldImageDimension.html" title="class in com.aspose.words">MergeFieldImageDimension</A></cref>, <cref seealso=""><A HREF="MergeFieldImageDimensionUnit.html" title="Utility class in com.aspose.words">MergeFieldImageDimensionUnit</A></cref></DD></DL>
</DL>
<HR>

<A NAME="RecordIndex"><!-- --></A><A NAME="getRecordIndex()"><!-- --></A><A NAME="getRecordIndex--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getRecordIndex</H3></TD><TD ALIGN="right" VALIGN="top"><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public int&nbsp;<B>getRecordIndex</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the zero based index of the record that is being merged.
            </summary><example><p><b>Example:</b></p>Shows how to insert checkbox form fields into a document during mail merge.<pre>
public void insertCheckBox() throws Exception {
    Document doc = new Document();
    DocumentBuilder builder = new DocumentBuilder(doc);

    builder.startTable();
    builder.insertCell();
    builder.insertField(" MERGEFIELD  TableStart:StudentCourse ");
    builder.insertCell();
    builder.insertField(" MERGEFIELD  CourseName ");
    builder.insertCell();
    builder.insertField(" MERGEFIELD  TableEnd:StudentCourse ");
    builder.endTable();

    // Add a handler for the MergeField event
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertCheckBox());

    // Execute mail merge with regions
    DataTable dataTable = getStudentCourseDataTable();
    doc.getMailMerge().executeWithRegions(dataTable);

    // Save resulting document with a new name
    doc.save(getArtifactsDir() + "MailMergeEvent.InsertCheckBox.docx");
}

private class HandleMergeFieldInsertCheckBox implements IFieldMergingCallback {
    // This is called for each merge field in the document
    // when Document.MailMerge.ExecuteWithRegions is called.
    public void fieldMerging(final FieldMergingArgs args) throws Exception {
        if (args.getDocumentFieldName().equals("CourseName")) {
            // The name of the table that we are merging can be found here
            Assert.assertEquals(args.getTableName(), "StudentCourse");

            // Insert the checkbox for this merge field, using DocumentBuilder
            DocumentBuilder builder = new DocumentBuilder(args.getDocument());
            builder.moveToMergeField(args.getFieldName());
            builder.insertCheckBox(args.getDocumentFieldName() + mCheckBoxCount, false, 0);
            // Get the actual value of the field
            String fieldValue = args.getFieldValue().toString();

            // In this case, for every record index 'n', the corresponding field value is "Course n"
            Assert.assertEquals(args.getRecordIndex(), Character.getNumericValue(fieldValue.charAt(7)));

            builder.write(fieldValue);
            mCheckBoxCount++;
        }
    }

    public void imageFieldMerging(final ImageFieldMergingArgs args) {
        // Do nothing
    }

    // Counter for CheckBox name generation.
    private int mCheckBoxCount;
}

// Create DataTable and fill it with data.
// In real life this DataTable should be filled from a database.
private static DataTable getStudentCourseDataTable() throws Exception {
    DataTable dataTable = new DataTable("StudentCourse");
    dataTable.getColumns().add("CourseName");
    for (int i = 0; i &lt; 10; i++) {
        DataRow datarow = dataTable.newRow();
        dataTable.getRows().add(datarow);
        datarow.set(0, "Course " + i);
    }
    return dataTable;
}</pre></example>
</DL>
<HR>

<A NAME="Shape"><!-- --></A><A NAME="getShape()"><!-- --></A><A NAME="getShape--"><!-- --></A><A NAME="setShape(com.aspose.words.Shape)"><!-- --></A><A NAME="setShape-com.aspose.words.Shape-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getShape/setShape</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="Shape.html" title="class in com.aspose.words">Shape</A>&nbsp;<B>getShape</B>()&nbsp;/&nbsp;public void&nbsp;<B>setShape</B>(<A HREF="Shape.html" title="class in com.aspose.words">Shape</A>&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Specifies the shape that the mail merge engine must insert into the document.
            </summary><remarks><p>When this property is specified, the mail merge engine ignores all other properties like <cref><A HREF="#ImageFileName" title="property in class com.aspose.words.ImageFieldMergingArgs">ImageFileName</A></cref> or <cref><A HREF="#ImageStream" title="property in class com.aspose.words.ImageFieldMergingArgs">ImageStream</A></cref>
            and simply inserts the shape into the document.</p><p>Use this property to fully control the process of merging an image merge field.
            For example, you can specify <cref><A HREF="ShapeBase.html#WrapType" title="property in class com.aspose.words.ShapeBase">ShapeBase.WrapType</A></cref> or any other shape property to fine tune the resulting node. However, please note that
            you are responsible for providing the content of the shape.</p></remarks><example><p><b>Example:</b></p>Shows how to set the dimensions of images as MERGEFIELDS accepts them during a mail merge.<pre>
public void mergeFieldImageDimension() throws Exception {
    Document doc = new Document();

    // Insert a MERGEFIELD that will accept images from a source during a mail merge. Use the field code to reference
    // a column in the data source containing local system filenames of images we wish to use in the mail merge.
    DocumentBuilder builder = new DocumentBuilder(doc);
    FieldMergeField field = (FieldMergeField) builder.insertField("MERGEFIELD Image:ImageColumn");

    // The data source should have such a column named "ImageColumn".
    Assert.assertEquals("Image:ImageColumn", field.getFieldName());

    // Create a suitable data source.
    DataTable dataTable = new DataTable("Images");
    dataTable.getColumns().add(new DataColumn("ImageColumn"));
    dataTable.getRows().add(getImageDir() + "Logo.jpg");
    dataTable.getRows().add(getImageDir() + "Transparent background logo.png");
    dataTable.getRows().add(getImageDir() + "Enhanced Windows MetaFile.emf");

    // Configure a callback to modify the sizes of images at merge time, then execute the mail merge.
    doc.getMailMerge().setFieldMergingCallback(new MergedImageResizer(200.0, 200.0, MergeFieldImageDimensionUnit.POINT));
    doc.getMailMerge().execute(dataTable);

    doc.updateFields();
    doc.save(getArtifactsDir() + "Field.MERGEFIELD.ImageDimension.docx");
}

/// &lt;summary&gt;
/// Sets the size of all mail merged images to one defined width and height.
/// &lt;/summary&gt;
private static class MergedImageResizer implements IFieldMergingCallback {
    public MergedImageResizer(final double imageWidth, final double imageHeight, final int unit) {
        mImageWidth = imageWidth;
        mImageHeight = imageHeight;
        mUnit = unit;
    }

    public void fieldMerging(final FieldMergingArgs args) {
        throw new UnsupportedOperationException();
    }

    public void imageFieldMerging(final ImageFieldMergingArgs args) {
        args.setImageFileName(args.getFieldValue().toString());
        args.setImageWidth(new MergeFieldImageDimension(mImageWidth, mUnit));
        args.setImageHeight(new MergeFieldImageDimension(mImageHeight, mUnit));

        Assert.assertEquals(mImageWidth, args.getImageWidth().getValue());
        Assert.assertEquals(mUnit, args.getImageWidth().getUnit());
        Assert.assertEquals(mImageHeight, args.getImageHeight().getValue());
        Assert.assertEquals(mUnit, args.getImageHeight().getUnit());
        Assert.assertNull(args.getShape());
    }

    private final double mImageWidth;
    private final double mImageHeight;
    private final int mUnit;
}</pre></example>
</DL>
<HR>

<A NAME="TableName"><!-- --></A><A NAME="getTableName()"><!-- --></A><A NAME="getTableName--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getTableName</H3></TD><TD ALIGN="right" VALIGN="top"><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getTableName</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the name of the data table for the current merge operation or empty string if the name is not available.
            </summary><example><p><b>Example:</b></p>Shows how to insert checkbox form fields into a document during mail merge.<pre>
public void insertCheckBox() throws Exception {
    Document doc = new Document();
    DocumentBuilder builder = new DocumentBuilder(doc);

    builder.startTable();
    builder.insertCell();
    builder.insertField(" MERGEFIELD  TableStart:StudentCourse ");
    builder.insertCell();
    builder.insertField(" MERGEFIELD  CourseName ");
    builder.insertCell();
    builder.insertField(" MERGEFIELD  TableEnd:StudentCourse ");
    builder.endTable();

    // Add a handler for the MergeField event
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertCheckBox());

    // Execute mail merge with regions
    DataTable dataTable = getStudentCourseDataTable();
    doc.getMailMerge().executeWithRegions(dataTable);

    // Save resulting document with a new name
    doc.save(getArtifactsDir() + "MailMergeEvent.InsertCheckBox.docx");
}

private class HandleMergeFieldInsertCheckBox implements IFieldMergingCallback {
    // This is called for each merge field in the document
    // when Document.MailMerge.ExecuteWithRegions is called.
    public void fieldMerging(final FieldMergingArgs args) throws Exception {
        if (args.getDocumentFieldName().equals("CourseName")) {
            // The name of the table that we are merging can be found here
            Assert.assertEquals(args.getTableName(), "StudentCourse");

            // Insert the checkbox for this merge field, using DocumentBuilder
            DocumentBuilder builder = new DocumentBuilder(args.getDocument());
            builder.moveToMergeField(args.getFieldName());
            builder.insertCheckBox(args.getDocumentFieldName() + mCheckBoxCount, false, 0);
            // Get the actual value of the field
            String fieldValue = args.getFieldValue().toString();

            // In this case, for every record index 'n', the corresponding field value is "Course n"
            Assert.assertEquals(args.getRecordIndex(), Character.getNumericValue(fieldValue.charAt(7)));

            builder.write(fieldValue);
            mCheckBoxCount++;
        }
    }

    public void imageFieldMerging(final ImageFieldMergingArgs args) {
        // Do nothing
    }

    // Counter for CheckBox name generation.
    private int mCheckBoxCount;
}

// Create DataTable and fill it with data.
// In real life this DataTable should be filled from a database.
private static DataTable getStudentCourseDataTable() throws Exception {
    DataTable dataTable = new DataTable("StudentCourse");
    dataTable.getColumns().add("CourseName");
    for (int i = 0; i &lt; 10; i++) {
        DataRow datarow = dataTable.newRow();
        dataTable.getRows().add(datarow);
        datarow.set(0, "Course " + i);
    }
    return dataTable;
}</pre></example>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>