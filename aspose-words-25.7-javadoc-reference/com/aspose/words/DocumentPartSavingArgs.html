<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 19 Jul 2025 -->
<TITLE>DocumentPartSavingArgs</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Class DocumentPartSavingArgs</H2>
<PRE>
java.lang.Object
    <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>com.aspose.words.DocumentPartSavingArgs</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>DocumentPartSavingArgs </B><DT>extends java.lang.Object</DL>
</PRE>

<P>

<summary>
            Provides data for the <cref><A HREF="IDocumentPartSavingCallback.html#documentPartSaving(com.aspose.words.DocumentPartSavingArgs)" title="method in class com.aspose.words.IDocumentPartSavingCallback">IDocumentPartSavingCallback.documentPartSaving(com.aspose.words.DocumentPartSavingArgs)</A></cref> callback.
            <p>To learn more, visit the <a href="https://docs.aspose.com/words/net/save-a-document/">Save a Document</a> documentation article.</p></summary><remarks><p>When Aspose.Words saves a document to HTML or related formats and <cref><A HREF="HtmlSaveOptions.html#DocumentSplitCriteria" title="property in class com.aspose.words.HtmlSaveOptions">HtmlSaveOptions.DocumentSplitCriteria</A></cref> 
            is specified, the document is split into parts and by default, each document part is saved into a separate file.</p><p>Class <cref><i>DocumentPartSavingArgs</i></cref> allows you to control how each document part will be saved. 
            It allows to redefine how file names are generated or to completely circumvent saving of document parts into 
            files by providing your own stream objects.</p><p>To save document parts into streams instead of files, use the <cref><A HREF="#DocumentPartStream" title="property in class com.aspose.words.DocumentPartSavingArgs">DocumentPartStream</A></cref> property.</p></remarks><example><p><b>Example:</b></p>Shows how to split a document into parts and save them.<pre>
public void documentPartsFileNames() throws Exception {
    Document doc = new Document(getMyDir() + "Rendering.docx");
    String outFileName = "SavingCallback.DocumentPartsFileNames.html";

    // Create an "HtmlFixedSaveOptions" object, which we can pass to the document's "Save" method
    // to modify how we convert the document to HTML.
    HtmlSaveOptions options = new HtmlSaveOptions();

    // If we save the document normally, there will be one output HTML
    // document with all the source document's contents.
    // Set the "DocumentSplitCriteria" property to "DocumentSplitCriteria.SectionBreak" to
    // save our document to multiple HTML files: one for each section.
    options.setDocumentSplitCriteria(DocumentSplitCriteria.SECTION_BREAK);

    // Assign a custom callback to the "DocumentPartSavingCallback" property to alter the document part saving logic.
    options.setDocumentPartSavingCallback(new SavedDocumentPartRename(outFileName, options.getDocumentSplitCriteria()));

    // If we convert a document that contains images into html, we will end up with one html file which links to several images.
    // Each image will be in the form of a file in the local file system.
    // There is also a callback that can customize the name and file system location of each image.
    options.setImageSavingCallback(new SavedImageRename(outFileName));

    doc.save(getArtifactsDir() + outFileName, options);
}

/// &lt;summary&gt;
/// Sets custom filenames for output documents that the saving operation splits a document into.
/// &lt;/summary&gt;
private static class SavedDocumentPartRename implements IDocumentPartSavingCallback {
    public SavedDocumentPartRename(String outFileName, int documentSplitCriteria) {
        mOutFileName = outFileName;
        mDocumentSplitCriteria = documentSplitCriteria;
    }

    public void documentPartSaving(DocumentPartSavingArgs args) throws Exception {
        // We can access the entire source document via the "Document" property.
        Assert.assertTrue(args.getDocument().getOriginalFileName().endsWith("Rendering.docx"));

        String partType = "";

        switch (mDocumentSplitCriteria) {
            case DocumentSplitCriteria.PAGE_BREAK:
                partType = "Page";
                break;
            case DocumentSplitCriteria.COLUMN_BREAK:
                partType = "Column";
                break;
            case DocumentSplitCriteria.SECTION_BREAK:
                partType = "Section";
                break;
            case DocumentSplitCriteria.HEADING_PARAGRAPH:
                partType = "Paragraph from heading";
                break;
        }

        String partFileName = MessageFormat.format("{0} part {1}, of type {2}.{3}", mOutFileName, ++mCount, partType, FilenameUtils.getExtension(args.getDocumentPartFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output part file:
        args.setDocumentPartFileName(partFileName);

        // 2 -  Create a custom stream for the output part file:
        try (FileOutputStream outputStream = new FileOutputStream(getArtifactsDir() + partFileName)) {
            args.setDocumentPartStream(outputStream);
        }

        Assert.assertNotNull(args.getDocumentPartStream());
        Assert.assertFalse(args.getKeepDocumentPartStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
    private final int mDocumentSplitCriteria;
}

/// &lt;summary&gt;
/// Sets custom filenames for image files that an HTML conversion creates.
/// &lt;/summary&gt;
public static class SavedImageRename implements IImageSavingCallback {
    public SavedImageRename(String outFileName) {
        mOutFileName = outFileName;
    }

    public void imageSaving(ImageSavingArgs args) throws Exception {
        String imageFileName = MessageFormat.format("{0} shape {1}, of type {2}.{3}", mOutFileName, ++mCount, args.getCurrentShape().getShapeType(), FilenameUtils.getExtension(args.getImageFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output image file:
        args.setImageFileName(imageFileName);

        // 2 -  Create a custom stream for the output image file:
        args.setImageStream(new FileOutputStream(getArtifactsDir() + imageFileName));

        Assert.assertNotNull(args.getImageStream());
        Assert.assertTrue(args.isImageAvailable());
        Assert.assertFalse(args.getKeepImageStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
}</pre></example>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ========== PROPERTY SUMMARY =========== -->

<A NAME="property_summary"><!-- --></A>
<TABLE RULES="GROUPS" BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Property Getters/Setters Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="Document.html" title="class in com.aspose.words">Document</A></CODE></TD><TD><CODE><B><A HREF="#Document">getDocument</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the document object that is being saved.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#DocumentPartFileName">getDocumentPartFileName</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#DocumentPartFileName">setDocumentPartFileName</A></B>(java.lang.String&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets or sets the file name (without path) where the document part will be saved to.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.io.OutputStream</CODE></TD><TD><CODE><B><A HREF="#DocumentPartStream">getDocumentPartStream</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#DocumentPartStream">setDocumentPartStream</A></B>(java.io.OutputStream&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Allows to specify the stream where the document part will be saved to.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>boolean</CODE></TD><TD><CODE><B><A HREF="#KeepDocumentPartStreamOpen">getKeepDocumentPartStreamOpen</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#KeepDocumentPartStreamOpen">setKeepDocumentPartStreamOpen</A></B>(boolean&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Specifies whether Aspose.Words should keep the stream open or close it after saving a document part.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ============ PROPERTY DETAIL ========== -->

<A NAME="property_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Property Getters/Setters Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="Document"><!-- --></A><A NAME="getDocument()"><!-- --></A><A NAME="getDocument--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getDocument</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="Document.html" title="class in com.aspose.words">Document</A>&nbsp;<B>getDocument</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the document object that is being saved.
            </summary><example><p><b>Example:</b></p>Shows how to split a document into parts and save them.<pre>
public void documentPartsFileNames() throws Exception {
    Document doc = new Document(getMyDir() + "Rendering.docx");
    String outFileName = "SavingCallback.DocumentPartsFileNames.html";

    // Create an "HtmlFixedSaveOptions" object, which we can pass to the document's "Save" method
    // to modify how we convert the document to HTML.
    HtmlSaveOptions options = new HtmlSaveOptions();

    // If we save the document normally, there will be one output HTML
    // document with all the source document's contents.
    // Set the "DocumentSplitCriteria" property to "DocumentSplitCriteria.SectionBreak" to
    // save our document to multiple HTML files: one for each section.
    options.setDocumentSplitCriteria(DocumentSplitCriteria.SECTION_BREAK);

    // Assign a custom callback to the "DocumentPartSavingCallback" property to alter the document part saving logic.
    options.setDocumentPartSavingCallback(new SavedDocumentPartRename(outFileName, options.getDocumentSplitCriteria()));

    // If we convert a document that contains images into html, we will end up with one html file which links to several images.
    // Each image will be in the form of a file in the local file system.
    // There is also a callback that can customize the name and file system location of each image.
    options.setImageSavingCallback(new SavedImageRename(outFileName));

    doc.save(getArtifactsDir() + outFileName, options);
}

/// &lt;summary&gt;
/// Sets custom filenames for output documents that the saving operation splits a document into.
/// &lt;/summary&gt;
private static class SavedDocumentPartRename implements IDocumentPartSavingCallback {
    public SavedDocumentPartRename(String outFileName, int documentSplitCriteria) {
        mOutFileName = outFileName;
        mDocumentSplitCriteria = documentSplitCriteria;
    }

    public void documentPartSaving(DocumentPartSavingArgs args) throws Exception {
        // We can access the entire source document via the "Document" property.
        Assert.assertTrue(args.getDocument().getOriginalFileName().endsWith("Rendering.docx"));

        String partType = "";

        switch (mDocumentSplitCriteria) {
            case DocumentSplitCriteria.PAGE_BREAK:
                partType = "Page";
                break;
            case DocumentSplitCriteria.COLUMN_BREAK:
                partType = "Column";
                break;
            case DocumentSplitCriteria.SECTION_BREAK:
                partType = "Section";
                break;
            case DocumentSplitCriteria.HEADING_PARAGRAPH:
                partType = "Paragraph from heading";
                break;
        }

        String partFileName = MessageFormat.format("{0} part {1}, of type {2}.{3}", mOutFileName, ++mCount, partType, FilenameUtils.getExtension(args.getDocumentPartFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output part file:
        args.setDocumentPartFileName(partFileName);

        // 2 -  Create a custom stream for the output part file:
        try (FileOutputStream outputStream = new FileOutputStream(getArtifactsDir() + partFileName)) {
            args.setDocumentPartStream(outputStream);
        }

        Assert.assertNotNull(args.getDocumentPartStream());
        Assert.assertFalse(args.getKeepDocumentPartStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
    private final int mDocumentSplitCriteria;
}

/// &lt;summary&gt;
/// Sets custom filenames for image files that an HTML conversion creates.
/// &lt;/summary&gt;
public static class SavedImageRename implements IImageSavingCallback {
    public SavedImageRename(String outFileName) {
        mOutFileName = outFileName;
    }

    public void imageSaving(ImageSavingArgs args) throws Exception {
        String imageFileName = MessageFormat.format("{0} shape {1}, of type {2}.{3}", mOutFileName, ++mCount, args.getCurrentShape().getShapeType(), FilenameUtils.getExtension(args.getImageFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output image file:
        args.setImageFileName(imageFileName);

        // 2 -  Create a custom stream for the output image file:
        args.setImageStream(new FileOutputStream(getArtifactsDir() + imageFileName));

        Assert.assertNotNull(args.getImageStream());
        Assert.assertTrue(args.isImageAvailable());
        Assert.assertFalse(args.getKeepImageStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
}</pre></example>
</DL>
<HR>

<A NAME="DocumentPartFileName"><!-- --></A><A NAME="getDocumentPartFileName()"><!-- --></A><A NAME="getDocumentPartFileName--"><!-- --></A><A NAME="setDocumentPartFileName(java.lang.String)"><!-- --></A><A NAME="setDocumentPartFileName-java.lang.String-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getDocumentPartFileName/setDocumentPartFileName</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getDocumentPartFileName</B>()&nbsp;/&nbsp;public void&nbsp;<B>setDocumentPartFileName</B>(java.lang.String&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets or sets the file name (without path) where the document part will be saved to.
            </summary><remarks><p>This property allows you to redefine how the document part file names are generated
            during export to HTML or EPUB.</p><p>When the callback is invoked, this property contains the file name that was generated 
            by Aspose.Words. You can change the value of this property to save the document part into a 
            different file. Note that the file name for each part must be unique.</p><p><cref><i>DocumentPartFileName</i></cref> must contain only the file name without the path. 
            Aspose.Words determines the path for saving using the document file name. If output document 
            file name was not specified, for instance when saving to a stream, this file name is used only 
            for referencing document parts. The same is true when saving to EPUB format.</p></remarks><example><p><b>Example:</b></p>Shows how to split a document into parts and save them.<pre>
public void documentPartsFileNames() throws Exception {
    Document doc = new Document(getMyDir() + "Rendering.docx");
    String outFileName = "SavingCallback.DocumentPartsFileNames.html";

    // Create an "HtmlFixedSaveOptions" object, which we can pass to the document's "Save" method
    // to modify how we convert the document to HTML.
    HtmlSaveOptions options = new HtmlSaveOptions();

    // If we save the document normally, there will be one output HTML
    // document with all the source document's contents.
    // Set the "DocumentSplitCriteria" property to "DocumentSplitCriteria.SectionBreak" to
    // save our document to multiple HTML files: one for each section.
    options.setDocumentSplitCriteria(DocumentSplitCriteria.SECTION_BREAK);

    // Assign a custom callback to the "DocumentPartSavingCallback" property to alter the document part saving logic.
    options.setDocumentPartSavingCallback(new SavedDocumentPartRename(outFileName, options.getDocumentSplitCriteria()));

    // If we convert a document that contains images into html, we will end up with one html file which links to several images.
    // Each image will be in the form of a file in the local file system.
    // There is also a callback that can customize the name and file system location of each image.
    options.setImageSavingCallback(new SavedImageRename(outFileName));

    doc.save(getArtifactsDir() + outFileName, options);
}

/// &lt;summary&gt;
/// Sets custom filenames for output documents that the saving operation splits a document into.
/// &lt;/summary&gt;
private static class SavedDocumentPartRename implements IDocumentPartSavingCallback {
    public SavedDocumentPartRename(String outFileName, int documentSplitCriteria) {
        mOutFileName = outFileName;
        mDocumentSplitCriteria = documentSplitCriteria;
    }

    public void documentPartSaving(DocumentPartSavingArgs args) throws Exception {
        // We can access the entire source document via the "Document" property.
        Assert.assertTrue(args.getDocument().getOriginalFileName().endsWith("Rendering.docx"));

        String partType = "";

        switch (mDocumentSplitCriteria) {
            case DocumentSplitCriteria.PAGE_BREAK:
                partType = "Page";
                break;
            case DocumentSplitCriteria.COLUMN_BREAK:
                partType = "Column";
                break;
            case DocumentSplitCriteria.SECTION_BREAK:
                partType = "Section";
                break;
            case DocumentSplitCriteria.HEADING_PARAGRAPH:
                partType = "Paragraph from heading";
                break;
        }

        String partFileName = MessageFormat.format("{0} part {1}, of type {2}.{3}", mOutFileName, ++mCount, partType, FilenameUtils.getExtension(args.getDocumentPartFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output part file:
        args.setDocumentPartFileName(partFileName);

        // 2 -  Create a custom stream for the output part file:
        try (FileOutputStream outputStream = new FileOutputStream(getArtifactsDir() + partFileName)) {
            args.setDocumentPartStream(outputStream);
        }

        Assert.assertNotNull(args.getDocumentPartStream());
        Assert.assertFalse(args.getKeepDocumentPartStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
    private final int mDocumentSplitCriteria;
}

/// &lt;summary&gt;
/// Sets custom filenames for image files that an HTML conversion creates.
/// &lt;/summary&gt;
public static class SavedImageRename implements IImageSavingCallback {
    public SavedImageRename(String outFileName) {
        mOutFileName = outFileName;
    }

    public void imageSaving(ImageSavingArgs args) throws Exception {
        String imageFileName = MessageFormat.format("{0} shape {1}, of type {2}.{3}", mOutFileName, ++mCount, args.getCurrentShape().getShapeType(), FilenameUtils.getExtension(args.getImageFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output image file:
        args.setImageFileName(imageFileName);

        // 2 -  Create a custom stream for the output image file:
        args.setImageStream(new FileOutputStream(getArtifactsDir() + imageFileName));

        Assert.assertNotNull(args.getImageStream());
        Assert.assertTrue(args.isImageAvailable());
        Assert.assertFalse(args.getKeepImageStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
}</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="#DocumentPartStream" title="property in class com.aspose.words.DocumentPartSavingArgs">DocumentPartStream</A></cref></DD></DL>
</DL>
<HR>

<A NAME="DocumentPartStream"><!-- --></A><A NAME="getDocumentPartStream()"><!-- --></A><A NAME="getDocumentPartStream--"><!-- --></A><A NAME="setDocumentPartStream(java.io.OutputStream)"><!-- --></A><A NAME="setDocumentPartStream-java.io.OutputStream-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getDocumentPartStream/setDocumentPartStream</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.io.OutputStream&nbsp;<B>getDocumentPartStream</B>()&nbsp;/&nbsp;public void&nbsp;<B>setDocumentPartStream</B>(java.io.OutputStream&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Allows to specify the stream where the document part will be saved to.
            </summary><remarks><p>This property allows you to save document parts to streams instead of files during HTML export.</p><p>The default value is <code>null</code>. When this property is <code>null</code>, the document part 
            will be saved to a file specified in the <cref><A HREF="#DocumentPartFileName" title="property in class com.aspose.words.DocumentPartSavingArgs">DocumentPartFileName</A></cref> property.</p><p>When saving to a stream in HTML format is requested by <cref><A HREF="Document.html#save(java.io.OutputStream,int)" title="method in class com.aspose.words.Document">Document.save(java.io.OutputStream,int)</A></cref> 
            or <cref><A HREF="Document.html#save(java.io.OutputStream,com.aspose.words.SaveOptions)" title="method in class com.aspose.words.Document">Document.save(java.io.OutputStream,com.aspose.words.SaveOptions)</A></cref> and first document part is about to be saved, 
            Aspose.Words suggests here the main output stream initially passed by the caller.</p><p>When saving to EPUB format that is a container format based on HTML, <cref><i>DocumentPartStream</i></cref> cannot 
            be specified because all subsidiary parts will be encapsulated into a single output package.</p></remarks><example><p><b>Example:</b></p>Shows how to split a document into parts and save them.<pre>
public void documentPartsFileNames() throws Exception {
    Document doc = new Document(getMyDir() + "Rendering.docx");
    String outFileName = "SavingCallback.DocumentPartsFileNames.html";

    // Create an "HtmlFixedSaveOptions" object, which we can pass to the document's "Save" method
    // to modify how we convert the document to HTML.
    HtmlSaveOptions options = new HtmlSaveOptions();

    // If we save the document normally, there will be one output HTML
    // document with all the source document's contents.
    // Set the "DocumentSplitCriteria" property to "DocumentSplitCriteria.SectionBreak" to
    // save our document to multiple HTML files: one for each section.
    options.setDocumentSplitCriteria(DocumentSplitCriteria.SECTION_BREAK);

    // Assign a custom callback to the "DocumentPartSavingCallback" property to alter the document part saving logic.
    options.setDocumentPartSavingCallback(new SavedDocumentPartRename(outFileName, options.getDocumentSplitCriteria()));

    // If we convert a document that contains images into html, we will end up with one html file which links to several images.
    // Each image will be in the form of a file in the local file system.
    // There is also a callback that can customize the name and file system location of each image.
    options.setImageSavingCallback(new SavedImageRename(outFileName));

    doc.save(getArtifactsDir() + outFileName, options);
}

/// &lt;summary&gt;
/// Sets custom filenames for output documents that the saving operation splits a document into.
/// &lt;/summary&gt;
private static class SavedDocumentPartRename implements IDocumentPartSavingCallback {
    public SavedDocumentPartRename(String outFileName, int documentSplitCriteria) {
        mOutFileName = outFileName;
        mDocumentSplitCriteria = documentSplitCriteria;
    }

    public void documentPartSaving(DocumentPartSavingArgs args) throws Exception {
        // We can access the entire source document via the "Document" property.
        Assert.assertTrue(args.getDocument().getOriginalFileName().endsWith("Rendering.docx"));

        String partType = "";

        switch (mDocumentSplitCriteria) {
            case DocumentSplitCriteria.PAGE_BREAK:
                partType = "Page";
                break;
            case DocumentSplitCriteria.COLUMN_BREAK:
                partType = "Column";
                break;
            case DocumentSplitCriteria.SECTION_BREAK:
                partType = "Section";
                break;
            case DocumentSplitCriteria.HEADING_PARAGRAPH:
                partType = "Paragraph from heading";
                break;
        }

        String partFileName = MessageFormat.format("{0} part {1}, of type {2}.{3}", mOutFileName, ++mCount, partType, FilenameUtils.getExtension(args.getDocumentPartFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output part file:
        args.setDocumentPartFileName(partFileName);

        // 2 -  Create a custom stream for the output part file:
        try (FileOutputStream outputStream = new FileOutputStream(getArtifactsDir() + partFileName)) {
            args.setDocumentPartStream(outputStream);
        }

        Assert.assertNotNull(args.getDocumentPartStream());
        Assert.assertFalse(args.getKeepDocumentPartStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
    private final int mDocumentSplitCriteria;
}

/// &lt;summary&gt;
/// Sets custom filenames for image files that an HTML conversion creates.
/// &lt;/summary&gt;
public static class SavedImageRename implements IImageSavingCallback {
    public SavedImageRename(String outFileName) {
        mOutFileName = outFileName;
    }

    public void imageSaving(ImageSavingArgs args) throws Exception {
        String imageFileName = MessageFormat.format("{0} shape {1}, of type {2}.{3}", mOutFileName, ++mCount, args.getCurrentShape().getShapeType(), FilenameUtils.getExtension(args.getImageFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output image file:
        args.setImageFileName(imageFileName);

        // 2 -  Create a custom stream for the output image file:
        args.setImageStream(new FileOutputStream(getArtifactsDir() + imageFileName));

        Assert.assertNotNull(args.getImageStream());
        Assert.assertTrue(args.isImageAvailable());
        Assert.assertFalse(args.getKeepImageStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
}</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="#KeepDocumentPartStreamOpen" title="property in class com.aspose.words.DocumentPartSavingArgs">KeepDocumentPartStreamOpen</A></cref></DD></DL>
</DL>
<HR>

<A NAME="KeepDocumentPartStreamOpen"><!-- --></A><A NAME="getKeepDocumentPartStreamOpen()"><!-- --></A><A NAME="getKeepDocumentPartStreamOpen--"><!-- --></A><A NAME="setKeepDocumentPartStreamOpen(boolean)"><!-- --></A><A NAME="setKeepDocumentPartStreamOpen-boolean-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getKeepDocumentPartStreamOpen/setKeepDocumentPartStreamOpen</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public boolean&nbsp;<B>getKeepDocumentPartStreamOpen</B>()&nbsp;/&nbsp;public void&nbsp;<B>setKeepDocumentPartStreamOpen</B>(boolean&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Specifies whether Aspose.Words should keep the stream open or close it after saving a document part.
            </summary><remarks><p>Default is <code>false</code> and Aspose.Words will close the stream you provided
            in the <cref><A HREF="#DocumentPartStream" title="property in class com.aspose.words.DocumentPartSavingArgs">DocumentPartStream</A></cref> property after writing a document part into it.
            Specify <code>true</code> to keep the stream open. Please note that the main output stream 
            provided in the call to <cref><A HREF="Document.html#save(java.io.OutputStream,int)" title="method in class com.aspose.words.Document">Document.save(java.io.OutputStream,int)</A></cref> or 
            <cref><A HREF="Document.html#save(java.io.OutputStream,com.aspose.words.SaveOptions)" title="method in class com.aspose.words.Document">Document.save(java.io.OutputStream,com.aspose.words.SaveOptions)</A></cref> will never be closed by Aspose.Words 
            even if <cref><i>KeepDocumentPartStreamOpen</i></cref> is set to <code>false</code>.</p></remarks><example><p><b>Example:</b></p>Shows how to split a document into parts and save them.<pre>
public void documentPartsFileNames() throws Exception {
    Document doc = new Document(getMyDir() + "Rendering.docx");
    String outFileName = "SavingCallback.DocumentPartsFileNames.html";

    // Create an "HtmlFixedSaveOptions" object, which we can pass to the document's "Save" method
    // to modify how we convert the document to HTML.
    HtmlSaveOptions options = new HtmlSaveOptions();

    // If we save the document normally, there will be one output HTML
    // document with all the source document's contents.
    // Set the "DocumentSplitCriteria" property to "DocumentSplitCriteria.SectionBreak" to
    // save our document to multiple HTML files: one for each section.
    options.setDocumentSplitCriteria(DocumentSplitCriteria.SECTION_BREAK);

    // Assign a custom callback to the "DocumentPartSavingCallback" property to alter the document part saving logic.
    options.setDocumentPartSavingCallback(new SavedDocumentPartRename(outFileName, options.getDocumentSplitCriteria()));

    // If we convert a document that contains images into html, we will end up with one html file which links to several images.
    // Each image will be in the form of a file in the local file system.
    // There is also a callback that can customize the name and file system location of each image.
    options.setImageSavingCallback(new SavedImageRename(outFileName));

    doc.save(getArtifactsDir() + outFileName, options);
}

/// &lt;summary&gt;
/// Sets custom filenames for output documents that the saving operation splits a document into.
/// &lt;/summary&gt;
private static class SavedDocumentPartRename implements IDocumentPartSavingCallback {
    public SavedDocumentPartRename(String outFileName, int documentSplitCriteria) {
        mOutFileName = outFileName;
        mDocumentSplitCriteria = documentSplitCriteria;
    }

    public void documentPartSaving(DocumentPartSavingArgs args) throws Exception {
        // We can access the entire source document via the "Document" property.
        Assert.assertTrue(args.getDocument().getOriginalFileName().endsWith("Rendering.docx"));

        String partType = "";

        switch (mDocumentSplitCriteria) {
            case DocumentSplitCriteria.PAGE_BREAK:
                partType = "Page";
                break;
            case DocumentSplitCriteria.COLUMN_BREAK:
                partType = "Column";
                break;
            case DocumentSplitCriteria.SECTION_BREAK:
                partType = "Section";
                break;
            case DocumentSplitCriteria.HEADING_PARAGRAPH:
                partType = "Paragraph from heading";
                break;
        }

        String partFileName = MessageFormat.format("{0} part {1}, of type {2}.{3}", mOutFileName, ++mCount, partType, FilenameUtils.getExtension(args.getDocumentPartFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output part file:
        args.setDocumentPartFileName(partFileName);

        // 2 -  Create a custom stream for the output part file:
        try (FileOutputStream outputStream = new FileOutputStream(getArtifactsDir() + partFileName)) {
            args.setDocumentPartStream(outputStream);
        }

        Assert.assertNotNull(args.getDocumentPartStream());
        Assert.assertFalse(args.getKeepDocumentPartStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
    private final int mDocumentSplitCriteria;
}

/// &lt;summary&gt;
/// Sets custom filenames for image files that an HTML conversion creates.
/// &lt;/summary&gt;
public static class SavedImageRename implements IImageSavingCallback {
    public SavedImageRename(String outFileName) {
        mOutFileName = outFileName;
    }

    public void imageSaving(ImageSavingArgs args) throws Exception {
        String imageFileName = MessageFormat.format("{0} shape {1}, of type {2}.{3}", mOutFileName, ++mCount, args.getCurrentShape().getShapeType(), FilenameUtils.getExtension(args.getImageFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output image file:
        args.setImageFileName(imageFileName);

        // 2 -  Create a custom stream for the output image file:
        args.setImageStream(new FileOutputStream(getArtifactsDir() + imageFileName));

        Assert.assertNotNull(args.getImageStream());
        Assert.assertTrue(args.isImageAvailable());
        Assert.assertFalse(args.getKeepImageStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
}</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="#DocumentPartStream" title="property in class com.aspose.words.DocumentPartSavingArgs">DocumentPartStream</A></cref></DD></DL>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>