<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 19 Jul 2025 -->
<TITLE>ImageSavingArgs</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Class ImageSavingArgs</H2>
<PRE>
java.lang.Object
    <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>com.aspose.words.ImageSavingArgs</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>ImageSavingArgs </B><DT>extends java.lang.Object</DL>
</PRE>

<P>

<summary>
            Provides data for the <cref><A HREF="IImageSavingCallback.html#imageSaving(com.aspose.words.ImageSavingArgs)" title="method in class com.aspose.words.IImageSavingCallback">IImageSavingCallback.imageSaving(com.aspose.words.ImageSavingArgs)</A></cref> event.
            <p>To learn more, visit the <a href="https://docs.aspose.com/words/net/save-a-document/">Save a Document</a> documentation article.</p></summary><remarks><p>By default, when Aspose.Words saves a document to HTML, it saves each image into 
            a separate file. Aspose.Words uses the document file name and a unique number to generate unique file name
            for each image found in the document.</p><p><cref><i>ImageSavingArgs</i></cref> allows to redefine how image file names are generated or to 
            completely circumvent saving of images into files by providing your own stream objects.</p><p>To apply your own logic for generating image file names use the 
            <cref><A HREF="#ImageFileName" title="property in class com.aspose.words.ImageSavingArgs">ImageFileName</A></cref>, <cref><A HREF="#CurrentShape" title="property in class com.aspose.words.ImageSavingArgs">CurrentShape</A></cref> and <cref><A HREF="#IsImageAvailable" title="property in class com.aspose.words.ImageSavingArgs">IsImageAvailable</A></cref> 
            properties.</p><p>To save images into streams instead of files, use the <cref><A HREF="#ImageStream" title="property in class com.aspose.words.ImageSavingArgs">ImageStream</A></cref> property.</p></remarks><example><p><b>Example:</b></p>Shows how to split a document into parts and save them.<pre>
public void documentPartsFileNames() throws Exception {
    Document doc = new Document(getMyDir() + "Rendering.docx");
    String outFileName = "SavingCallback.DocumentPartsFileNames.html";

    // Create an "HtmlFixedSaveOptions" object, which we can pass to the document's "Save" method
    // to modify how we convert the document to HTML.
    HtmlSaveOptions options = new HtmlSaveOptions();

    // If we save the document normally, there will be one output HTML
    // document with all the source document's contents.
    // Set the "DocumentSplitCriteria" property to "DocumentSplitCriteria.SectionBreak" to
    // save our document to multiple HTML files: one for each section.
    options.setDocumentSplitCriteria(DocumentSplitCriteria.SECTION_BREAK);

    // Assign a custom callback to the "DocumentPartSavingCallback" property to alter the document part saving logic.
    options.setDocumentPartSavingCallback(new SavedDocumentPartRename(outFileName, options.getDocumentSplitCriteria()));

    // If we convert a document that contains images into html, we will end up with one html file which links to several images.
    // Each image will be in the form of a file in the local file system.
    // There is also a callback that can customize the name and file system location of each image.
    options.setImageSavingCallback(new SavedImageRename(outFileName));

    doc.save(getArtifactsDir() + outFileName, options);
}

/// &lt;summary&gt;
/// Sets custom filenames for output documents that the saving operation splits a document into.
/// &lt;/summary&gt;
private static class SavedDocumentPartRename implements IDocumentPartSavingCallback {
    public SavedDocumentPartRename(String outFileName, int documentSplitCriteria) {
        mOutFileName = outFileName;
        mDocumentSplitCriteria = documentSplitCriteria;
    }

    public void documentPartSaving(DocumentPartSavingArgs args) throws Exception {
        // We can access the entire source document via the "Document" property.
        Assert.assertTrue(args.getDocument().getOriginalFileName().endsWith("Rendering.docx"));

        String partType = "";

        switch (mDocumentSplitCriteria) {
            case DocumentSplitCriteria.PAGE_BREAK:
                partType = "Page";
                break;
            case DocumentSplitCriteria.COLUMN_BREAK:
                partType = "Column";
                break;
            case DocumentSplitCriteria.SECTION_BREAK:
                partType = "Section";
                break;
            case DocumentSplitCriteria.HEADING_PARAGRAPH:
                partType = "Paragraph from heading";
                break;
        }

        String partFileName = MessageFormat.format("{0} part {1}, of type {2}.{3}", mOutFileName, ++mCount, partType, FilenameUtils.getExtension(args.getDocumentPartFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output part file:
        args.setDocumentPartFileName(partFileName);

        // 2 -  Create a custom stream for the output part file:
        try (FileOutputStream outputStream = new FileOutputStream(getArtifactsDir() + partFileName)) {
            args.setDocumentPartStream(outputStream);
        }

        Assert.assertNotNull(args.getDocumentPartStream());
        Assert.assertFalse(args.getKeepDocumentPartStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
    private final int mDocumentSplitCriteria;
}

/// &lt;summary&gt;
/// Sets custom filenames for image files that an HTML conversion creates.
/// &lt;/summary&gt;
public static class SavedImageRename implements IImageSavingCallback {
    public SavedImageRename(String outFileName) {
        mOutFileName = outFileName;
    }

    public void imageSaving(ImageSavingArgs args) throws Exception {
        String imageFileName = MessageFormat.format("{0} shape {1}, of type {2}.{3}", mOutFileName, ++mCount, args.getCurrentShape().getShapeType(), FilenameUtils.getExtension(args.getImageFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output image file:
        args.setImageFileName(imageFileName);

        // 2 -  Create a custom stream for the output image file:
        args.setImageStream(new FileOutputStream(getArtifactsDir() + imageFileName));

        Assert.assertNotNull(args.getImageStream());
        Assert.assertTrue(args.isImageAvailable());
        Assert.assertFalse(args.getKeepImageStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
}</pre></example>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ========== PROPERTY SUMMARY =========== -->

<A NAME="property_summary"><!-- --></A>
<TABLE RULES="GROUPS" BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Property Getters/Setters Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="ShapeBase.html" title="class in com.aspose.words">ShapeBase</A></CODE></TD><TD><CODE><B><A HREF="#CurrentShape">getCurrentShape</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the <cref><A HREF="ShapeBase.html" title="class in com.aspose.words">ShapeBase</A></cref> object corresponding to the shape or group shape 
            that is about to be saved.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="Document.html" title="class in com.aspose.words">Document</A></CODE></TD><TD><CODE><B><A HREF="#Document">getDocument</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the document object that is currently being saved.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#ImageFileName">getImageFileName</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#ImageFileName">setImageFileName</A></B>(java.lang.String&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets or sets the file name (without path) where the image will be saved to.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.io.OutputStream</CODE></TD><TD><CODE><B><A HREF="#ImageStream">getImageStream</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#ImageStream">setImageStream</A></B>(java.io.OutputStream&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Allows to specify the stream where the image will be saved to.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>boolean</CODE></TD><TD><CODE><B><A HREF="#IsImageAvailable">isImageAvailable</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns <code>true</code> if the current image is available for export.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>boolean</CODE></TD><TD><CODE><B><A HREF="#KeepImageStreamOpen">getKeepImageStreamOpen</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#KeepImageStreamOpen">setKeepImageStreamOpen</A></B>(boolean&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Specifies whether Aspose.Words should keep the stream open or close it after saving an image.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ============ PROPERTY DETAIL ========== -->

<A NAME="property_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Property Getters/Setters Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="CurrentShape"><!-- --></A><A NAME="getCurrentShape()"><!-- --></A><A NAME="getCurrentShape--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getCurrentShape</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="ShapeBase.html" title="class in com.aspose.words">ShapeBase</A>&nbsp;<B>getCurrentShape</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the <cref><A HREF="ShapeBase.html" title="class in com.aspose.words">ShapeBase</A></cref> object corresponding to the shape or group shape 
            that is about to be saved.
            </summary><remarks><p><cref><A HREF="IImageSavingCallback.html" title="interface in com.aspose.words">IImageSavingCallback</A></cref> can be fired while saving either a shape or a group shape. 
            That's why the property has <cref><A HREF="ShapeBase.html" title="class in com.aspose.words">ShapeBase</A></cref> type. You can check whether it's a group shape comparing 
            <cref><A HREF="ShapeBase.html#ShapeType" title="property in class com.aspose.words.ShapeBase">ShapeBase.ShapeType</A></cref> with <cref><A HREF="ShapeType.html#GROUP" title="field in class com.aspose.words.ShapeType">ShapeType.GROUP</A></cref> or by casting it to one of derived classes: 
            <cref><A HREF="Shape.html" title="class in com.aspose.words">Shape</A></cref> or <cref><A HREF="GroupShape.html" title="class in com.aspose.words">GroupShape</A></cref>.</p><p>Aspose.Words uses the document file name and a unique number to generate unique file name 
            for each image found in the document. You can use the <cref><i>CurrentShape</i></cref> property to generate 
            a "better" file name by examining shape properties such as <cref><A HREF="ImageData.html#Title" title="property in class com.aspose.words.ImageData">ImageData.Title</A></cref> 
            (Shape only), <cref><A HREF="ImageData.html#SourceFullName" title="property in class com.aspose.words.ImageData">ImageData.SourceFullName</A></cref> (Shape only) 
            and <cref><A HREF="ShapeBase.html#Name" title="property in class com.aspose.words.ShapeBase">ShapeBase.Name</A></cref>. Of course you can build file names using any other properties or criteria 
            but note that subsidiary file names must be unique within the export operation.</p><p>Some images in the document can be unavailable. To check image availability 
            use the <cref><A HREF="#IsImageAvailable" title="property in class com.aspose.words.ImageSavingArgs">IsImageAvailable</A></cref> property.</p></remarks><example><p><b>Example:</b></p>Shows how to involve an image saving callback in an HTML conversion process.<pre>
public void imageSavingCallback() throws Exception {
    Document doc = new Document(getMyDir() + "Rendering.docx");

    // When we save the document to HTML, we can pass a SaveOptions object to designate a callback
    // to customize the image saving process.
    HtmlSaveOptions options = new HtmlSaveOptions();
    options.setImageSavingCallback(new ImageShapePrinter());

    doc.save(getArtifactsDir() + "HtmlSaveOptions.ImageSavingCallback.html", options);
}

/// &lt;summary&gt;
/// Prints the properties of each image as the saving process saves it to an image file in the local file system
/// during the exporting of a document to HTML.
/// &lt;/summary&gt;
private static class ImageShapePrinter implements IImageSavingCallback {
    public void imageSaving(ImageSavingArgs args) throws Exception {
        args.setKeepImageStreamOpen(false);
        Assert.assertTrue(args.isImageAvailable());

        String[] splitOriginalFileName = args.getDocument().getOriginalFileName().split("\\\\");
        System.out.println(MessageFormat.format("{0} Image #{1}", splitOriginalFileName[splitOriginalFileName.length - 1], ++mImageCount));

        LayoutCollector layoutCollector = new LayoutCollector(args.getDocument());

        System.out.println(MessageFormat.format("\tOn page:\t{0}", layoutCollector.getStartPageIndex(args.getCurrentShape())));
        System.out.println(MessageFormat.format("\tDimensions:\t{0}", args.getCurrentShape().getBounds().toString()));
        System.out.println(MessageFormat.format("\tAlignment:\t{0}", args.getCurrentShape().getVerticalAlignment()));
        System.out.println(MessageFormat.format("\tWrap type:\t{0}", args.getCurrentShape().getWrapType()));
        System.out.println(MessageFormat.format("Output filename:\t{0}\n", args.getImageFileName()));
    }

    private int mImageCount;
}</pre></example>
</DL>
<HR>

<A NAME="Document"><!-- --></A><A NAME="getDocument()"><!-- --></A><A NAME="getDocument--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getDocument</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="Document.html" title="class in com.aspose.words">Document</A>&nbsp;<B>getDocument</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the document object that is currently being saved.
            </summary><example><p><b>Example:</b></p>Shows how to involve an image saving callback in an HTML conversion process.<pre>
public void imageSavingCallback() throws Exception {
    Document doc = new Document(getMyDir() + "Rendering.docx");

    // When we save the document to HTML, we can pass a SaveOptions object to designate a callback
    // to customize the image saving process.
    HtmlSaveOptions options = new HtmlSaveOptions();
    options.setImageSavingCallback(new ImageShapePrinter());

    doc.save(getArtifactsDir() + "HtmlSaveOptions.ImageSavingCallback.html", options);
}

/// &lt;summary&gt;
/// Prints the properties of each image as the saving process saves it to an image file in the local file system
/// during the exporting of a document to HTML.
/// &lt;/summary&gt;
private static class ImageShapePrinter implements IImageSavingCallback {
    public void imageSaving(ImageSavingArgs args) throws Exception {
        args.setKeepImageStreamOpen(false);
        Assert.assertTrue(args.isImageAvailable());

        String[] splitOriginalFileName = args.getDocument().getOriginalFileName().split("\\\\");
        System.out.println(MessageFormat.format("{0} Image #{1}", splitOriginalFileName[splitOriginalFileName.length - 1], ++mImageCount));

        LayoutCollector layoutCollector = new LayoutCollector(args.getDocument());

        System.out.println(MessageFormat.format("\tOn page:\t{0}", layoutCollector.getStartPageIndex(args.getCurrentShape())));
        System.out.println(MessageFormat.format("\tDimensions:\t{0}", args.getCurrentShape().getBounds().toString()));
        System.out.println(MessageFormat.format("\tAlignment:\t{0}", args.getCurrentShape().getVerticalAlignment()));
        System.out.println(MessageFormat.format("\tWrap type:\t{0}", args.getCurrentShape().getWrapType()));
        System.out.println(MessageFormat.format("Output filename:\t{0}\n", args.getImageFileName()));
    }

    private int mImageCount;
}</pre></example>
</DL>
<HR>

<A NAME="ImageFileName"><!-- --></A><A NAME="getImageFileName()"><!-- --></A><A NAME="getImageFileName--"><!-- --></A><A NAME="setImageFileName(java.lang.String)"><!-- --></A><A NAME="setImageFileName-java.lang.String-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getImageFileName/setImageFileName</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getImageFileName</B>()&nbsp;/&nbsp;public void&nbsp;<B>setImageFileName</B>(java.lang.String&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets or sets the file name (without path) where the image will be saved to.
            </summary><remarks><p>This property allows you to redefine how the image file names are generated
            during export to HTML.</p><p>When the event is fired, this property contains the file name that was generated 
            by Aspose.Words. You can change the value of this property to save the image into a 
            different file. Note that file names must be unique.</p><p>Aspose.Words automatically generates a unique file name for every embedded image when 
            exporting to HTML format. How the image file name is generated 
            depends on whether you save the document to a file or to a stream.</p><p>When saving a document to a file, the generated image file name looks like 
            <i>&lt;document base file name&gt;.&lt;image number&gt;.&lt;extension&gt;</i>.</p><p>When saving a document to a stream, the generated image file name looks like 
            <i>Aspose.Words.&lt;document guid&gt;.&lt;image number&gt;.&lt;extension&gt;</i>.</p><p><cref><i>ImageFileName</i></cref> must contain only the file name without the path.
            Aspose.Words determines the path for saving and the value of the <code>src</code> attribute for writing 
            to HTML using the document file name, the <cref><A HREF="HtmlSaveOptions.html#ImagesFolder" title="property in class com.aspose.words.HtmlSaveOptions">HtmlSaveOptions.ImagesFolder</A></cref> and
            <cref><A HREF="HtmlSaveOptions.html#ImagesFolderAlias" title="property in class com.aspose.words.HtmlSaveOptions">HtmlSaveOptions.ImagesFolderAlias</A></cref> properties.</p></remarks><example><p><b>Example:</b></p>Shows how to split a document into parts and save them.<pre>
public void documentPartsFileNames() throws Exception {
    Document doc = new Document(getMyDir() + "Rendering.docx");
    String outFileName = "SavingCallback.DocumentPartsFileNames.html";

    // Create an "HtmlFixedSaveOptions" object, which we can pass to the document's "Save" method
    // to modify how we convert the document to HTML.
    HtmlSaveOptions options = new HtmlSaveOptions();

    // If we save the document normally, there will be one output HTML
    // document with all the source document's contents.
    // Set the "DocumentSplitCriteria" property to "DocumentSplitCriteria.SectionBreak" to
    // save our document to multiple HTML files: one for each section.
    options.setDocumentSplitCriteria(DocumentSplitCriteria.SECTION_BREAK);

    // Assign a custom callback to the "DocumentPartSavingCallback" property to alter the document part saving logic.
    options.setDocumentPartSavingCallback(new SavedDocumentPartRename(outFileName, options.getDocumentSplitCriteria()));

    // If we convert a document that contains images into html, we will end up with one html file which links to several images.
    // Each image will be in the form of a file in the local file system.
    // There is also a callback that can customize the name and file system location of each image.
    options.setImageSavingCallback(new SavedImageRename(outFileName));

    doc.save(getArtifactsDir() + outFileName, options);
}

/// &lt;summary&gt;
/// Sets custom filenames for output documents that the saving operation splits a document into.
/// &lt;/summary&gt;
private static class SavedDocumentPartRename implements IDocumentPartSavingCallback {
    public SavedDocumentPartRename(String outFileName, int documentSplitCriteria) {
        mOutFileName = outFileName;
        mDocumentSplitCriteria = documentSplitCriteria;
    }

    public void documentPartSaving(DocumentPartSavingArgs args) throws Exception {
        // We can access the entire source document via the "Document" property.
        Assert.assertTrue(args.getDocument().getOriginalFileName().endsWith("Rendering.docx"));

        String partType = "";

        switch (mDocumentSplitCriteria) {
            case DocumentSplitCriteria.PAGE_BREAK:
                partType = "Page";
                break;
            case DocumentSplitCriteria.COLUMN_BREAK:
                partType = "Column";
                break;
            case DocumentSplitCriteria.SECTION_BREAK:
                partType = "Section";
                break;
            case DocumentSplitCriteria.HEADING_PARAGRAPH:
                partType = "Paragraph from heading";
                break;
        }

        String partFileName = MessageFormat.format("{0} part {1}, of type {2}.{3}", mOutFileName, ++mCount, partType, FilenameUtils.getExtension(args.getDocumentPartFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output part file:
        args.setDocumentPartFileName(partFileName);

        // 2 -  Create a custom stream for the output part file:
        try (FileOutputStream outputStream = new FileOutputStream(getArtifactsDir() + partFileName)) {
            args.setDocumentPartStream(outputStream);
        }

        Assert.assertNotNull(args.getDocumentPartStream());
        Assert.assertFalse(args.getKeepDocumentPartStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
    private final int mDocumentSplitCriteria;
}

/// &lt;summary&gt;
/// Sets custom filenames for image files that an HTML conversion creates.
/// &lt;/summary&gt;
public static class SavedImageRename implements IImageSavingCallback {
    public SavedImageRename(String outFileName) {
        mOutFileName = outFileName;
    }

    public void imageSaving(ImageSavingArgs args) throws Exception {
        String imageFileName = MessageFormat.format("{0} shape {1}, of type {2}.{3}", mOutFileName, ++mCount, args.getCurrentShape().getShapeType(), FilenameUtils.getExtension(args.getImageFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output image file:
        args.setImageFileName(imageFileName);

        // 2 -  Create a custom stream for the output image file:
        args.setImageStream(new FileOutputStream(getArtifactsDir() + imageFileName));

        Assert.assertNotNull(args.getImageStream());
        Assert.assertTrue(args.isImageAvailable());
        Assert.assertFalse(args.getKeepImageStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
}</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="#CurrentShape" title="property in class com.aspose.words.ImageSavingArgs">CurrentShape</A></cref>, <cref seealso=""><A HREF="#IsImageAvailable" title="property in class com.aspose.words.ImageSavingArgs">IsImageAvailable</A></cref>, <cref seealso=""><A HREF="#ImageStream" title="property in class com.aspose.words.ImageSavingArgs">ImageStream</A></cref>, <cref seealso=""><A HREF="HtmlSaveOptions.html#ImagesFolder" title="property in class com.aspose.words.HtmlSaveOptions">HtmlSaveOptions.ImagesFolder</A></cref>, <cref seealso=""><A HREF="HtmlSaveOptions.html#ImagesFolderAlias" title="property in class com.aspose.words.HtmlSaveOptions">HtmlSaveOptions.ImagesFolderAlias</A></cref></DD></DL>
</DL>
<HR>

<A NAME="ImageStream"><!-- --></A><A NAME="getImageStream()"><!-- --></A><A NAME="getImageStream--"><!-- --></A><A NAME="setImageStream(java.io.OutputStream)"><!-- --></A><A NAME="setImageStream-java.io.OutputStream-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getImageStream/setImageStream</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.io.OutputStream&nbsp;<B>getImageStream</B>()&nbsp;/&nbsp;public void&nbsp;<B>setImageStream</B>(java.io.OutputStream&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Allows to specify the stream where the image will be saved to.
            </summary><remarks><p>This property allows you to save images to streams instead of files during HTML.</p><p>The default value is <code>null</code>. When this property is <code>null</code>, the image 
            will be saved to a file specified in the <cref><A HREF="#ImageFileName" title="property in class com.aspose.words.ImageSavingArgs">ImageFileName</A></cref> property.</p><p>Using <cref><A HREF="IImageSavingCallback.html" title="interface in com.aspose.words">IImageSavingCallback</A></cref> you cannot substitute one image with 
            another. It is intended only for control over location where to save images.</p></remarks><example><p><b>Example:</b></p>Shows how to involve an image saving callback in an HTML conversion process.<pre>
public void imageSavingCallback() throws Exception {
    Document doc = new Document(getMyDir() + "Rendering.docx");

    // When we save the document to HTML, we can pass a SaveOptions object to designate a callback
    // to customize the image saving process.
    HtmlSaveOptions options = new HtmlSaveOptions();
    options.setImageSavingCallback(new ImageShapePrinter());

    doc.save(getArtifactsDir() + "HtmlSaveOptions.ImageSavingCallback.html", options);
}

/// &lt;summary&gt;
/// Prints the properties of each image as the saving process saves it to an image file in the local file system
/// during the exporting of a document to HTML.
/// &lt;/summary&gt;
private static class ImageShapePrinter implements IImageSavingCallback {
    public void imageSaving(ImageSavingArgs args) throws Exception {
        args.setKeepImageStreamOpen(false);
        Assert.assertTrue(args.isImageAvailable());

        String[] splitOriginalFileName = args.getDocument().getOriginalFileName().split("\\\\");
        System.out.println(MessageFormat.format("{0} Image #{1}", splitOriginalFileName[splitOriginalFileName.length - 1], ++mImageCount));

        LayoutCollector layoutCollector = new LayoutCollector(args.getDocument());

        System.out.println(MessageFormat.format("\tOn page:\t{0}", layoutCollector.getStartPageIndex(args.getCurrentShape())));
        System.out.println(MessageFormat.format("\tDimensions:\t{0}", args.getCurrentShape().getBounds().toString()));
        System.out.println(MessageFormat.format("\tAlignment:\t{0}", args.getCurrentShape().getVerticalAlignment()));
        System.out.println(MessageFormat.format("\tWrap type:\t{0}", args.getCurrentShape().getWrapType()));
        System.out.println(MessageFormat.format("Output filename:\t{0}\n", args.getImageFileName()));
    }

    private int mImageCount;
}</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="#ImageFileName" title="property in class com.aspose.words.ImageSavingArgs">ImageFileName</A></cref>, <cref seealso=""><A HREF="#KeepImageStreamOpen" title="property in class com.aspose.words.ImageSavingArgs">KeepImageStreamOpen</A></cref></DD></DL>
</DL>
<HR>

<A NAME="IsImageAvailable"><!-- --></A><A NAME="isImageAvailable()"><!-- --></A><A NAME="isImageAvailable--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>isImageAvailable</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public boolean&nbsp;<B>isImageAvailable</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns <code>true</code> if the current image is available for export.
            </summary><remarks><p>Some images in the document can be unavailable, for example, because the image
            is linked and the link is inaccessible or does not point to a valid image. 
            In this case Aspose.Words exports an icon with a red cross. This property returns 
            <code>true</code> if the original image is available; returns <code>false</code> if the original 
            image is not available and a "no image" icon will be offered for save.</p><p>When saving a group shape or a shape that doesn't require any image this property 
            is always <code>true</code>.</p></remarks><example><p><b>Example:</b></p>Shows how to involve an image saving callback in an HTML conversion process.<pre>
public void imageSavingCallback() throws Exception {
    Document doc = new Document(getMyDir() + "Rendering.docx");

    // When we save the document to HTML, we can pass a SaveOptions object to designate a callback
    // to customize the image saving process.
    HtmlSaveOptions options = new HtmlSaveOptions();
    options.setImageSavingCallback(new ImageShapePrinter());

    doc.save(getArtifactsDir() + "HtmlSaveOptions.ImageSavingCallback.html", options);
}

/// &lt;summary&gt;
/// Prints the properties of each image as the saving process saves it to an image file in the local file system
/// during the exporting of a document to HTML.
/// &lt;/summary&gt;
private static class ImageShapePrinter implements IImageSavingCallback {
    public void imageSaving(ImageSavingArgs args) throws Exception {
        args.setKeepImageStreamOpen(false);
        Assert.assertTrue(args.isImageAvailable());

        String[] splitOriginalFileName = args.getDocument().getOriginalFileName().split("\\\\");
        System.out.println(MessageFormat.format("{0} Image #{1}", splitOriginalFileName[splitOriginalFileName.length - 1], ++mImageCount));

        LayoutCollector layoutCollector = new LayoutCollector(args.getDocument());

        System.out.println(MessageFormat.format("\tOn page:\t{0}", layoutCollector.getStartPageIndex(args.getCurrentShape())));
        System.out.println(MessageFormat.format("\tDimensions:\t{0}", args.getCurrentShape().getBounds().toString()));
        System.out.println(MessageFormat.format("\tAlignment:\t{0}", args.getCurrentShape().getVerticalAlignment()));
        System.out.println(MessageFormat.format("\tWrap type:\t{0}", args.getCurrentShape().getWrapType()));
        System.out.println(MessageFormat.format("Output filename:\t{0}\n", args.getImageFileName()));
    }

    private int mImageCount;
}</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="#CurrentShape" title="property in class com.aspose.words.ImageSavingArgs">CurrentShape</A></cref></DD></DL>
</DL>
<HR>

<A NAME="KeepImageStreamOpen"><!-- --></A><A NAME="getKeepImageStreamOpen()"><!-- --></A><A NAME="getKeepImageStreamOpen--"><!-- --></A><A NAME="setKeepImageStreamOpen(boolean)"><!-- --></A><A NAME="setKeepImageStreamOpen-boolean-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getKeepImageStreamOpen/setKeepImageStreamOpen</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public boolean&nbsp;<B>getKeepImageStreamOpen</B>()&nbsp;/&nbsp;public void&nbsp;<B>setKeepImageStreamOpen</B>(boolean&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Specifies whether Aspose.Words should keep the stream open or close it after saving an image.
            </summary><remarks><p>Default is <code>false</code> and Aspose.Words will close the stream you provided
            in the <cref><A HREF="#ImageStream" title="property in class com.aspose.words.ImageSavingArgs">ImageStream</A></cref> property after writing an image into it.
            Specify <code>true</code> to keep the stream open.</p></remarks><example><p><b>Example:</b></p>Shows how to involve an image saving callback in an HTML conversion process.<pre>
public void imageSavingCallback() throws Exception {
    Document doc = new Document(getMyDir() + "Rendering.docx");

    // When we save the document to HTML, we can pass a SaveOptions object to designate a callback
    // to customize the image saving process.
    HtmlSaveOptions options = new HtmlSaveOptions();
    options.setImageSavingCallback(new ImageShapePrinter());

    doc.save(getArtifactsDir() + "HtmlSaveOptions.ImageSavingCallback.html", options);
}

/// &lt;summary&gt;
/// Prints the properties of each image as the saving process saves it to an image file in the local file system
/// during the exporting of a document to HTML.
/// &lt;/summary&gt;
private static class ImageShapePrinter implements IImageSavingCallback {
    public void imageSaving(ImageSavingArgs args) throws Exception {
        args.setKeepImageStreamOpen(false);
        Assert.assertTrue(args.isImageAvailable());

        String[] splitOriginalFileName = args.getDocument().getOriginalFileName().split("\\\\");
        System.out.println(MessageFormat.format("{0} Image #{1}", splitOriginalFileName[splitOriginalFileName.length - 1], ++mImageCount));

        LayoutCollector layoutCollector = new LayoutCollector(args.getDocument());

        System.out.println(MessageFormat.format("\tOn page:\t{0}", layoutCollector.getStartPageIndex(args.getCurrentShape())));
        System.out.println(MessageFormat.format("\tDimensions:\t{0}", args.getCurrentShape().getBounds().toString()));
        System.out.println(MessageFormat.format("\tAlignment:\t{0}", args.getCurrentShape().getVerticalAlignment()));
        System.out.println(MessageFormat.format("\tWrap type:\t{0}", args.getCurrentShape().getWrapType()));
        System.out.println(MessageFormat.format("Output filename:\t{0}\n", args.getImageFileName()));
    }

    private int mImageCount;
}</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="#ImageStream" title="property in class com.aspose.words.ImageSavingArgs">ImageStream</A></cref></DD></DL>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>