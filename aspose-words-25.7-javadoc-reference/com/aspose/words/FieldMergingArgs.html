<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 19 Jul 2025 -->
<TITLE>FieldMergingArgs</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Class FieldMergingArgs</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A>
      <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>com.aspose.words.FieldMergingArgs</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>FieldMergingArgs </B><DT>extends <A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></DL>
</PRE>

<P>

<summary>
             Provides data for the <b>MergeField</b> event.
             <p>To learn more, visit the <a href="https://docs.aspose.com/words/net/mail-merge-and-reporting/">Mail Merge and Reporting</a> documentation article.</p></summary><remarks><p>The <b>MergeField</b> event occurs during mail merge when a simple mail merge
             field is encountered in the document. You can respond to this event to return
             text for the mail merge engine to insert into the document.</p></remarks><example><p><b>Example:</b></p>Shows how to execute a mail merge with a custom callback that handles merge data in the form of HTML documents.<pre>
public void insertHtml() throws Exception {
    Document doc = new Document(getMyDir() + "Field sample - MERGEFIELD.docx");

    // Add a handler for the MergeField event
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertHtml());

    final String htmlText = "&lt;html&gt;\r\n&lt;h1&gt;Hello world!&lt;/h1&gt;\r\n&lt;/html&gt;";

    // Execute mail merge
    doc.getMailMerge().execute(new String[]{"htmlField1"}, new String[]{htmlText});

    // Save resulting document with a new name
    doc.save(getArtifactsDir() + "MailMergeEvent.InsertHtml.docx");
}

private class HandleMergeFieldInsertHtml implements IFieldMergingCallback {
    // This is called when merge field is actually merged with data in the document.
    public void fieldMerging(final FieldMergingArgs args) throws Exception {
        // All merge fields that expect HTML data should be marked with some prefix, e.g. 'html'
        if (args.getDocumentFieldName().startsWith("html") &amp;&amp; args.getField().getFieldCode().contains("\\b")) {
            FieldMergeField field = args.getField();

            // Insert the text for this merge field as HTML data, using DocumentBuilder
            DocumentBuilder builder = new DocumentBuilder(args.getDocument());
            builder.moveToMergeField(args.getDocumentFieldName());
            builder.write(field.getTextBefore());
            builder.insertHtml((String) args.getFieldValue());

            // The HTML text itself should not be inserted
            // We have already inserted it as an HTML
            args.setText("");
        }
    }

    public void /*IFieldMergingCallback.*/imageFieldMerging(ImageFieldMergingArgs args) {
        // Do nothing
    }
}</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="IFieldMergingCallback.html" title="interface in com.aspose.words">IFieldMergingCallback</A></cref></DD></DL>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ========== PROPERTY SUMMARY =========== -->

<A NAME="property_summary"><!-- --></A>
<TABLE RULES="GROUPS" BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Property Getters/Setters Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="Document.html" title="class in com.aspose.words">Document</A></CODE></TD><TD><CODE><B><A HREF="#Document">getDocument</A></B>()</CODE></TD><TD ALIGN="right" ><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns the <cref><A HREF="#Document" title="property in class com.aspose.words.FieldMergingArgs">Document</A></cref> object for which the mail merge is performed.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#DocumentFieldName">getDocumentFieldName</A></B>()</CODE></TD><TD ALIGN="right" ><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the name of the merge field as specified in the document.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="FieldMergeField.html" title="class in com.aspose.words">FieldMergeField</A></CODE></TD><TD><CODE><B><A HREF="#Field">getField</A></B>()</CODE></TD><TD ALIGN="right" ><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the object that represents the current merge field.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#FieldName">getFieldName</A></B>()</CODE></TD><TD ALIGN="right" ><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the name of the merge field in the data source.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.Object</CODE></TD><TD><CODE><B><A HREF="#FieldValue">getFieldValue</A></B>()</CODE></TD><TD ALIGN="right" ><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#FieldValue">setFieldValue</A></B>(java.lang.Object&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets or sets the value of the field from the data source.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>int</CODE></TD><TD><CODE><B><A HREF="#RecordIndex">getRecordIndex</A></B>()</CODE></TD><TD ALIGN="right" ><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the zero based index of the record that is being merged.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#TableName">getTableName</A></B>()</CODE></TD><TD ALIGN="right" ><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the name of the data table for the current merge operation or empty string if the name is not available.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#Text">getText</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#Text">setText</A></B>(java.lang.String&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets or sets the text that will be inserted into the document for the current merge field.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ============ PROPERTY DETAIL ========== -->

<A NAME="property_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Property Getters/Setters Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="Document"><!-- --></A><A NAME="getDocument()"><!-- --></A><A NAME="getDocument--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getDocument</H3></TD><TD ALIGN="right" VALIGN="top"><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="Document.html" title="class in com.aspose.words">Document</A>&nbsp;<B>getDocument</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns the <cref><A HREF="#Document" title="property in class com.aspose.words.FieldMergingArgs">Document</A></cref> object for which the mail merge is performed.
            </summary><example><p><b>Example:</b></p>Shows how to execute a mail merge with a custom callback that handles merge data in the form of HTML documents.<pre>
public void insertHtml() throws Exception {
    Document doc = new Document(getMyDir() + "Field sample - MERGEFIELD.docx");

    // Add a handler for the MergeField event
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertHtml());

    final String htmlText = "&lt;html&gt;\r\n&lt;h1&gt;Hello world!&lt;/h1&gt;\r\n&lt;/html&gt;";

    // Execute mail merge
    doc.getMailMerge().execute(new String[]{"htmlField1"}, new String[]{htmlText});

    // Save resulting document with a new name
    doc.save(getArtifactsDir() + "MailMergeEvent.InsertHtml.docx");
}

private class HandleMergeFieldInsertHtml implements IFieldMergingCallback {
    // This is called when merge field is actually merged with data in the document.
    public void fieldMerging(final FieldMergingArgs args) throws Exception {
        // All merge fields that expect HTML data should be marked with some prefix, e.g. 'html'
        if (args.getDocumentFieldName().startsWith("html") &amp;&amp; args.getField().getFieldCode().contains("\\b")) {
            FieldMergeField field = args.getField();

            // Insert the text for this merge field as HTML data, using DocumentBuilder
            DocumentBuilder builder = new DocumentBuilder(args.getDocument());
            builder.moveToMergeField(args.getDocumentFieldName());
            builder.write(field.getTextBefore());
            builder.insertHtml((String) args.getFieldValue());

            // The HTML text itself should not be inserted
            // We have already inserted it as an HTML
            args.setText("");
        }
    }

    public void /*IFieldMergingCallback.*/imageFieldMerging(ImageFieldMergingArgs args) {
        // Do nothing
    }
}</pre></example>
</DL>
<HR>

<A NAME="DocumentFieldName"><!-- --></A><A NAME="getDocumentFieldName()"><!-- --></A><A NAME="getDocumentFieldName--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getDocumentFieldName</H3></TD><TD ALIGN="right" VALIGN="top"><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getDocumentFieldName</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the name of the merge field as specified in the document.
            </summary><remarks><p>If you have a mapping from a document field name to a different data source field name,
            then this is the original field name as specified in the document.</p><p>If you specified a field name prefix, for example "Image:MyFieldName" in the document,
            then <cref><A HREF="#DocumentFieldName" title="property in class com.aspose.words.FieldMergingArgs">DocumentFieldName</A></cref> returns field name without the prefix, that is "MyFieldName".</p></remarks><example><p><b>Example:</b></p>Shows how to execute a mail merge with a custom callback that handles merge data in the form of HTML documents.<pre>
public void insertHtml() throws Exception {
    Document doc = new Document(getMyDir() + "Field sample - MERGEFIELD.docx");

    // Add a handler for the MergeField event
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertHtml());

    final String htmlText = "&lt;html&gt;\r\n&lt;h1&gt;Hello world!&lt;/h1&gt;\r\n&lt;/html&gt;";

    // Execute mail merge
    doc.getMailMerge().execute(new String[]{"htmlField1"}, new String[]{htmlText});

    // Save resulting document with a new name
    doc.save(getArtifactsDir() + "MailMergeEvent.InsertHtml.docx");
}

private class HandleMergeFieldInsertHtml implements IFieldMergingCallback {
    // This is called when merge field is actually merged with data in the document.
    public void fieldMerging(final FieldMergingArgs args) throws Exception {
        // All merge fields that expect HTML data should be marked with some prefix, e.g. 'html'
        if (args.getDocumentFieldName().startsWith("html") &amp;&amp; args.getField().getFieldCode().contains("\\b")) {
            FieldMergeField field = args.getField();

            // Insert the text for this merge field as HTML data, using DocumentBuilder
            DocumentBuilder builder = new DocumentBuilder(args.getDocument());
            builder.moveToMergeField(args.getDocumentFieldName());
            builder.write(field.getTextBefore());
            builder.insertHtml((String) args.getFieldValue());

            // The HTML text itself should not be inserted
            // We have already inserted it as an HTML
            args.setText("");
        }
    }

    public void /*IFieldMergingCallback.*/imageFieldMerging(ImageFieldMergingArgs args) {
        // Do nothing
    }
}</pre></example>
</DL>
<HR>

<A NAME="Field"><!-- --></A><A NAME="getField()"><!-- --></A><A NAME="getField--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getField</H3></TD><TD ALIGN="right" VALIGN="top"><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="FieldMergeField.html" title="class in com.aspose.words">FieldMergeField</A>&nbsp;<B>getField</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the object that represents the current merge field.
            </summary><example><p><b>Example:</b></p>Shows how to execute a mail merge with a custom callback that handles merge data in the form of HTML documents.<pre>
public void insertHtml() throws Exception {
    Document doc = new Document(getMyDir() + "Field sample - MERGEFIELD.docx");

    // Add a handler for the MergeField event
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertHtml());

    final String htmlText = "&lt;html&gt;\r\n&lt;h1&gt;Hello world!&lt;/h1&gt;\r\n&lt;/html&gt;";

    // Execute mail merge
    doc.getMailMerge().execute(new String[]{"htmlField1"}, new String[]{htmlText});

    // Save resulting document with a new name
    doc.save(getArtifactsDir() + "MailMergeEvent.InsertHtml.docx");
}

private class HandleMergeFieldInsertHtml implements IFieldMergingCallback {
    // This is called when merge field is actually merged with data in the document.
    public void fieldMerging(final FieldMergingArgs args) throws Exception {
        // All merge fields that expect HTML data should be marked with some prefix, e.g. 'html'
        if (args.getDocumentFieldName().startsWith("html") &amp;&amp; args.getField().getFieldCode().contains("\\b")) {
            FieldMergeField field = args.getField();

            // Insert the text for this merge field as HTML data, using DocumentBuilder
            DocumentBuilder builder = new DocumentBuilder(args.getDocument());
            builder.moveToMergeField(args.getDocumentFieldName());
            builder.write(field.getTextBefore());
            builder.insertHtml((String) args.getFieldValue());

            // The HTML text itself should not be inserted
            // We have already inserted it as an HTML
            args.setText("");
        }
    }

    public void /*IFieldMergingCallback.*/imageFieldMerging(ImageFieldMergingArgs args) {
        // Do nothing
    }
}</pre></example>
</DL>
<HR>

<A NAME="FieldName"><!-- --></A><A NAME="getFieldName()"><!-- --></A><A NAME="getFieldName--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getFieldName</H3></TD><TD ALIGN="right" VALIGN="top"><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getFieldName</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the name of the merge field in the data source.
            </summary><remarks><p>If you have a mapping from a document field name to a different data source field name,
            then this is the mapped field name.</p><p>If you specified a field name prefix, for example "Image:MyFieldName" in the document,
            then <cref><A HREF="#FieldName" title="property in class com.aspose.words.FieldMergingArgs">FieldName</A></cref> returns field name without the prefix, that is "MyFieldName".</p></remarks><example><p><b>Example:</b></p>Shows how to insert checkbox form fields into a document during mail merge.<pre>
public void insertCheckBox() throws Exception {
    Document doc = new Document();
    DocumentBuilder builder = new DocumentBuilder(doc);

    builder.startTable();
    builder.insertCell();
    builder.insertField(" MERGEFIELD  TableStart:StudentCourse ");
    builder.insertCell();
    builder.insertField(" MERGEFIELD  CourseName ");
    builder.insertCell();
    builder.insertField(" MERGEFIELD  TableEnd:StudentCourse ");
    builder.endTable();

    // Add a handler for the MergeField event
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertCheckBox());

    // Execute mail merge with regions
    DataTable dataTable = getStudentCourseDataTable();
    doc.getMailMerge().executeWithRegions(dataTable);

    // Save resulting document with a new name
    doc.save(getArtifactsDir() + "MailMergeEvent.InsertCheckBox.docx");
}

private class HandleMergeFieldInsertCheckBox implements IFieldMergingCallback {
    // This is called for each merge field in the document
    // when Document.MailMerge.ExecuteWithRegions is called.
    public void fieldMerging(final FieldMergingArgs args) throws Exception {
        if (args.getDocumentFieldName().equals("CourseName")) {
            // The name of the table that we are merging can be found here
            Assert.assertEquals(args.getTableName(), "StudentCourse");

            // Insert the checkbox for this merge field, using DocumentBuilder
            DocumentBuilder builder = new DocumentBuilder(args.getDocument());
            builder.moveToMergeField(args.getFieldName());
            builder.insertCheckBox(args.getDocumentFieldName() + mCheckBoxCount, false, 0);
            // Get the actual value of the field
            String fieldValue = args.getFieldValue().toString();

            // In this case, for every record index 'n', the corresponding field value is "Course n"
            Assert.assertEquals(args.getRecordIndex(), Character.getNumericValue(fieldValue.charAt(7)));

            builder.write(fieldValue);
            mCheckBoxCount++;
        }
    }

    public void imageFieldMerging(final ImageFieldMergingArgs args) {
        // Do nothing
    }

    // Counter for CheckBox name generation.
    private int mCheckBoxCount;
}

// Create DataTable and fill it with data.
// In real life this DataTable should be filled from a database.
private static DataTable getStudentCourseDataTable() throws Exception {
    DataTable dataTable = new DataTable("StudentCourse");
    dataTable.getColumns().add("CourseName");
    for (int i = 0; i &lt; 10; i++) {
        DataRow datarow = dataTable.newRow();
        dataTable.getRows().add(datarow);
        datarow.set(0, "Course " + i);
    }
    return dataTable;
}</pre></example>
</DL>
<HR>

<A NAME="FieldValue"><!-- --></A><A NAME="getFieldValue()"><!-- --></A><A NAME="getFieldValue--"><!-- --></A><A NAME="setFieldValue(java.lang.Object)"><!-- --></A><A NAME="setFieldValue-java.lang.Object-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getFieldValue/setFieldValue</H3></TD><TD ALIGN="right" VALIGN="top"><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.Object&nbsp;<B>getFieldValue</B>()&nbsp;/&nbsp;public void&nbsp;<B>setFieldValue</B>(java.lang.Object&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets or sets the value of the field from the data source.
            </summary><remarks>
            This property contains a value that has just been selected from your data source
            for this field by the mail merge engine. You can also replace the value by setting the property.
            </remarks><example><p><b>Example:</b></p>Shows how to use data source value of the field.<pre>
public void fieldFormats() throws Exception {
    Document doc = new Document();
    DocumentBuilder builder = new DocumentBuilder(doc);
    builder.insertField("MERGEFIELD TextField \\* Caps", null);
    builder.write(", ");
    builder.insertField("MERGEFIELD TextField2 \\* Upper", null);
    builder.write(", ");
    builder.insertField("MERGEFIELD NumericField \\# 0.0", null);

    builder.getDocument().getMailMerge().setFieldMergingCallback(new FieldValueMergingCallback());

    builder.getDocument().getMailMerge().execute(
            new String[]{"TextField", "TextField2", "NumericField"},
            new Object[]{"Original value", "Original value", 10});

    Assert.assertEquals("New Value, New value from FieldMergingArgs, 20.0", doc.getText().trim());
}

private static class FieldValueMergingCallback implements IFieldMergingCallback {
    /// &lt;summary&gt;
    /// This is called when merge field is actually merged with data in the document.
    /// &lt;/summary&gt;
    public void /*IFieldMergingCallback.*/fieldMerging(FieldMergingArgs e) {
        switch (e.getFieldName()) {
            case "TextField":
                Assert.assertEquals("Original value", e.getFieldValue());
                e.setFieldValue("New value");
                break;
            case "TextField2":
                Assert.assertEquals("Original value", e.getFieldValue());
                e.setText("New value from FieldMergingArgs");   // Should suppress e.FieldValue and ignore format
                e.setFieldValue("new value");
                break;
            case "NumericField":
                Assert.assertEquals(10, e.getFieldValue());
                e.setFieldValue(20);
                break;
        }
    }

    public void /*IFieldMergingCallback.*/imageFieldMerging(ImageFieldMergingArgs e) {
        // Do nothing
    }
}</pre></example>
</DL>
<HR>

<A NAME="RecordIndex"><!-- --></A><A NAME="getRecordIndex()"><!-- --></A><A NAME="getRecordIndex--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getRecordIndex</H3></TD><TD ALIGN="right" VALIGN="top"><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public int&nbsp;<B>getRecordIndex</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the zero based index of the record that is being merged.
            </summary><example><p><b>Example:</b></p>Shows how to insert checkbox form fields into a document during mail merge.<pre>
public void insertCheckBox() throws Exception {
    Document doc = new Document();
    DocumentBuilder builder = new DocumentBuilder(doc);

    builder.startTable();
    builder.insertCell();
    builder.insertField(" MERGEFIELD  TableStart:StudentCourse ");
    builder.insertCell();
    builder.insertField(" MERGEFIELD  CourseName ");
    builder.insertCell();
    builder.insertField(" MERGEFIELD  TableEnd:StudentCourse ");
    builder.endTable();

    // Add a handler for the MergeField event
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertCheckBox());

    // Execute mail merge with regions
    DataTable dataTable = getStudentCourseDataTable();
    doc.getMailMerge().executeWithRegions(dataTable);

    // Save resulting document with a new name
    doc.save(getArtifactsDir() + "MailMergeEvent.InsertCheckBox.docx");
}

private class HandleMergeFieldInsertCheckBox implements IFieldMergingCallback {
    // This is called for each merge field in the document
    // when Document.MailMerge.ExecuteWithRegions is called.
    public void fieldMerging(final FieldMergingArgs args) throws Exception {
        if (args.getDocumentFieldName().equals("CourseName")) {
            // The name of the table that we are merging can be found here
            Assert.assertEquals(args.getTableName(), "StudentCourse");

            // Insert the checkbox for this merge field, using DocumentBuilder
            DocumentBuilder builder = new DocumentBuilder(args.getDocument());
            builder.moveToMergeField(args.getFieldName());
            builder.insertCheckBox(args.getDocumentFieldName() + mCheckBoxCount, false, 0);
            // Get the actual value of the field
            String fieldValue = args.getFieldValue().toString();

            // In this case, for every record index 'n', the corresponding field value is "Course n"
            Assert.assertEquals(args.getRecordIndex(), Character.getNumericValue(fieldValue.charAt(7)));

            builder.write(fieldValue);
            mCheckBoxCount++;
        }
    }

    public void imageFieldMerging(final ImageFieldMergingArgs args) {
        // Do nothing
    }

    // Counter for CheckBox name generation.
    private int mCheckBoxCount;
}

// Create DataTable and fill it with data.
// In real life this DataTable should be filled from a database.
private static DataTable getStudentCourseDataTable() throws Exception {
    DataTable dataTable = new DataTable("StudentCourse");
    dataTable.getColumns().add("CourseName");
    for (int i = 0; i &lt; 10; i++) {
        DataRow datarow = dataTable.newRow();
        dataTable.getRows().add(datarow);
        datarow.set(0, "Course " + i);
    }
    return dataTable;
}</pre></example>
</DL>
<HR>

<A NAME="TableName"><!-- --></A><A NAME="getTableName()"><!-- --></A><A NAME="getTableName--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getTableName</H3></TD><TD ALIGN="right" VALIGN="top"><CODE><B>&rarr;&nbsp;inherited&nbsp;from&nbsp;<A HREF="FieldMergingArgsBase.html" title="class in com.aspose.words">FieldMergingArgsBase</A></B></CODE></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getTableName</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the name of the data table for the current merge operation or empty string if the name is not available.
            </summary><example><p><b>Example:</b></p>Shows how to insert checkbox form fields into a document during mail merge.<pre>
public void insertCheckBox() throws Exception {
    Document doc = new Document();
    DocumentBuilder builder = new DocumentBuilder(doc);

    builder.startTable();
    builder.insertCell();
    builder.insertField(" MERGEFIELD  TableStart:StudentCourse ");
    builder.insertCell();
    builder.insertField(" MERGEFIELD  CourseName ");
    builder.insertCell();
    builder.insertField(" MERGEFIELD  TableEnd:StudentCourse ");
    builder.endTable();

    // Add a handler for the MergeField event
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertCheckBox());

    // Execute mail merge with regions
    DataTable dataTable = getStudentCourseDataTable();
    doc.getMailMerge().executeWithRegions(dataTable);

    // Save resulting document with a new name
    doc.save(getArtifactsDir() + "MailMergeEvent.InsertCheckBox.docx");
}

private class HandleMergeFieldInsertCheckBox implements IFieldMergingCallback {
    // This is called for each merge field in the document
    // when Document.MailMerge.ExecuteWithRegions is called.
    public void fieldMerging(final FieldMergingArgs args) throws Exception {
        if (args.getDocumentFieldName().equals("CourseName")) {
            // The name of the table that we are merging can be found here
            Assert.assertEquals(args.getTableName(), "StudentCourse");

            // Insert the checkbox for this merge field, using DocumentBuilder
            DocumentBuilder builder = new DocumentBuilder(args.getDocument());
            builder.moveToMergeField(args.getFieldName());
            builder.insertCheckBox(args.getDocumentFieldName() + mCheckBoxCount, false, 0);
            // Get the actual value of the field
            String fieldValue = args.getFieldValue().toString();

            // In this case, for every record index 'n', the corresponding field value is "Course n"
            Assert.assertEquals(args.getRecordIndex(), Character.getNumericValue(fieldValue.charAt(7)));

            builder.write(fieldValue);
            mCheckBoxCount++;
        }
    }

    public void imageFieldMerging(final ImageFieldMergingArgs args) {
        // Do nothing
    }

    // Counter for CheckBox name generation.
    private int mCheckBoxCount;
}

// Create DataTable and fill it with data.
// In real life this DataTable should be filled from a database.
private static DataTable getStudentCourseDataTable() throws Exception {
    DataTable dataTable = new DataTable("StudentCourse");
    dataTable.getColumns().add("CourseName");
    for (int i = 0; i &lt; 10; i++) {
        DataRow datarow = dataTable.newRow();
        dataTable.getRows().add(datarow);
        datarow.set(0, "Course " + i);
    }
    return dataTable;
}</pre></example>
</DL>
<HR>

<A NAME="Text"><!-- --></A><A NAME="getText()"><!-- --></A><A NAME="getText--"><!-- --></A><A NAME="setText(java.lang.String)"><!-- --></A><A NAME="setText-java.lang.String-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getText/setText</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getText</B>()&nbsp;/&nbsp;public void&nbsp;<B>setText</B>(java.lang.String&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets or sets the text that will be inserted into the document for the current merge field.
            </summary><remarks><p>When your event handler is called, this property is set to <code>null</code>.</p><p>If you leave Text as <code>null</code>, the mail merge engine will insert <cref><A HREF="#FieldValue" title="property in class com.aspose.words.FieldMergingArgs">FieldValue</A></cref> in place of the merge field.</p><p>If you set Text to any string (including empty), the string will be inserted into the document in place of the merge field.</p></remarks><example><p><b>Example:</b></p>Shows how to execute a mail merge with a custom callback that handles merge data in the form of HTML documents.<pre>
public void insertHtml() throws Exception {
    Document doc = new Document(getMyDir() + "Field sample - MERGEFIELD.docx");

    // Add a handler for the MergeField event
    doc.getMailMerge().setFieldMergingCallback(new HandleMergeFieldInsertHtml());

    final String htmlText = "&lt;html&gt;\r\n&lt;h1&gt;Hello world!&lt;/h1&gt;\r\n&lt;/html&gt;";

    // Execute mail merge
    doc.getMailMerge().execute(new String[]{"htmlField1"}, new String[]{htmlText});

    // Save resulting document with a new name
    doc.save(getArtifactsDir() + "MailMergeEvent.InsertHtml.docx");
}

private class HandleMergeFieldInsertHtml implements IFieldMergingCallback {
    // This is called when merge field is actually merged with data in the document.
    public void fieldMerging(final FieldMergingArgs args) throws Exception {
        // All merge fields that expect HTML data should be marked with some prefix, e.g. 'html'
        if (args.getDocumentFieldName().startsWith("html") &amp;&amp; args.getField().getFieldCode().contains("\\b")) {
            FieldMergeField field = args.getField();

            // Insert the text for this merge field as HTML data, using DocumentBuilder
            DocumentBuilder builder = new DocumentBuilder(args.getDocument());
            builder.moveToMergeField(args.getDocumentFieldName());
            builder.write(field.getTextBefore());
            builder.insertHtml((String) args.getFieldValue());

            // The HTML text itself should not be inserted
            // We have already inserted it as an HTML
            args.setText("");
        }
    }

    public void /*IFieldMergingCallback.*/imageFieldMerging(ImageFieldMergingArgs args) {
        // Do nothing
    }
}</pre></example>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>