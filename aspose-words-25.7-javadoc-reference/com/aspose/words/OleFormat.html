<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 19 Jul 2025 -->
<TITLE>OleFormat</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Class OleFormat</H2>
<PRE>
java.lang.Object
    <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>com.aspose.words.OleFormat</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>OleFormat </B><DT>extends java.lang.Object</DL>
</PRE>

<P>

<summary>
             Provides access to the data of an OLE object or ActiveX control.
             <p>To learn more, visit the <a href="https://docs.aspose.com/words/net/working-with-ole-objects/">Working with Ole Objects</a> documentation article.</p></summary><remarks><p>Use the <cref><A HREF="Shape.html#OleFormat" title="property in class com.aspose.words.Shape">Shape.OleFormat</A></cref> property to access the data of an OLE object.
             You do not create instances of the <cref><i>OleFormat</i></cref> class directly.</p></remarks><example><p><b>Example:</b></p>Shows how to extract embedded OLE objects into files.<pre>
Document doc = new Document(getMyDir() + "OLE spreadsheet.docm");
Shape shape = (Shape) doc.getChild(NodeType.SHAPE, 0, true);

// The OLE object in the first shape is a Microsoft Excel spreadsheet.
OleFormat oleFormat = shape.getOleFormat();

Assert.assertEquals("Excel.Sheet.12", oleFormat.getProgId());

// Our object is neither auto updating nor locked from updates.
Assert.assertFalse(oleFormat.getAutoUpdate());
Assert.assertEquals(oleFormat.isLocked(), false);

// If we plan on saving the OLE object to a file in the local file system,
// we can use the "SuggestedExtension" property to determine which file extension to apply to the file.
Assert.assertEquals(".xlsx", oleFormat.getSuggestedExtension());

// Below are two ways of saving an OLE object to a file in the local file system.
// 1 -  Save it via a stream:
OutputStream fs = new FileOutputStream(getArtifactsDir() + "OLE spreadsheet extracted via stream" + oleFormat.getSuggestedExtension());
try {
    oleFormat.save(fs);
} finally {
    if (fs != null) fs.close();
}

// 2 -  Save it directly to a filename:
oleFormat.save(getArtifactsDir() + "OLE spreadsheet saved directly" + oleFormat.getSuggestedExtension());</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="Shape.html#OleFormat" title="property in class com.aspose.words.Shape">Shape.OleFormat</A></cref></DD></DL>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ========== PROPERTY SUMMARY =========== -->

<A NAME="property_summary"><!-- --></A>
<TABLE RULES="GROUPS" BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Property Getters/Setters Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>boolean</CODE></TD><TD><CODE><B><A HREF="#AutoUpdate">getAutoUpdate</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#AutoUpdate">setAutoUpdate</A></B>(boolean&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Specifies whether the link to the OLE object is automatically updated or not in Microsoft Word.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.util.UUID</CODE></TD><TD><CODE><B><A HREF="#Clsid">getClsid</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the CLSID of the OLE object.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#IconCaption">getIconCaption</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets icon caption of OLE object.
            <p>In case if the OLE object does not have an icon or a caption cannot be retrieved, returns an empty
            string.</p></TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>boolean</CODE></TD><TD><CODE><B><A HREF="#IsLink">isLink</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns <code>true</code> if the OLE object is linked (when <cref><A HREF="#SourceFullName" title="property in class com.aspose.words.OleFormat">SourceFullName</A></cref> is specified).
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>boolean</CODE></TD><TD><CODE><B><A HREF="#IsLocked">isLocked</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#IsLocked">isLocked</A></B>(boolean&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Specifies whether the link to the OLE object is locked from updates.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="OleControl.html" title="class in com.aspose.words">OleControl</A></CODE></TD><TD><CODE><B><A HREF="#OleControl">getOleControl</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets <cref><i>OleControl</i></cref> objects if this OLE object is an ActiveX control. Otherwise this property is null.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>boolean</CODE></TD><TD><CODE><B><A HREF="#OleIcon">getOleIcon</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the draw aspect of the OLE object. When <code>true</code>, the OLE object is displayed as an icon.
            When <code>false</code>, the OLE object is displayed as content.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="OlePackage.html" title="class in com.aspose.words">OlePackage</A></CODE></TD><TD><CODE><B><A HREF="#OlePackage">getOlePackage</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Provide access to <cref><A HREF="OlePackage.html" title="class in com.aspose.words">OlePackage</A></cref> if OLE object is an OLE Package.
            Returns <code>null</code> otherwise.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#ProgId">getProgId</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#ProgId">setProgId</A></B>(java.lang.String&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets or sets the ProgID of the OLE object.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#SourceFullName">getSourceFullName</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#SourceFullName">setSourceFullName</A></B>(java.lang.String&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Gets or sets the path and name of the source file for the linked OLE object.
             </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#SourceItem">getSourceItem</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>void</CODE></TD><TD><CODE><B><A HREF="#SourceItem">setSourceItem</A></B>(java.lang.String&nbsp;value)</CODE></TD><TD></TD>
</TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Gets or sets a string that is used to identify the portion of the source file that is being linked.
             </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#SuggestedExtension">getSuggestedExtension</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the file extension suggested for the current embedded object if you want to save it into a file.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#SuggestedFileName">getSuggestedFileName</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the file name suggested for the current embedded object if you want to save it into a file.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" RULES="GROUPS" FRAME="BOX" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>byte[]</CODE></TD><TD><CODE><B><A HREF="#getOleEntry(java.lang.String)">getOleEntry</A></B>(java.lang.String&nbsp;oleEntryName)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets OLE object data entry.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>byte[]</CODE></TD><TD><CODE><B><A HREF="#getRawData()">getRawData</A></B>()</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets OLE object raw data.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#save(java.io.OutputStream)">save</A></B>(java.io.OutputStream&nbsp;stream)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Saves the data of the embedded object into the specified stream.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#save(java.lang.String)">save</A></B>(java.lang.String&nbsp;fileName)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Saves the data of the embedded object into a file with the specified name.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ============ PROPERTY DETAIL ========== -->

<A NAME="property_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Property Getters/Setters Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="AutoUpdate"><!-- --></A><A NAME="getAutoUpdate()"><!-- --></A><A NAME="getAutoUpdate--"><!-- --></A><A NAME="setAutoUpdate(boolean)"><!-- --></A><A NAME="setAutoUpdate-boolean-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getAutoUpdate/setAutoUpdate</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public boolean&nbsp;<B>getAutoUpdate</B>()&nbsp;/&nbsp;public void&nbsp;<B>setAutoUpdate</B>(boolean&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Specifies whether the link to the OLE object is automatically updated or not in Microsoft Word.
            </summary><remarks><p>The default value is <code>false</code>.</p></remarks><example><p><b>Example:</b></p>Shows how to extract embedded OLE objects into files.<pre>
Document doc = new Document(getMyDir() + "OLE spreadsheet.docm");
Shape shape = (Shape) doc.getChild(NodeType.SHAPE, 0, true);

// The OLE object in the first shape is a Microsoft Excel spreadsheet.
OleFormat oleFormat = shape.getOleFormat();

Assert.assertEquals("Excel.Sheet.12", oleFormat.getProgId());

// Our object is neither auto updating nor locked from updates.
Assert.assertFalse(oleFormat.getAutoUpdate());
Assert.assertEquals(oleFormat.isLocked(), false);

// If we plan on saving the OLE object to a file in the local file system,
// we can use the "SuggestedExtension" property to determine which file extension to apply to the file.
Assert.assertEquals(".xlsx", oleFormat.getSuggestedExtension());

// Below are two ways of saving an OLE object to a file in the local file system.
// 1 -  Save it via a stream:
OutputStream fs = new FileOutputStream(getArtifactsDir() + "OLE spreadsheet extracted via stream" + oleFormat.getSuggestedExtension());
try {
    oleFormat.save(fs);
} finally {
    if (fs != null) fs.close();
}

// 2 -  Save it directly to a filename:
oleFormat.save(getArtifactsDir() + "OLE spreadsheet saved directly" + oleFormat.getSuggestedExtension());</pre></example>
</DL>
<HR>

<A NAME="Clsid"><!-- --></A><A NAME="getClsid()"><!-- --></A><A NAME="getClsid--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getClsid</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.util.UUID&nbsp;<B>getClsid</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the CLSID of the OLE object.
            </summary><example><p><b>Example:</b></p>Shows how to access an OLE control embedded in a document and its child controls.<pre>
Document doc = new Document(getMyDir() + "OLE ActiveX controls.docm");

// Shapes store and display OLE objects in the document's body.
Shape shape = (Shape) doc.getChild(NodeType.SHAPE, 0, true);

Assert.assertEquals("6e182020-f460-11ce-9bcd-00aa00608e01", shape.getOleFormat().getClsid().toString());

Forms2OleControl oleControl = (Forms2OleControl) shape.getOleFormat().getOleControl();

// Some OLE controls may contain child controls, such as the one in this document with three options buttons.
Forms2OleControlCollection oleControlCollection = oleControl.getChildNodes();

Assert.assertEquals(3, oleControlCollection.getCount());

Assert.assertEquals("C#", oleControlCollection.get(0).getCaption());
Assert.assertEquals("1", oleControlCollection.get(0).getValue());

Assert.assertEquals("Visual Basic", oleControlCollection.get(1).getCaption());
Assert.assertEquals("0", oleControlCollection.get(1).getValue());

Assert.assertEquals("Delphi", oleControlCollection.get(2).getCaption());
Assert.assertEquals("0", oleControlCollection.get(2).getValue());</pre></example>
</DL>
<HR>

<A NAME="IconCaption"><!-- --></A><A NAME="getIconCaption()"><!-- --></A><A NAME="getIconCaption--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getIconCaption</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getIconCaption</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets icon caption of OLE object.
            <p>In case if the OLE object does not have an icon or a caption cannot be retrieved, returns an empty
            string.</p></summary><example><p><b>Example:</b></p>Shows how to insert linked and unlinked OLE objects.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

// Embed a Microsoft Visio drawing into the document as an OLE object.
builder.insertOleObject(getImageDir() + "Microsoft Visio drawing.vsd", "Package", false, false, new FileInputStream(getImageDir() + "Transparent background logo.png"));

// Insert a link to the file in the local file system and display it as an icon.
builder.insertOleObject(getImageDir() + "Microsoft Visio drawing.vsd", "Package", true, true, new FileInputStream(getImageDir() + "Transparent background logo.png"));

// Inserting OLE objects creates shapes that store these objects.
List&lt;Shape&gt; shapeList = Arrays.stream(doc.getChildNodes(NodeType.SHAPE, true).toArray())
        .filter(Shape.class::isInstance)
        .map(Shape.class::cast)
        .collect(Collectors.toList());

Assert.assertEquals(2, shapeList.size());
Assert.assertEquals(2, IterableUtils.countMatches(shapeList, s -&gt; s.getShapeType() == ShapeType.OLE_OBJECT));

// If a shape contains an OLE object, it will have a valid "OleFormat" property,
// which we can use to verify some aspects of the shape.
OleFormat oleFormat = shapeList.get(0).getOleFormat();

Assert.assertEquals(false, oleFormat.isLink());
Assert.assertEquals(false, oleFormat.getOleIcon());

oleFormat = shapeList.get(1).getOleFormat();

Assert.assertEquals(true, oleFormat.isLink());
Assert.assertEquals(true, oleFormat.getOleIcon());

Assert.assertTrue(oleFormat.getSourceFullName().endsWith("Images" + File.separator + "Microsoft Visio drawing.vsd"));
Assert.assertEquals("", oleFormat.getSourceItem());

Assert.assertEquals("Microsoft Visio drawing.vsd", oleFormat.getIconCaption());

doc.save(getArtifactsDir() + "Shape.OleLinks.docx");

// If the object contains OLE data, we can access it using a stream.
byte[] oleEntryBytes = oleFormat.getOleEntry("\u0001CompObj");
Assert.assertEquals(76, oleEntryBytes.length);</pre></example>
</DL>
<HR>

<A NAME="IsLink"><!-- --></A><A NAME="isLink()"><!-- --></A><A NAME="isLink--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>isLink</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public boolean&nbsp;<B>isLink</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns <code>true</code> if the OLE object is linked (when <cref><A HREF="#SourceFullName" title="property in class com.aspose.words.OleFormat">SourceFullName</A></cref> is specified).
            </summary><example><p><b>Example:</b></p>Shows how to insert linked and unlinked OLE objects.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

// Embed a Microsoft Visio drawing into the document as an OLE object.
builder.insertOleObject(getImageDir() + "Microsoft Visio drawing.vsd", "Package", false, false, new FileInputStream(getImageDir() + "Transparent background logo.png"));

// Insert a link to the file in the local file system and display it as an icon.
builder.insertOleObject(getImageDir() + "Microsoft Visio drawing.vsd", "Package", true, true, new FileInputStream(getImageDir() + "Transparent background logo.png"));

// Inserting OLE objects creates shapes that store these objects.
List&lt;Shape&gt; shapeList = Arrays.stream(doc.getChildNodes(NodeType.SHAPE, true).toArray())
        .filter(Shape.class::isInstance)
        .map(Shape.class::cast)
        .collect(Collectors.toList());

Assert.assertEquals(2, shapeList.size());
Assert.assertEquals(2, IterableUtils.countMatches(shapeList, s -&gt; s.getShapeType() == ShapeType.OLE_OBJECT));

// If a shape contains an OLE object, it will have a valid "OleFormat" property,
// which we can use to verify some aspects of the shape.
OleFormat oleFormat = shapeList.get(0).getOleFormat();

Assert.assertEquals(false, oleFormat.isLink());
Assert.assertEquals(false, oleFormat.getOleIcon());

oleFormat = shapeList.get(1).getOleFormat();

Assert.assertEquals(true, oleFormat.isLink());
Assert.assertEquals(true, oleFormat.getOleIcon());

Assert.assertTrue(oleFormat.getSourceFullName().endsWith("Images" + File.separator + "Microsoft Visio drawing.vsd"));
Assert.assertEquals("", oleFormat.getSourceItem());

Assert.assertEquals("Microsoft Visio drawing.vsd", oleFormat.getIconCaption());

doc.save(getArtifactsDir() + "Shape.OleLinks.docx");

// If the object contains OLE data, we can access it using a stream.
byte[] oleEntryBytes = oleFormat.getOleEntry("\u0001CompObj");
Assert.assertEquals(76, oleEntryBytes.length);</pre></example>
</DL>
<HR>

<A NAME="IsLocked"><!-- --></A><A NAME="isLocked()"><!-- --></A><A NAME="isLocked--"><!-- --></A><A NAME="isLocked(boolean)"><!-- --></A><A NAME="isLocked-boolean-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>isLocked/isLocked</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public boolean&nbsp;<B>isLocked</B>()&nbsp;/&nbsp;public void&nbsp;<B>isLocked</B>(boolean&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Specifies whether the link to the OLE object is locked from updates.
            </summary><remarks><p>The default value is <code>false</code>.</p></remarks><example><p><b>Example:</b></p>Shows how to extract embedded OLE objects into files.<pre>
Document doc = new Document(getMyDir() + "OLE spreadsheet.docm");
Shape shape = (Shape) doc.getChild(NodeType.SHAPE, 0, true);

// The OLE object in the first shape is a Microsoft Excel spreadsheet.
OleFormat oleFormat = shape.getOleFormat();

Assert.assertEquals("Excel.Sheet.12", oleFormat.getProgId());

// Our object is neither auto updating nor locked from updates.
Assert.assertFalse(oleFormat.getAutoUpdate());
Assert.assertEquals(oleFormat.isLocked(), false);

// If we plan on saving the OLE object to a file in the local file system,
// we can use the "SuggestedExtension" property to determine which file extension to apply to the file.
Assert.assertEquals(".xlsx", oleFormat.getSuggestedExtension());

// Below are two ways of saving an OLE object to a file in the local file system.
// 1 -  Save it via a stream:
OutputStream fs = new FileOutputStream(getArtifactsDir() + "OLE spreadsheet extracted via stream" + oleFormat.getSuggestedExtension());
try {
    oleFormat.save(fs);
} finally {
    if (fs != null) fs.close();
}

// 2 -  Save it directly to a filename:
oleFormat.save(getArtifactsDir() + "OLE spreadsheet saved directly" + oleFormat.getSuggestedExtension());</pre></example>
</DL>
<HR>

<A NAME="OleControl"><!-- --></A><A NAME="getOleControl()"><!-- --></A><A NAME="getOleControl--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getOleControl</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="OleControl.html" title="class in com.aspose.words">OleControl</A>&nbsp;<B>getOleControl</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets <cref><i>OleControl</i></cref> objects if this OLE object is an ActiveX control. Otherwise this property is null.
            </summary><example><p><b>Example:</b></p>Shows how to verify the properties of an ActiveX control.<pre>
Document doc = new Document(getMyDir() + "ActiveX controls.docx");

Shape shape = (Shape) doc.getChild(NodeType.SHAPE, 0, true);
OleControl oleControl = shape.getOleFormat().getOleControl();

Assert.assertEquals(oleControl.getName(), "CheckBox1");

if (oleControl.isForms2OleControl()) {
    Forms2OleControl checkBox = (Forms2OleControl) oleControl;
    Assert.assertEquals(checkBox.getCaption(), "First");
    Assert.assertEquals(checkBox.getValue(), "0");
    Assert.assertEquals(checkBox.getEnabled(), true);
    Assert.assertEquals(checkBox.getType(), Forms2OleControlType.CHECK_BOX);
    Assert.assertEquals(checkBox.getChildNodes(), null);
}</pre></example>
</DL>
<HR>

<A NAME="OleIcon"><!-- --></A><A NAME="getOleIcon()"><!-- --></A><A NAME="getOleIcon--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getOleIcon</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public boolean&nbsp;<B>getOleIcon</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the draw aspect of the OLE object. When <code>true</code>, the OLE object is displayed as an icon.
            When <code>false</code>, the OLE object is displayed as content.
            </summary><remarks><p>Aspose.Words does not allow to set this property to avoid confusion. If you were able to change
            the draw aspect in Aspose.Words, Microsoft Word would still display the OLE object in its original
            draw aspect until you edit or update the OLE object in Microsoft Word.</p></remarks><example><p><b>Example:</b></p>Shows how to insert linked and unlinked OLE objects.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

// Embed a Microsoft Visio drawing into the document as an OLE object.
builder.insertOleObject(getImageDir() + "Microsoft Visio drawing.vsd", "Package", false, false, new FileInputStream(getImageDir() + "Transparent background logo.png"));

// Insert a link to the file in the local file system and display it as an icon.
builder.insertOleObject(getImageDir() + "Microsoft Visio drawing.vsd", "Package", true, true, new FileInputStream(getImageDir() + "Transparent background logo.png"));

// Inserting OLE objects creates shapes that store these objects.
List&lt;Shape&gt; shapeList = Arrays.stream(doc.getChildNodes(NodeType.SHAPE, true).toArray())
        .filter(Shape.class::isInstance)
        .map(Shape.class::cast)
        .collect(Collectors.toList());

Assert.assertEquals(2, shapeList.size());
Assert.assertEquals(2, IterableUtils.countMatches(shapeList, s -&gt; s.getShapeType() == ShapeType.OLE_OBJECT));

// If a shape contains an OLE object, it will have a valid "OleFormat" property,
// which we can use to verify some aspects of the shape.
OleFormat oleFormat = shapeList.get(0).getOleFormat();

Assert.assertEquals(false, oleFormat.isLink());
Assert.assertEquals(false, oleFormat.getOleIcon());

oleFormat = shapeList.get(1).getOleFormat();

Assert.assertEquals(true, oleFormat.isLink());
Assert.assertEquals(true, oleFormat.getOleIcon());

Assert.assertTrue(oleFormat.getSourceFullName().endsWith("Images" + File.separator + "Microsoft Visio drawing.vsd"));
Assert.assertEquals("", oleFormat.getSourceItem());

Assert.assertEquals("Microsoft Visio drawing.vsd", oleFormat.getIconCaption());

doc.save(getArtifactsDir() + "Shape.OleLinks.docx");

// If the object contains OLE data, we can access it using a stream.
byte[] oleEntryBytes = oleFormat.getOleEntry("\u0001CompObj");
Assert.assertEquals(76, oleEntryBytes.length);</pre></example>
</DL>
<HR>

<A NAME="OlePackage"><!-- --></A><A NAME="getOlePackage()"><!-- --></A><A NAME="getOlePackage--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getOlePackage</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="OlePackage.html" title="class in com.aspose.words">OlePackage</A>&nbsp;<B>getOlePackage</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Provide access to <cref><A HREF="OlePackage.html" title="class in com.aspose.words">OlePackage</A></cref> if OLE object is an OLE Package.
            Returns <code>null</code> otherwise.
            </summary><remarks>
            OLE Package is a legacy technology that allows to wrap any file format not present in the OLE registry of
            a Windows system into a generic package allowing to embed almost anything into a document.
            See <cref><A HREF="OlePackage.html" title="class in com.aspose.words">OlePackage</A></cref> type for more info.
            </remarks><example><p><b>Example:</b></p>Shows how insert an OLE object into a document.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

// OLE objects allow us to open other files in the local file system using another installed application
// in our operating system by double-clicking on the shape that contains the OLE object in the document body.
// In this case, our external file will be a ZIP archive.
byte[] zipFileBytes = DocumentHelper.getBytesFromStream(new FileInputStream(getDatabaseDir() + "cat001.zip"));

InputStream stream = new ByteArrayInputStream(zipFileBytes);
InputStream representingImage = new FileInputStream(getImageDir() + "Logo.jpg");
try {
    Shape shape = builder.insertOleObject(stream, "Package", true, representingImage);

    OlePackage setOlePackage = shape.getOleFormat().getOlePackage();
    setOlePackage.setFileName("Package file name.zip");
    setOlePackage.setDisplayName("Package display name.zip");

    doc.save(getArtifactsDir() + "Shape.InsertOlePackage.docx");
} finally {
    if (stream != null) {
        stream.close();
    }
}</pre></example>
</DL>
<HR>

<A NAME="ProgId"><!-- --></A><A NAME="getProgId()"><!-- --></A><A NAME="getProgId--"><!-- --></A><A NAME="setProgId(java.lang.String)"><!-- --></A><A NAME="setProgId-java.lang.String-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getProgId/setProgId</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getProgId</B>()&nbsp;/&nbsp;public void&nbsp;<B>setProgId</B>(java.lang.String&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets or sets the ProgID of the OLE object.
            </summary><remarks><p>The ProgID property is not always present in Microsoft Word documents and cannot be relied upon.</p><p>Cannot be <code>null</code>.</p><p>The default value is an empty string.</p></remarks><example><p><b>Example:</b></p>Shows how to extract embedded OLE objects into files.<pre>
Document doc = new Document(getMyDir() + "OLE spreadsheet.docm");
Shape shape = (Shape) doc.getChild(NodeType.SHAPE, 0, true);

// The OLE object in the first shape is a Microsoft Excel spreadsheet.
OleFormat oleFormat = shape.getOleFormat();

Assert.assertEquals("Excel.Sheet.12", oleFormat.getProgId());

// Our object is neither auto updating nor locked from updates.
Assert.assertFalse(oleFormat.getAutoUpdate());
Assert.assertEquals(oleFormat.isLocked(), false);

// If we plan on saving the OLE object to a file in the local file system,
// we can use the "SuggestedExtension" property to determine which file extension to apply to the file.
Assert.assertEquals(".xlsx", oleFormat.getSuggestedExtension());

// Below are two ways of saving an OLE object to a file in the local file system.
// 1 -  Save it via a stream:
OutputStream fs = new FileOutputStream(getArtifactsDir() + "OLE spreadsheet extracted via stream" + oleFormat.getSuggestedExtension());
try {
    oleFormat.save(fs);
} finally {
    if (fs != null) fs.close();
}

// 2 -  Save it directly to a filename:
oleFormat.save(getArtifactsDir() + "OLE spreadsheet saved directly" + oleFormat.getSuggestedExtension());</pre></example>
</DL>
<HR>

<A NAME="SourceFullName"><!-- --></A><A NAME="getSourceFullName()"><!-- --></A><A NAME="getSourceFullName--"><!-- --></A><A NAME="setSourceFullName(java.lang.String)"><!-- --></A><A NAME="setSourceFullName-java.lang.String-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getSourceFullName/setSourceFullName</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getSourceFullName</B>()&nbsp;/&nbsp;public void&nbsp;<B>setSourceFullName</B>(java.lang.String&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Gets or sets the path and name of the source file for the linked OLE object.
             </summary><remarks><p>The default value is an empty string.</p><p>If <cref><i>SourceFullName</i></cref> is not an empty string, the OLE object is linked.</p></remarks><example><p><b>Example:</b></p>Shows how to insert linked and unlinked OLE objects.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

// Embed a Microsoft Visio drawing into the document as an OLE object.
builder.insertOleObject(getImageDir() + "Microsoft Visio drawing.vsd", "Package", false, false, new FileInputStream(getImageDir() + "Transparent background logo.png"));

// Insert a link to the file in the local file system and display it as an icon.
builder.insertOleObject(getImageDir() + "Microsoft Visio drawing.vsd", "Package", true, true, new FileInputStream(getImageDir() + "Transparent background logo.png"));

// Inserting OLE objects creates shapes that store these objects.
List&lt;Shape&gt; shapeList = Arrays.stream(doc.getChildNodes(NodeType.SHAPE, true).toArray())
        .filter(Shape.class::isInstance)
        .map(Shape.class::cast)
        .collect(Collectors.toList());

Assert.assertEquals(2, shapeList.size());
Assert.assertEquals(2, IterableUtils.countMatches(shapeList, s -&gt; s.getShapeType() == ShapeType.OLE_OBJECT));

// If a shape contains an OLE object, it will have a valid "OleFormat" property,
// which we can use to verify some aspects of the shape.
OleFormat oleFormat = shapeList.get(0).getOleFormat();

Assert.assertEquals(false, oleFormat.isLink());
Assert.assertEquals(false, oleFormat.getOleIcon());

oleFormat = shapeList.get(1).getOleFormat();

Assert.assertEquals(true, oleFormat.isLink());
Assert.assertEquals(true, oleFormat.getOleIcon());

Assert.assertTrue(oleFormat.getSourceFullName().endsWith("Images" + File.separator + "Microsoft Visio drawing.vsd"));
Assert.assertEquals("", oleFormat.getSourceItem());

Assert.assertEquals("Microsoft Visio drawing.vsd", oleFormat.getIconCaption());

doc.save(getArtifactsDir() + "Shape.OleLinks.docx");

// If the object contains OLE data, we can access it using a stream.
byte[] oleEntryBytes = oleFormat.getOleEntry("\u0001CompObj");
Assert.assertEquals(76, oleEntryBytes.length);</pre></example>
</DL>
<HR>

<A NAME="SourceItem"><!-- --></A><A NAME="getSourceItem()"><!-- --></A><A NAME="getSourceItem--"><!-- --></A><A NAME="setSourceItem(java.lang.String)"><!-- --></A><A NAME="setSourceItem-java.lang.String-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getSourceItem/setSourceItem</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getSourceItem</B>()&nbsp;/&nbsp;public void&nbsp;<B>setSourceItem</B>(java.lang.String&nbsp;value)
</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Gets or sets a string that is used to identify the portion of the source file that is being linked.
             </summary><remarks><p>The default value is an empty string.</p><p>For example, if the source file is a Microsoft Excel workbook, the <cref><i>SourceItem</i></cref>
             property might return "Workbook1!R3C1:R4C2" if the OLE object contains only a few cells from
             the worksheet.</p></remarks><example><p><b>Example:</b></p>Shows how to insert linked and unlinked OLE objects.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

// Embed a Microsoft Visio drawing into the document as an OLE object.
builder.insertOleObject(getImageDir() + "Microsoft Visio drawing.vsd", "Package", false, false, new FileInputStream(getImageDir() + "Transparent background logo.png"));

// Insert a link to the file in the local file system and display it as an icon.
builder.insertOleObject(getImageDir() + "Microsoft Visio drawing.vsd", "Package", true, true, new FileInputStream(getImageDir() + "Transparent background logo.png"));

// Inserting OLE objects creates shapes that store these objects.
List&lt;Shape&gt; shapeList = Arrays.stream(doc.getChildNodes(NodeType.SHAPE, true).toArray())
        .filter(Shape.class::isInstance)
        .map(Shape.class::cast)
        .collect(Collectors.toList());

Assert.assertEquals(2, shapeList.size());
Assert.assertEquals(2, IterableUtils.countMatches(shapeList, s -&gt; s.getShapeType() == ShapeType.OLE_OBJECT));

// If a shape contains an OLE object, it will have a valid "OleFormat" property,
// which we can use to verify some aspects of the shape.
OleFormat oleFormat = shapeList.get(0).getOleFormat();

Assert.assertEquals(false, oleFormat.isLink());
Assert.assertEquals(false, oleFormat.getOleIcon());

oleFormat = shapeList.get(1).getOleFormat();

Assert.assertEquals(true, oleFormat.isLink());
Assert.assertEquals(true, oleFormat.getOleIcon());

Assert.assertTrue(oleFormat.getSourceFullName().endsWith("Images" + File.separator + "Microsoft Visio drawing.vsd"));
Assert.assertEquals("", oleFormat.getSourceItem());

Assert.assertEquals("Microsoft Visio drawing.vsd", oleFormat.getIconCaption());

doc.save(getArtifactsDir() + "Shape.OleLinks.docx");

// If the object contains OLE data, we can access it using a stream.
byte[] oleEntryBytes = oleFormat.getOleEntry("\u0001CompObj");
Assert.assertEquals(76, oleEntryBytes.length);</pre></example>
</DL>
<HR>

<A NAME="SuggestedExtension"><!-- --></A><A NAME="getSuggestedExtension()"><!-- --></A><A NAME="getSuggestedExtension--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getSuggestedExtension</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getSuggestedExtension</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the file extension suggested for the current embedded object if you want to save it into a file.
            </summary><example><p><b>Example:</b></p>Shows how to extract embedded OLE objects into files.<pre>
Document doc = new Document(getMyDir() + "OLE spreadsheet.docm");
Shape shape = (Shape) doc.getChild(NodeType.SHAPE, 0, true);

// The OLE object in the first shape is a Microsoft Excel spreadsheet.
OleFormat oleFormat = shape.getOleFormat();

Assert.assertEquals("Excel.Sheet.12", oleFormat.getProgId());

// Our object is neither auto updating nor locked from updates.
Assert.assertFalse(oleFormat.getAutoUpdate());
Assert.assertEquals(oleFormat.isLocked(), false);

// If we plan on saving the OLE object to a file in the local file system,
// we can use the "SuggestedExtension" property to determine which file extension to apply to the file.
Assert.assertEquals(".xlsx", oleFormat.getSuggestedExtension());

// Below are two ways of saving an OLE object to a file in the local file system.
// 1 -  Save it via a stream:
OutputStream fs = new FileOutputStream(getArtifactsDir() + "OLE spreadsheet extracted via stream" + oleFormat.getSuggestedExtension());
try {
    oleFormat.save(fs);
} finally {
    if (fs != null) fs.close();
}

// 2 -  Save it directly to a filename:
oleFormat.save(getArtifactsDir() + "OLE spreadsheet saved directly" + oleFormat.getSuggestedExtension());</pre></example>
</DL>
<HR>

<A NAME="SuggestedFileName"><!-- --></A><A NAME="getSuggestedFileName()"><!-- --></A><A NAME="getSuggestedFileName--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getSuggestedFileName</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getSuggestedFileName</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the file name suggested for the current embedded object if you want to save it into a file.
            </summary><example><p><b>Example:</b></p>Shows how to get an OLE object's suggested file name.<pre>
Document doc = new Document(getMyDir() + "OLE shape.rtf");

Shape oleShape = (Shape) doc.getFirstSection().getBody().getChild(NodeType.SHAPE, 0, true);

// OLE objects can provide a suggested filename and extension,
// which we can use when saving the object's contents into a file in the local file system.
String suggestedFileName = oleShape.getOleFormat().getSuggestedFileName();

Assert.assertEquals("CSV.csv", suggestedFileName);

OutputStream fileStream = new FileOutputStream(getArtifactsDir() + suggestedFileName);
try {
    oleShape.getOleFormat().save(fileStream);
} finally {
    if (fileStream != null) fileStream.close();
}</pre></example>
</DL>
<HR>



<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getOleEntry(java.lang.String)"><!-- --></A><A NAME="getOleEntry-java.lang.String-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getOleEntry</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public byte[]&nbsp;<B>getOleEntry</B>(java.lang.String&nbsp;oleEntryName)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets OLE object data entry.
            </summary><DL><DT><B>Parameters:</B></DT><DD param="oleEntryName"><CODE>oleEntryName</CODE> - Case-sensitive name of the OLE data stream.</DD></DL><DL><DT><B>Returns:</B></DT><DD returns="">An OLE data byte array or <code>null</code>.</DD></DL><example><p><b>Example:</b></p>Shows how to insert linked and unlinked OLE objects.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

// Embed a Microsoft Visio drawing into the document as an OLE object.
builder.insertOleObject(getImageDir() + "Microsoft Visio drawing.vsd", "Package", false, false, new FileInputStream(getImageDir() + "Transparent background logo.png"));

// Insert a link to the file in the local file system and display it as an icon.
builder.insertOleObject(getImageDir() + "Microsoft Visio drawing.vsd", "Package", true, true, new FileInputStream(getImageDir() + "Transparent background logo.png"));

// Inserting OLE objects creates shapes that store these objects.
List&lt;Shape&gt; shapeList = Arrays.stream(doc.getChildNodes(NodeType.SHAPE, true).toArray())
        .filter(Shape.class::isInstance)
        .map(Shape.class::cast)
        .collect(Collectors.toList());

Assert.assertEquals(2, shapeList.size());
Assert.assertEquals(2, IterableUtils.countMatches(shapeList, s -&gt; s.getShapeType() == ShapeType.OLE_OBJECT));

// If a shape contains an OLE object, it will have a valid "OleFormat" property,
// which we can use to verify some aspects of the shape.
OleFormat oleFormat = shapeList.get(0).getOleFormat();

Assert.assertEquals(false, oleFormat.isLink());
Assert.assertEquals(false, oleFormat.getOleIcon());

oleFormat = shapeList.get(1).getOleFormat();

Assert.assertEquals(true, oleFormat.isLink());
Assert.assertEquals(true, oleFormat.getOleIcon());

Assert.assertTrue(oleFormat.getSourceFullName().endsWith("Images" + File.separator + "Microsoft Visio drawing.vsd"));
Assert.assertEquals("", oleFormat.getSourceItem());

Assert.assertEquals("Microsoft Visio drawing.vsd", oleFormat.getIconCaption());

doc.save(getArtifactsDir() + "Shape.OleLinks.docx");

// If the object contains OLE data, we can access it using a stream.
byte[] oleEntryBytes = oleFormat.getOleEntry("\u0001CompObj");
Assert.assertEquals(76, oleEntryBytes.length);</pre></example>
</DL>
<HR>

<A NAME="getRawData()"><!-- --></A><A NAME="getRawData--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getRawData</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public byte[]&nbsp;<B>getRawData</B>()
                 throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets OLE object raw data.
            </summary><example><p><b>Example:</b></p>Shows how to access the raw data of an embedded OLE object.<pre>
Document doc = new Document(getMyDir() + "OLE objects.docx");

for (Node shape : (Iterable&lt;Node&gt;) doc.getChildNodes(NodeType.SHAPE, true)) {
    OleFormat oleFormat = ((Shape) shape).getOleFormat();
    if (oleFormat != null) {
        byte[] oleRawData = oleFormat.getRawData();

        Assert.assertEquals(24576, oleRawData.length);
    }
}</pre></example>
</DL>
<HR>

<A NAME="save(java.io.OutputStream)"><!-- --></A><A NAME="save-java.io.OutputStream-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>save</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>save</B>(java.io.OutputStream&nbsp;stream)
         throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Saves the data of the embedded object into the specified stream.
            </summary><remarks><p>It is the responsibility of the caller to dispose the stream.</p></remarks><DL><DT><B>Parameters:</B></DT><DD param="stream"><CODE>stream</CODE> - Where to save the object data.</DD></DL><example><p><b>Example:</b></p>Shows how to extract embedded OLE objects into files.<pre>
Document doc = new Document(getMyDir() + "OLE spreadsheet.docm");
Shape shape = (Shape) doc.getChild(NodeType.SHAPE, 0, true);

// The OLE object in the first shape is a Microsoft Excel spreadsheet.
OleFormat oleFormat = shape.getOleFormat();

Assert.assertEquals("Excel.Sheet.12", oleFormat.getProgId());

// Our object is neither auto updating nor locked from updates.
Assert.assertFalse(oleFormat.getAutoUpdate());
Assert.assertEquals(oleFormat.isLocked(), false);

// If we plan on saving the OLE object to a file in the local file system,
// we can use the "SuggestedExtension" property to determine which file extension to apply to the file.
Assert.assertEquals(".xlsx", oleFormat.getSuggestedExtension());

// Below are two ways of saving an OLE object to a file in the local file system.
// 1 -  Save it via a stream:
OutputStream fs = new FileOutputStream(getArtifactsDir() + "OLE spreadsheet extracted via stream" + oleFormat.getSuggestedExtension());
try {
    oleFormat.save(fs);
} finally {
    if (fs != null) fs.close();
}

// 2 -  Save it directly to a filename:
oleFormat.save(getArtifactsDir() + "OLE spreadsheet saved directly" + oleFormat.getSuggestedExtension());</pre></example>
</DL>
<HR>

<A NAME="save(java.lang.String)"><!-- --></A><A NAME="save-java.lang.String-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>save</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>save</B>(java.lang.String&nbsp;fileName)
         throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Saves the data of the embedded object into a file with the specified name.
            </summary><DL><DT><B>Parameters:</B></DT><DD param="fileName"><CODE>fileName</CODE> - Name of the file to save the OLE object data.</DD></DL><example><p><b>Example:</b></p>Shows how to extract embedded OLE objects into files.<pre>
Document doc = new Document(getMyDir() + "OLE spreadsheet.docm");
Shape shape = (Shape) doc.getChild(NodeType.SHAPE, 0, true);

// The OLE object in the first shape is a Microsoft Excel spreadsheet.
OleFormat oleFormat = shape.getOleFormat();

Assert.assertEquals("Excel.Sheet.12", oleFormat.getProgId());

// Our object is neither auto updating nor locked from updates.
Assert.assertFalse(oleFormat.getAutoUpdate());
Assert.assertEquals(oleFormat.isLocked(), false);

// If we plan on saving the OLE object to a file in the local file system,
// we can use the "SuggestedExtension" property to determine which file extension to apply to the file.
Assert.assertEquals(".xlsx", oleFormat.getSuggestedExtension());

// Below are two ways of saving an OLE object to a file in the local file system.
// 1 -  Save it via a stream:
OutputStream fs = new FileOutputStream(getArtifactsDir() + "OLE spreadsheet extracted via stream" + oleFormat.getSuggestedExtension());
try {
    oleFormat.save(fs);
} finally {
    if (fs != null) fs.close();
}

// 2 -  Save it directly to a filename:
oleFormat.save(getArtifactsDir() + "OLE spreadsheet saved directly" + oleFormat.getSuggestedExtension());</pre></example>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>