<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 19 Jul 2025 -->
<TITLE>FileFormatInfo</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Class FileFormatInfo</H2>
<PRE>
java.lang.Object
    <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>com.aspose.words.FileFormatInfo</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>FileFormatInfo </B><DT>extends java.lang.Object</DL>
</PRE>

<P>

<summary>
            Contains data returned by <cref><A HREF="FileFormatUtil.html" title="class in com.aspose.words">FileFormatUtil</A></cref> document format detection methods.
            <p>To learn more, visit the <a href="https://docs.aspose.com/words/net/detect-file-format-and-check-format-compatibility/">Detect File Format and Check Format Compatibility</a> documentation article.</p></summary><remarks><p>You do not create instances of this class directly. Objects of this class are returned by
            <cref><A HREF="FileFormatUtil.html#detectFileFormat(java.io.InputStream)" title="method in class com.aspose.words.FileFormatUtil">FileFormatUtil.detectFileFormat(java.io.InputStream)</A></cref> methods.</p></remarks><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil class to detect the document format and encryption.<pre>
Document doc = new Document();

// Configure a SaveOptions object to encrypt the document
// with a password when we save it, and then save the document.
OdtSaveOptions saveOptions = new OdtSaveOptions(SaveFormat.ODT);
saveOptions.setPassword("MyPassword");

doc.save(getArtifactsDir() + "File.DetectDocumentEncryption.odt", saveOptions);

// Verify the file type of our document, and its encryption status.
FileFormatInfo info = FileFormatUtil.detectFileFormat(getArtifactsDir() + "File.DetectDocumentEncryption.odt");

Assert.assertEquals(".odt", FileFormatUtil.loadFormatToExtension(info.getLoadFormat()));
Assert.assertTrue(info.isEncrypted());</pre></example><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil class to detect the document format and presence of digital signatures.<pre>
// Use a FileFormatInfo instance to verify that a document is not digitally signed.
FileFormatInfo info = FileFormatUtil.detectFileFormat(getMyDir() + "Document.docx");

Assert.assertEquals(".docx", FileFormatUtil.loadFormatToExtension(info.getLoadFormat()));
Assert.assertFalse(info.hasDigitalSignature());

CertificateHolder certificateHolder = CertificateHolder.create(getMyDir() + "morzal.pfx", "aw", null);
DigitalSignatureUtil.sign(getMyDir() + "Document.docx", getArtifactsDir() + "File.DetectDigitalSignatures.docx",
        certificateHolder);

// Use a new FileFormatInstance to confirm that it is signed.
info = FileFormatUtil.detectFileFormat(getArtifactsDir() + "File.DetectDigitalSignatures.docx");

Assert.assertTrue(info.hasDigitalSignature());

// We can load and access the signatures of a signed document in a collection like this.
Assert.assertEquals(1, DigitalSignatureUtil.loadSignatures(getArtifactsDir() + "File.DetectDigitalSignatures.docx").getCount());</pre></example>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ========== PROPERTY SUMMARY =========== -->

<A NAME="property_summary"><!-- --></A>
<TABLE RULES="GROUPS" BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Property Getters/Setters Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.nio.charset.Charset</CODE></TD><TD><CODE><B><A HREF="#Encoding">getEncoding</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the detected encoding if applicable to the current document format.
            At the moment detects encoding only for HTML documents.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>boolean</CODE></TD><TD><CODE><B><A HREF="#HasDigitalSignature">hasDigitalSignature</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns <code>true</code> if this document contains a digital signature.
            This property merely informs that a digital signature is present on a document,
            but it does not  specify whether the signature is valid or not.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>boolean</CODE></TD><TD><CODE><B><A HREF="#HasMacros">hasMacros</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns <code>true</code> if this document contains a VBA macros.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>boolean</CODE></TD><TD><CODE><B><A HREF="#IsEncrypted">isEncrypted</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Returns <code>true</code> if the document is encrypted and requires a password to open.
             </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>int</CODE></TD><TD><CODE><B><A HREF="#LoadFormat">getLoadFormat</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Gets the detected document format.
             The value of the property is <A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A> integer constant.</TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ============ PROPERTY DETAIL ========== -->

<A NAME="property_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Property Getters/Setters Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="Encoding"><!-- --></A><A NAME="getEncoding()"><!-- --></A><A NAME="getEncoding--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getEncoding</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.nio.charset.Charset&nbsp;<B>getEncoding</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the detected encoding if applicable to the current document format.
            At the moment detects encoding only for HTML documents.
            </summary><example><p><b>Example:</b></p>Shows how to detect encoding in an html file.<pre>
FileFormatInfo info = FileFormatUtil.detectFileFormat(getMyDir() + "Document.html");

Assert.assertEquals(LoadFormat.HTML, info.getLoadFormat());

// The Encoding property is used only when we create a FileFormatInfo object for an html document.
Assert.assertEquals("windows-1252", info.getEncoding().name());</pre></example>
</DL>
<HR>

<A NAME="HasDigitalSignature"><!-- --></A><A NAME="hasDigitalSignature()"><!-- --></A><A NAME="hasDigitalSignature--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>hasDigitalSignature</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public boolean&nbsp;<B>hasDigitalSignature</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns <code>true</code> if this document contains a digital signature.
            This property merely informs that a digital signature is present on a document,
            but it does not  specify whether the signature is valid or not.
            </summary><remarks><p>This property exists to help you sort documents that are digitally signed from those that are not.
            If you use Aspose.Words to modify and save a document that is digitally signed, then the digital signature will
            be lost. This is by design because a digital signature exists to guard the authenticity of a document.
            Using this property you can detect digitally signed documents before processing them in the same way as normal
            documents and take some action to avoid losing the digital signature, for example notify the user.
            </p></remarks><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil class to detect the document format and presence of digital signatures.<pre>
// Use a FileFormatInfo instance to verify that a document is not digitally signed.
FileFormatInfo info = FileFormatUtil.detectFileFormat(getMyDir() + "Document.docx");

Assert.assertEquals(".docx", FileFormatUtil.loadFormatToExtension(info.getLoadFormat()));
Assert.assertFalse(info.hasDigitalSignature());

CertificateHolder certificateHolder = CertificateHolder.create(getMyDir() + "morzal.pfx", "aw", null);
DigitalSignatureUtil.sign(getMyDir() + "Document.docx", getArtifactsDir() + "File.DetectDigitalSignatures.docx",
        certificateHolder);

// Use a new FileFormatInstance to confirm that it is signed.
info = FileFormatUtil.detectFileFormat(getArtifactsDir() + "File.DetectDigitalSignatures.docx");

Assert.assertTrue(info.hasDigitalSignature());

// We can load and access the signatures of a signed document in a collection like this.
Assert.assertEquals(1, DigitalSignatureUtil.loadSignatures(getArtifactsDir() + "File.DetectDigitalSignatures.docx").getCount());</pre></example>
</DL>
<HR>

<A NAME="HasMacros"><!-- --></A><A NAME="hasMacros()"><!-- --></A><A NAME="hasMacros--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>hasMacros</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public boolean&nbsp;<B>hasMacros</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns <code>true</code> if this document contains a VBA macros.
            </summary><example><p><b>Example:</b></p>Shows how to check VBA macro presence without loading document.<pre>
FileFormatInfo fileFormatInfo = FileFormatUtil.detectFileFormat(getMyDir() + "Macro.docm");
Assert.assertTrue(fileFormatInfo.hasMacros());</pre></example>
</DL>
<HR>

<A NAME="IsEncrypted"><!-- --></A><A NAME="isEncrypted()"><!-- --></A><A NAME="isEncrypted--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>isEncrypted</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public boolean&nbsp;<B>isEncrypted</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Returns <code>true</code> if the document is encrypted and requires a password to open.
             </summary><remarks><p>This property exists to help you sort documents that are encrypted from those that are not.
             If you attempt to load an encrypted document using Aspose.Words without supplying a password an
             exception will be thrown. You can use this property to detect whether a document requires a password
             and take some action before loading a document, for example, prompt the user for a password. </p></remarks><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil class to detect the document format and encryption.<pre>
Document doc = new Document();

// Configure a SaveOptions object to encrypt the document
// with a password when we save it, and then save the document.
OdtSaveOptions saveOptions = new OdtSaveOptions(SaveFormat.ODT);
saveOptions.setPassword("MyPassword");

doc.save(getArtifactsDir() + "File.DetectDocumentEncryption.odt", saveOptions);

// Verify the file type of our document, and its encryption status.
FileFormatInfo info = FileFormatUtil.detectFileFormat(getArtifactsDir() + "File.DetectDocumentEncryption.odt");

Assert.assertEquals(".odt", FileFormatUtil.loadFormatToExtension(info.getLoadFormat()));
Assert.assertTrue(info.isEncrypted());</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="#LoadFormat" title="property in class com.aspose.words.FileFormatInfo">LoadFormat</A></cref></DD></DL>
</DL>
<HR>

<A NAME="LoadFormat"><!-- --></A><A NAME="getLoadFormat()"><!-- --></A><A NAME="getLoadFormat--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getLoadFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public int&nbsp;<B>getLoadFormat</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Gets the detected document format.
             The value of the property is <A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A> integer constant.</summary><remarks><p>When an OOXML document is encrypted, it is not possible to ascertain whether it is
             an Excel, Word or PowerPoint document without decrypting it first so for an encrypted OOXML
             document this property will always return <cref><A HREF="LoadFormat.html#DOCX" title="field in class com.aspose.words.LoadFormat">LoadFormat.DOCX</A></cref>.</p></remarks><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil class to detect the document format and encryption.<pre>
Document doc = new Document();

// Configure a SaveOptions object to encrypt the document
// with a password when we save it, and then save the document.
OdtSaveOptions saveOptions = new OdtSaveOptions(SaveFormat.ODT);
saveOptions.setPassword("MyPassword");

doc.save(getArtifactsDir() + "File.DetectDocumentEncryption.odt", saveOptions);

// Verify the file type of our document, and its encryption status.
FileFormatInfo info = FileFormatUtil.detectFileFormat(getArtifactsDir() + "File.DetectDocumentEncryption.odt");

Assert.assertEquals(".odt", FileFormatUtil.loadFormatToExtension(info.getLoadFormat()));
Assert.assertTrue(info.isEncrypted());</pre></example><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil class to detect the document format and presence of digital signatures.<pre>
// Use a FileFormatInfo instance to verify that a document is not digitally signed.
FileFormatInfo info = FileFormatUtil.detectFileFormat(getMyDir() + "Document.docx");

Assert.assertEquals(".docx", FileFormatUtil.loadFormatToExtension(info.getLoadFormat()));
Assert.assertFalse(info.hasDigitalSignature());

CertificateHolder certificateHolder = CertificateHolder.create(getMyDir() + "morzal.pfx", "aw", null);
DigitalSignatureUtil.sign(getMyDir() + "Document.docx", getArtifactsDir() + "File.DetectDigitalSignatures.docx",
        certificateHolder);

// Use a new FileFormatInstance to confirm that it is signed.
info = FileFormatUtil.detectFileFormat(getArtifactsDir() + "File.DetectDigitalSignatures.docx");

Assert.assertTrue(info.hasDigitalSignature());

// We can load and access the signatures of a signed document in a collection like this.
Assert.assertEquals(1, DigitalSignatureUtil.loadSignatures(getArtifactsDir() + "File.DetectDigitalSignatures.docx").getCount());</pre></example><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil methods to detect the format of a document.<pre>
// Load a document from a file that is missing a file extension, and then detect its file format.
FileInputStream docStream = new FileInputStream(getMyDir() + "Word document with missing file extension");

FileFormatInfo info = FileFormatUtil.detectFileFormat(docStream);
/*LoadFormat*/
int loadFormat = info.getLoadFormat();

Assert.assertEquals(LoadFormat.DOC, loadFormat);

// Below are two methods of converting a LoadFormat to its corresponding SaveFormat.
// 1 -  Get the file extension string for the LoadFormat, then get the corresponding SaveFormat from that string:
String fileExtension = FileFormatUtil.loadFormatToExtension(loadFormat);
/*SaveFormat*/
int saveFormat = FileFormatUtil.extensionToSaveFormat(fileExtension);

// 2 -  Convert the LoadFormat directly to its SaveFormat:
saveFormat = FileFormatUtil.loadFormatToSaveFormat(loadFormat);

// Load a document from the stream, and then save it to the automatically detected file extension.
Document doc = new Document(docStream);

Assert.assertEquals(".doc", FileFormatUtil.saveFormatToExtension(saveFormat));

doc.save(getArtifactsDir() + "File.SaveToDetectedFileFormat" + FileFormatUtil.saveFormatToExtension(saveFormat));</pre></example><DL><DT><B>See Also:</B></DT><DD><cref seealso=""><A HREF="#IsEncrypted" title="property in class com.aspose.words.FileFormatInfo">IsEncrypted</A></cref></DD></DL>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>