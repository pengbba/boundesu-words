<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 19 Jul 2025 -->
<TITLE>IImageSavingCallback</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Interface IImageSavingCallback</H2>
<HR>
<DL>
<DT><PRE>public interface <B>IImageSavingCallback </B></DL>
</PRE>

<P>

<summary>
            Implement this interface if you want to control how Aspose.Words saves images when 
            saving a document to HTML. May be used by other formats.
            </summary><example><p><b>Example:</b></p>Shows how to rename the image name during saving into Markdown document.<pre>
public void renameImages() throws Exception {
    Document doc = new Document(getMyDir() + "Rendering.docx");

    MarkdownSaveOptions saveOptions = new MarkdownSaveOptions();
    // If we convert a document that contains images into Markdown, we will end up with one Markdown file which links to several images.
    // Each image will be in the form of a file in the local file system.
    // There is also a callback that can customize the name and file system location of each image.
    saveOptions.setImageSavingCallback(new SavedImageRename("MarkdownSaveOptions.HandleDocument.md"));
    saveOptions.setSaveFormat(SaveFormat.MARKDOWN);

    // The ImageSaving() method of our callback will be run at this time.
    doc.save(getArtifactsDir() + "MarkdownSaveOptions.HandleDocument.md", saveOptions);

    Supplier&lt;Stream&lt;String&gt;&gt; filteredShapes = () -&gt; DocumentHelper.directoryGetFiles(
            getArtifactsDir(), "*").stream().
            filter(s -&gt; s.startsWith(getArtifactsDir() + "MarkdownSaveOptions.HandleDocument.md shape"));

    Assert.assertEquals(1, filteredShapes.get().filter(f -&gt; f.endsWith(".jpeg")).count());
    Assert.assertEquals(8, filteredShapes.get().filter(f -&gt; f.endsWith(".png")).count());
}

/// &lt;summary&gt;
/// Renames saved images that are produced when an Markdown document is saved.
/// &lt;/summary&gt;
public static class SavedImageRename implements IImageSavingCallback
{
    public SavedImageRename(String outFileName)
    {
        mOutFileName = outFileName;
    }

    public void imageSaving(ImageSavingArgs args) throws Exception
    {
        String imageFileName = MessageFormat.format("{0} shape {1}, of type {2}.{3}",
                mOutFileName, ++mCount, args.getCurrentShape().getShapeType(),
                FilenameUtils.getExtension(args.getImageFileName()));

        args.setImageFileName(imageFileName);
        args.setImageStream(new FileOutputStream(getArtifactsDir() + imageFileName));

        Assert.assertTrue(args.isImageAvailable());
        Assert.assertFalse(args.getKeepImageStreamOpen());
    }

    private int mCount;
    private String mOutFileName;
}</pre></example><example><p><b>Example:</b></p>Shows how to split a document into parts and save them.<pre>
public void documentPartsFileNames() throws Exception {
    Document doc = new Document(getMyDir() + "Rendering.docx");
    String outFileName = "SavingCallback.DocumentPartsFileNames.html";

    // Create an "HtmlFixedSaveOptions" object, which we can pass to the document's "Save" method
    // to modify how we convert the document to HTML.
    HtmlSaveOptions options = new HtmlSaveOptions();

    // If we save the document normally, there will be one output HTML
    // document with all the source document's contents.
    // Set the "DocumentSplitCriteria" property to "DocumentSplitCriteria.SectionBreak" to
    // save our document to multiple HTML files: one for each section.
    options.setDocumentSplitCriteria(DocumentSplitCriteria.SECTION_BREAK);

    // Assign a custom callback to the "DocumentPartSavingCallback" property to alter the document part saving logic.
    options.setDocumentPartSavingCallback(new SavedDocumentPartRename(outFileName, options.getDocumentSplitCriteria()));

    // If we convert a document that contains images into html, we will end up with one html file which links to several images.
    // Each image will be in the form of a file in the local file system.
    // There is also a callback that can customize the name and file system location of each image.
    options.setImageSavingCallback(new SavedImageRename(outFileName));

    doc.save(getArtifactsDir() + outFileName, options);
}

/// &lt;summary&gt;
/// Sets custom filenames for output documents that the saving operation splits a document into.
/// &lt;/summary&gt;
private static class SavedDocumentPartRename implements IDocumentPartSavingCallback {
    public SavedDocumentPartRename(String outFileName, int documentSplitCriteria) {
        mOutFileName = outFileName;
        mDocumentSplitCriteria = documentSplitCriteria;
    }

    public void documentPartSaving(DocumentPartSavingArgs args) throws Exception {
        // We can access the entire source document via the "Document" property.
        Assert.assertTrue(args.getDocument().getOriginalFileName().endsWith("Rendering.docx"));

        String partType = "";

        switch (mDocumentSplitCriteria) {
            case DocumentSplitCriteria.PAGE_BREAK:
                partType = "Page";
                break;
            case DocumentSplitCriteria.COLUMN_BREAK:
                partType = "Column";
                break;
            case DocumentSplitCriteria.SECTION_BREAK:
                partType = "Section";
                break;
            case DocumentSplitCriteria.HEADING_PARAGRAPH:
                partType = "Paragraph from heading";
                break;
        }

        String partFileName = MessageFormat.format("{0} part {1}, of type {2}.{3}", mOutFileName, ++mCount, partType, FilenameUtils.getExtension(args.getDocumentPartFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output part file:
        args.setDocumentPartFileName(partFileName);

        // 2 -  Create a custom stream for the output part file:
        try (FileOutputStream outputStream = new FileOutputStream(getArtifactsDir() + partFileName)) {
            args.setDocumentPartStream(outputStream);
        }

        Assert.assertNotNull(args.getDocumentPartStream());
        Assert.assertFalse(args.getKeepDocumentPartStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
    private final int mDocumentSplitCriteria;
}

/// &lt;summary&gt;
/// Sets custom filenames for image files that an HTML conversion creates.
/// &lt;/summary&gt;
public static class SavedImageRename implements IImageSavingCallback {
    public SavedImageRename(String outFileName) {
        mOutFileName = outFileName;
    }

    public void imageSaving(ImageSavingArgs args) throws Exception {
        String imageFileName = MessageFormat.format("{0} shape {1}, of type {2}.{3}", mOutFileName, ++mCount, args.getCurrentShape().getShapeType(), FilenameUtils.getExtension(args.getImageFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output image file:
        args.setImageFileName(imageFileName);

        // 2 -  Create a custom stream for the output image file:
        args.setImageStream(new FileOutputStream(getArtifactsDir() + imageFileName));

        Assert.assertNotNull(args.getImageStream());
        Assert.assertTrue(args.isImageAvailable());
        Assert.assertFalse(args.getKeepImageStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
}</pre></example>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" RULES="GROUPS" FRAME="BOX" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>abstract&nbsp;void</CODE></TD><TD><CODE><B><A HREF="#imageSaving(com.aspose.words.ImageSavingArgs)">imageSaving</A></B>(<A HREF="ImageSavingArgs.html" title="class in com.aspose.words">ImageSavingArgs</A>&nbsp;args)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Called when Aspose.Words saves an image to HTML.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="imageSaving(com.aspose.words.ImageSavingArgs)"><!-- --></A><A NAME="imageSaving-com.aspose.words.ImageSavingArgs-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>imageSaving</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public abstract&nbsp;void&nbsp;<B>imageSaving</B>(<A HREF="ImageSavingArgs.html" title="class in com.aspose.words">ImageSavingArgs</A>&nbsp;args)
                              throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Called when Aspose.Words saves an image to HTML.
            </summary><example><p><b>Example:</b></p>Shows how to split a document into parts and save them.<pre>
public void documentPartsFileNames() throws Exception {
    Document doc = new Document(getMyDir() + "Rendering.docx");
    String outFileName = "SavingCallback.DocumentPartsFileNames.html";

    // Create an "HtmlFixedSaveOptions" object, which we can pass to the document's "Save" method
    // to modify how we convert the document to HTML.
    HtmlSaveOptions options = new HtmlSaveOptions();

    // If we save the document normally, there will be one output HTML
    // document with all the source document's contents.
    // Set the "DocumentSplitCriteria" property to "DocumentSplitCriteria.SectionBreak" to
    // save our document to multiple HTML files: one for each section.
    options.setDocumentSplitCriteria(DocumentSplitCriteria.SECTION_BREAK);

    // Assign a custom callback to the "DocumentPartSavingCallback" property to alter the document part saving logic.
    options.setDocumentPartSavingCallback(new SavedDocumentPartRename(outFileName, options.getDocumentSplitCriteria()));

    // If we convert a document that contains images into html, we will end up with one html file which links to several images.
    // Each image will be in the form of a file in the local file system.
    // There is also a callback that can customize the name and file system location of each image.
    options.setImageSavingCallback(new SavedImageRename(outFileName));

    doc.save(getArtifactsDir() + outFileName, options);
}

/// &lt;summary&gt;
/// Sets custom filenames for output documents that the saving operation splits a document into.
/// &lt;/summary&gt;
private static class SavedDocumentPartRename implements IDocumentPartSavingCallback {
    public SavedDocumentPartRename(String outFileName, int documentSplitCriteria) {
        mOutFileName = outFileName;
        mDocumentSplitCriteria = documentSplitCriteria;
    }

    public void documentPartSaving(DocumentPartSavingArgs args) throws Exception {
        // We can access the entire source document via the "Document" property.
        Assert.assertTrue(args.getDocument().getOriginalFileName().endsWith("Rendering.docx"));

        String partType = "";

        switch (mDocumentSplitCriteria) {
            case DocumentSplitCriteria.PAGE_BREAK:
                partType = "Page";
                break;
            case DocumentSplitCriteria.COLUMN_BREAK:
                partType = "Column";
                break;
            case DocumentSplitCriteria.SECTION_BREAK:
                partType = "Section";
                break;
            case DocumentSplitCriteria.HEADING_PARAGRAPH:
                partType = "Paragraph from heading";
                break;
        }

        String partFileName = MessageFormat.format("{0} part {1}, of type {2}.{3}", mOutFileName, ++mCount, partType, FilenameUtils.getExtension(args.getDocumentPartFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output part file:
        args.setDocumentPartFileName(partFileName);

        // 2 -  Create a custom stream for the output part file:
        try (FileOutputStream outputStream = new FileOutputStream(getArtifactsDir() + partFileName)) {
            args.setDocumentPartStream(outputStream);
        }

        Assert.assertNotNull(args.getDocumentPartStream());
        Assert.assertFalse(args.getKeepDocumentPartStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
    private final int mDocumentSplitCriteria;
}

/// &lt;summary&gt;
/// Sets custom filenames for image files that an HTML conversion creates.
/// &lt;/summary&gt;
public static class SavedImageRename implements IImageSavingCallback {
    public SavedImageRename(String outFileName) {
        mOutFileName = outFileName;
    }

    public void imageSaving(ImageSavingArgs args) throws Exception {
        String imageFileName = MessageFormat.format("{0} shape {1}, of type {2}.{3}", mOutFileName, ++mCount, args.getCurrentShape().getShapeType(), FilenameUtils.getExtension(args.getImageFileName()));

        // Below are two ways of specifying where Aspose.Words will save each part of the document.
        // 1 -  Set a filename for the output image file:
        args.setImageFileName(imageFileName);

        // 2 -  Create a custom stream for the output image file:
        args.setImageStream(new FileOutputStream(getArtifactsDir() + imageFileName));

        Assert.assertNotNull(args.getImageStream());
        Assert.assertTrue(args.isImageAvailable());
        Assert.assertFalse(args.getKeepImageStreamOpen());
    }

    private int mCount;
    private final String mOutFileName;
}</pre></example>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>