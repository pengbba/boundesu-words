<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 19 Jul 2025 -->
<TITLE>FontSettings</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Class FontSettings</H2>
<PRE>
java.lang.Object
    <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>com.aspose.words.FontSettings</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>FontSettings </B><DT>extends java.lang.Object</DL>
</PRE>

<P>

<summary>
             Specifies font settings for a document.
             <p>To learn more, visit the <a href="https://docs.aspose.com/words/net/working-with-fonts/">Working with Fonts</a> documentation article.</p></summary><remarks><p>Aspose.Words uses font settings to resolve the fonts in the document. Fonts are resolved mostly when building document layout
             or rendering to fixed page formats. But when loading some formats, Aspose.Words also may require to resolve the fonts. For example, when
             loading HTML documents Aspose.Words may resolve the fonts to perform font fallback. So it is recommended that you set the font settings in
             <cref><A HREF="LoadOptions.html" title="class in com.aspose.words">LoadOptions</A></cref> when loading the document. Or at least before building the layout or rendering the document to the fixed-page format.</p><p>By default all documents uses single static font settings instance. It could be accessed by
             <cref><A HREF="#DefaultInstance" title="property in class com.aspose.words.FontSettings">DefaultInstance</A></cref> property.</p><p>Changing font settings is safe at any time from any thread. But it is recommended that you do not change the font settings while
             processing some documents which uses this settings. This can lead to the fact that the same font will be resolved differently
             in different parts of the document.</p></remarks><example><p><b>Example:</b></p>Shows how to add a font source to our existing font sources.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.getFont().setName("Arial");
builder.writeln("Hello world!");
builder.getFont().setName("Amethysta");
builder.writeln("The quick brown fox jumps over the lazy dog.");
builder.getFont().setName("Junction Light");
builder.writeln("The quick brown fox jumps over the lazy dog.");

FontSourceBase[] originalFontSources = FontSettings.getDefaultInstance().getFontsSources();

Assert.assertEquals(1, originalFontSources.length);

Assert.assertTrue(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arial")));

// The default font source is missing two of the fonts that we are using in our document.
// When we save this document, Aspose.Words will apply fallback fonts to all text formatted with inaccessible fonts.
Assert.assertFalse(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));
Assert.assertFalse(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Junction Light")));

// Create a font source from a folder that contains fonts.
FolderFontSource folderFontSource = new FolderFontSource(getFontsDir(), true);

// Apply a new array of font sources that contains the original font sources, as well as our custom fonts.
FontSourceBase[] updatedFontSources = {originalFontSources[0], folderFontSource};
FontSettings.getDefaultInstance().setFontsSources(updatedFontSources);

// Verify that Aspose.Words has access to all required fonts before we render the document to PDF.
updatedFontSources = FontSettings.getDefaultInstance().getFontsSources();

Assert.assertTrue(IterableUtils.matchesAny(updatedFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arial")));
Assert.assertTrue(IterableUtils.matchesAny(updatedFontSources[1].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));
Assert.assertTrue(IterableUtils.matchesAny(updatedFontSources[1].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Junction Light")));

doc.save(getArtifactsDir() + "FontSettings.AddFontSource.pdf");

// Restore the original font sources.
FontSettings.getDefaultInstance().setFontsSources(originalFontSources);</pre></example><example><p><b>Example:</b></p>Shows how to set a font source directory.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.getFont().setName("Arvo");
builder.writeln("Hello world!");
builder.getFont().setName("Amethysta");
builder.writeln("The quick brown fox jumps over the lazy dog.");

// Our font sources do not contain the font that we have used for text in this document.
// If we use these font settings while rendering this document,
// Aspose.Words will apply a fallback font to text which has a font that Aspose.Words cannot locate.
FontSourceBase[] originalFontSources = FontSettings.getDefaultInstance().getFontsSources();

Assert.assertEquals(1, originalFontSources.length);
Assert.assertTrue(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arial")));

// The default font sources are missing the two fonts that we are using in this document.
Assert.assertFalse(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arvo")));
Assert.assertFalse(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));

// Use the "SetFontsFolder" method to set a directory which will act as a new font source.
// Pass "false" as the "recursive" argument to include fonts from all the font files that are in the directory
// that we are passing in the first argument, but not include any fonts in any of that directory's subfolders.
// Pass "true" as the "recursive" argument to include all font files in the directory that we are passing
// in the first argument, as well as all the fonts in its subdirectories.
FontSettings.getDefaultInstance().setFontsFolder(getFontsDir(), recursive);

FontSourceBase[] newFontSources = FontSettings.getDefaultInstance().getFontsSources();

Assert.assertEquals(1, newFontSources.length);
Assert.assertFalse(IterableUtils.matchesAny(newFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arial")));
Assert.assertTrue(IterableUtils.matchesAny(newFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arvo")));

// The "Amethysta" font is in a subfolder of the font directory.
if (recursive) {
    Assert.assertEquals(25, newFontSources[0].getAvailableFonts().size());
    Assert.assertTrue(IterableUtils.matchesAny(newFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));
} else {
    Assert.assertEquals(18, newFontSources[0].getAvailableFonts().size());
    Assert.assertFalse(IterableUtils.matchesAny(newFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));
}

doc.save(getArtifactsDir() + "FontSettings.SetFontsFolder.pdf");

// Restore the original font sources.
FontSettings.getDefaultInstance().setFontsSources(originalFontSources);</pre></example><example><p><b>Example:</b></p>Shows how to set multiple font source directories.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.getFont().setName("Amethysta");
builder.writeln("The quick brown fox jumps over the lazy dog.");
builder.getFont().setName("Junction Light");
builder.writeln("The quick brown fox jumps over the lazy dog.");

// Our font sources do not contain the font that we have used for text in this document.
// If we use these font settings while rendering this document,
// Aspose.Words will apply a fallback font to text which has a font that Aspose.Words cannot locate.
FontSourceBase[] originalFontSources = FontSettings.getDefaultInstance().getFontsSources();

Assert.assertEquals(1, originalFontSources.length);
Assert.assertTrue(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arial")));

// The default font sources are missing the two fonts that we are using in this document.
Assert.assertFalse(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));
Assert.assertFalse(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Junction Light")));

// Use the "SetFontsFolders" method to create a font source from each font directory that we pass as the first argument.
// Pass "false" as the "recursive" argument to include fonts from all the font files that are in the directories
// that we are passing in the first argument, but not include any fonts from any of the directories' subfolders.
// Pass "true" as the "recursive" argument to include all font files in the directories that we are passing
// in the first argument, as well as all the fonts in their subdirectories.
FontSettings.getDefaultInstance().setFontsFolders(new String[]{getFontsDir() + "/Amethysta", getFontsDir() + "/Junction"}, recursive);

FontSourceBase[] newFontSources = FontSettings.getDefaultInstance().getFontsSources();

Assert.assertEquals(2, newFontSources.length);
Assert.assertFalse(IterableUtils.matchesAny(newFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arial")));
Assert.assertEquals(1, newFontSources[0].getAvailableFonts().size());
Assert.assertTrue(IterableUtils.matchesAny(newFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));

// The "Junction" folder itself contains no font files, but has subfolders that do.
if (recursive) {
    Assert.assertEquals(6, newFontSources[1].getAvailableFonts().size());
    Assert.assertTrue(IterableUtils.matchesAny(newFontSources[1].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Junction Light")));
} else {
    Assert.assertEquals(0, newFontSources[1].getAvailableFonts().size());
}

doc.save(getArtifactsDir() + "FontSettings.SetFontsFolders.pdf");

// Restore the original font sources.
FontSettings.getDefaultInstance().setFontsSources(originalFontSources);</pre></example>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" ><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>

<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="#FontSettings()">FontSettings</A></B>()</CODE>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>&nbsp;

<!-- ========== PROPERTY SUMMARY =========== -->

<A NAME="property_summary"><!-- --></A>
<TABLE RULES="GROUPS" BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Property Getters/Setters Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>static&nbsp;<A HREF="FontSettings.html" title="class in com.aspose.words">FontSettings</A></CODE></TD><TD><CODE><B><A HREF="#DefaultInstance">getDefaultInstance</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Static default font settings.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="FontFallbackSettings.html" title="class in com.aspose.words">FontFallbackSettings</A></CODE></TD><TD><CODE><B><A HREF="#FallbackSettings">getFallbackSettings</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Settings related to font fallback mechanism.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="FontSubstitutionSettings.html" title="class in com.aspose.words">FontSubstitutionSettings</A></CODE></TD><TD><CODE><B><A HREF="#SubstitutionSettings">getSubstitutionSettings</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Settings related to font substitution mechanism.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" RULES="GROUPS" FRAME="BOX" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE><A HREF="FontSourceBase.html" title="class in com.aspose.words">FontSourceBase</A>[]</CODE></TD><TD><CODE><B><A HREF="#getFontsSources()">getFontsSources</A></B>()</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets a copy of the array that contains the list of sources where Aspose.Words looks for TrueType fonts.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#resetFontSources()">resetFontSources</A></B>()</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Resets the fonts sources to the system default.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#saveSearchCache(java.io.OutputStream)">saveSearchCache</A></B>(java.io.OutputStream&nbsp;outputStream)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Saves the font search cache to the stream.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#setFontsFolder(java.lang.String,boolean)">setFontsFolder</A></B>(java.lang.String&nbsp;fontFolder, boolean&nbsp;recursive)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Sets the folder where Aspose.Words looks for TrueType fonts when rendering documents or embedding fonts.
            This is a shortcut to <cref><A HREF="#setFontsFolders(java.lang.String[],boolean)" title="method in class com.aspose.words.FontSettings">setFontsFolders(java.lang.String[],boolean)</A></cref> for setting only one font directory.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#setFontsFolders(java.lang.String[],boolean)">setFontsFolders</A></B>(java.lang.String[]&nbsp;fontsFolders, boolean&nbsp;recursive)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Sets the folders where Aspose.Words looks for TrueType fonts when rendering documents or embedding fonts.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#setFontsSources(com.aspose.words.FontSourceBase[])">setFontsSources</A></B>(<A HREF="FontSourceBase.html" title="class in com.aspose.words">FontSourceBase</A>[]&nbsp;sources)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Sets the sources where Aspose.Words looks for TrueType fonts when rendering documents or embedding fonts.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#setFontsSources(com.aspose.words.FontSourceBase[],java.io.InputStream)">setFontsSources</A></B>(com.aspose.words.FontSourceBase[]&nbsp;sources, java.io.InputStream&nbsp;cacheInputStream)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Sets the sources where Aspose.Words looks for TrueType fonts and additionally loads previously saved
             font search cache.
             </TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="FontSettings()"><!-- --></A><A NAME="FontSettings--"><!-- --></A><H3>
FontSettings</H3>
<PRE>
public <B>FontSettings</B>()</PRE>
<DL><DD><summary />
</DL>
<HR>



<!-- ============ PROPERTY DETAIL ========== -->

<A NAME="property_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Property Getters/Setters Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="DefaultInstance"><!-- --></A><A NAME="getDefaultInstance()"><!-- --></A><A NAME="getDefaultInstance--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getDefaultInstance</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;<A HREF="FontSettings.html" title="class in com.aspose.words">FontSettings</A>&nbsp;<B>getDefaultInstance</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Static default font settings.
            </summary><remarks>
            This instance is used by default in a document unless <cref><A HREF="Document.html#FontSettings" title="property in class com.aspose.words.Document">Document.FontSettings</A></cref> is specified.
            </remarks><example><p><b>Example:</b></p>Shows how to configure the default font settings instance.<pre>
// Configure the default font settings instance to use the "Courier New" font
// as a backup substitute when we attempt to use an unknown font.
FontSettings.getDefaultInstance().getSubstitutionSettings().getDefaultFontSubstitution().setDefaultFontName("Courier New");

Assert.assertTrue(FontSettings.getDefaultInstance().getSubstitutionSettings().getDefaultFontSubstitution().getEnabled());

Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.getFont().setName("Non-existent font");
builder.write("Hello world!");

// This document does not have a FontSettings configuration. When we render the document,
// the default FontSettings instance will resolve the missing font.
// Aspose.Words will use "Courier New" to render text that uses the unknown font.
Assert.assertNull(doc.getFontSettings());

doc.save(getArtifactsDir() + "FontSettings.DefaultFontInstance.pdf");</pre></example><example><p><b>Example:</b></p>Shows how to use the IWarningCallback interface to monitor font substitution warnings.<pre>
public void substitutionWarning() throws Exception {
    Document doc = new Document();
    DocumentBuilder builder = new DocumentBuilder(doc);

    builder.getFont().setName("Times New Roman");
    builder.writeln("Hello world!");

    FontSubstitutionWarningCollector callback = new FontSubstitutionWarningCollector();
    doc.setWarningCallback(callback);

    // Store the current collection of font sources, which will be the default font source for every document
    // for which we do not specify a different font source.
    FontSourceBase[] originalFontSources = FontSettings.getDefaultInstance().getFontsSources();

    // For testing purposes, we will set Aspose.Words to look for fonts only in a folder that does not exist.
    FontSettings.getDefaultInstance().setFontsFolder("", false);

    // When rendering the document, there will be no place to find the "Times New Roman" font.
    // This will cause a font substitution warning, which our callback will detect.
    doc.save(getArtifactsDir() + "FontSettings.SubstitutionWarning.pdf");

    FontSettings.getDefaultInstance().setFontsSources(originalFontSources);

    Assert.assertTrue(callback.FontSubstitutionWarnings.get(0).getWarningType() == WarningType.FONT_SUBSTITUTION);
    Assert.assertTrue(callback.FontSubstitutionWarnings.get(0).getDescription()
            .equals("Font 'Times New Roman' has not been found. Using 'Fanwood' font instead. Reason: first available font."));
}

private static class FontSubstitutionWarningCollector implements IWarningCallback {
    /// &lt;summary&gt;
    /// Called every time a warning occurs during loading/saving.
    /// &lt;/summary&gt;
    public void warning(WarningInfo info) {
        if (info.getWarningType() == WarningType.FONT_SUBSTITUTION)
            FontSubstitutionWarnings.warning(info);
    }

    public WarningInfoCollection FontSubstitutionWarnings = new WarningInfoCollection();
}</pre></example>
</DL>
<HR>

<A NAME="FallbackSettings"><!-- --></A><A NAME="getFallbackSettings()"><!-- --></A><A NAME="getFallbackSettings--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getFallbackSettings</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="FontFallbackSettings.html" title="class in com.aspose.words">FontFallbackSettings</A>&nbsp;<B>getFallbackSettings</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Settings related to font fallback mechanism.
            </summary><example><p><b>Example:</b></p>Shows how to distribute fallback fonts across Unicode character code ranges.<pre>
Document doc = new Document();

FontSettings fontSettings = new FontSettings();
doc.setFontSettings(fontSettings);
FontFallbackSettings fontFallbackSettings = fontSettings.getFallbackSettings();

// Configure our font settings to source fonts only from the "MyFonts" folder.
FolderFontSource folderFontSource = new FolderFontSource(getFontsDir(), false);
fontSettings.setFontsSources(new FontSourceBase[]{folderFontSource});

// Calling the "BuildAutomatic" method will generate a fallback scheme that
// distributes accessible fonts across as many Unicode character codes as possible.
// In our case, it only has access to the handful of fonts inside the "MyFonts" folder.
fontFallbackSettings.buildAutomatic();
fontFallbackSettings.save(getArtifactsDir() + "FontSettings.FallbackSettingsCustom.BuildAutomatic.xml");

// We can also load a custom substitution scheme from a file like this.
// This scheme applies the "AllegroOpen" font across the "0000-00ff" Unicode blocks, the "AllegroOpen" font across "0100-024f",
// and the "M+ 2m" font in all other ranges that other fonts in the scheme do not cover.
fontFallbackSettings.load(getMyDir() + "Custom font fallback settings.xml");

// Create a document builder and set its font to one that does not exist in any of our sources.
// Our font settings will invoke the fallback scheme for characters that we type using the unavailable font.
DocumentBuilder builder = new DocumentBuilder(doc);
builder.getFont().setName("Missing Font");

// Use the builder to print every Unicode character from 0x0021 to 0x052F,
// with descriptive lines dividing Unicode blocks we defined in our custom font fallback scheme.
for (int i = 0x0021; i &lt; 0x0530; i++) {
    switch (i) {
        case 0x0021:
            builder.writeln("\n\n0x0021 - 0x00FF: \nBasic Latin/Latin-1 Supplement Unicode blocks in \"AllegroOpen\" font:");
            break;
        case 0x0100:
            builder.writeln("\n\n0x0100 - 0x024F: \nLatin Extended A/B blocks, mostly in \"AllegroOpen\" font:");
            break;
        case 0x0250:
            builder.writeln("\n\n0x0250 - 0x052F: \nIPA/Greek/Cyrillic blocks in \"M+ 2m\" font:");
            break;
    }

    builder.write(MessageFormat.format("{0}", (char) i));
}

doc.save(getArtifactsDir() + "FontSettings.FallbackSettingsCustom.pdf");</pre></example>
</DL>
<HR>

<A NAME="SubstitutionSettings"><!-- --></A><A NAME="getSubstitutionSettings()"><!-- --></A><A NAME="getSubstitutionSettings--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getSubstitutionSettings</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="FontSubstitutionSettings.html" title="class in com.aspose.words">FontSubstitutionSettings</A>&nbsp;<B>getSubstitutionSettings</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Settings related to font substitution mechanism.
            </summary><example><p><b>Example:</b></p>Shows how to access a document's system font source and set font substitutes.<pre>
Document doc = new Document();
doc.setFontSettings(new FontSettings());

// By default, a blank document always contains a system font source.
Assert.assertEquals(1, doc.getFontSettings().getFontsSources().length);

SystemFontSource systemFontSource = (SystemFontSource) doc.getFontSettings().getFontsSources()[0];
Assert.assertEquals(FontSourceType.SYSTEM_FONTS, systemFontSource.getType());
Assert.assertEquals(0, systemFontSource.getPriority());

if (SystemUtils.IS_OS_WINDOWS) {
    final String FONTS_PATH = "C:\\WINDOWS\\Fonts";
    Assert.assertEquals(FONTS_PATH.toLowerCase(), SystemFontSource.getSystemFontFolders()[0].toLowerCase());
}

for (String systemFontFolder : SystemFontSource.getSystemFontFolders()) {
    System.out.println(systemFontFolder);
}

// Set a font that exists in the Windows Fonts directory as a substitute for one that does not.
doc.getFontSettings().getSubstitutionSettings().getFontInfoSubstitution().setEnabled(true);
doc.getFontSettings().getSubstitutionSettings().getTableSubstitution().addSubstitutes("Kreon-Regular", "Calibri");

Assert.assertEquals(1, IterableUtils.size(doc.getFontSettings().getSubstitutionSettings().getTableSubstitution().getSubstitutes("Kreon-Regular")));
Assert.assertTrue(IterableUtils.toString(doc.getFontSettings().getSubstitutionSettings().getTableSubstitution().getSubstitutes("Kreon-Regular")).contains("Calibri"));

// Alternatively, we could add a folder font source in which the corresponding folder contains the font.
FolderFontSource folderFontSource = new FolderFontSource(getFontsDir(), false);
doc.getFontSettings().setFontsSources(new FontSourceBase[]{systemFontSource, folderFontSource});
Assert.assertEquals(2, doc.getFontSettings().getFontsSources().length);

// Resetting the font sources still leaves us with the system font source as well as our substitutes.
doc.getFontSettings().resetFontSources();

Assert.assertEquals(1, doc.getFontSettings().getFontsSources().length);
Assert.assertEquals(FontSourceType.SYSTEM_FONTS, doc.getFontSettings().getFontsSources()[0].getType());
Assert.assertEquals(1, IterableUtils.size(doc.getFontSettings().getSubstitutionSettings().getTableSubstitution().getSubstitutes("Kreon-Regular")));
Assert.assertTrue(doc.getFontSettings().getSubstitutionSettings().getFontNameSubstitution().getEnabled());</pre></example>
</DL>
<HR>



<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getFontsSources()"><!-- --></A><A NAME="getFontsSources--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getFontsSources</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="FontSourceBase.html" title="class in com.aspose.words">FontSourceBase</A>[]&nbsp;<B>getFontsSources</B>()</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets a copy of the array that contains the list of sources where Aspose.Words looks for TrueType fonts.
            </summary><remarks><p>The returned value is a copy of the data that Aspose.Words uses. If you change the entries
            in the returned array, it will have no effect on document rendering. To specify new font sources
            use the <cref><A HREF="#setFontsSources(com.aspose.words.FontSourceBase[])" title="method in class com.aspose.words.FontSettings">setFontsSources(com.aspose.words.FontSourceBase[])</A></cref> method.</p></remarks><DL><DT><B>Returns:</B></DT><DD returns="">A copy of the current font sources.</DD></DL><example><p><b>Example:</b></p>Shows how to add a font source to our existing font sources.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.getFont().setName("Arial");
builder.writeln("Hello world!");
builder.getFont().setName("Amethysta");
builder.writeln("The quick brown fox jumps over the lazy dog.");
builder.getFont().setName("Junction Light");
builder.writeln("The quick brown fox jumps over the lazy dog.");

FontSourceBase[] originalFontSources = FontSettings.getDefaultInstance().getFontsSources();

Assert.assertEquals(1, originalFontSources.length);

Assert.assertTrue(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arial")));

// The default font source is missing two of the fonts that we are using in our document.
// When we save this document, Aspose.Words will apply fallback fonts to all text formatted with inaccessible fonts.
Assert.assertFalse(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));
Assert.assertFalse(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Junction Light")));

// Create a font source from a folder that contains fonts.
FolderFontSource folderFontSource = new FolderFontSource(getFontsDir(), true);

// Apply a new array of font sources that contains the original font sources, as well as our custom fonts.
FontSourceBase[] updatedFontSources = {originalFontSources[0], folderFontSource};
FontSettings.getDefaultInstance().setFontsSources(updatedFontSources);

// Verify that Aspose.Words has access to all required fonts before we render the document to PDF.
updatedFontSources = FontSettings.getDefaultInstance().getFontsSources();

Assert.assertTrue(IterableUtils.matchesAny(updatedFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arial")));
Assert.assertTrue(IterableUtils.matchesAny(updatedFontSources[1].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));
Assert.assertTrue(IterableUtils.matchesAny(updatedFontSources[1].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Junction Light")));

doc.save(getArtifactsDir() + "FontSettings.AddFontSource.pdf");

// Restore the original font sources.
FontSettings.getDefaultInstance().setFontsSources(originalFontSources);</pre></example>
</DL>
<HR>

<A NAME="resetFontSources()"><!-- --></A><A NAME="resetFontSources--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>resetFontSources</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>resetFontSources</B>()</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Resets the fonts sources to the system default.
            </summary><example><p><b>Example:</b></p>Shows how to access a document's system font source and set font substitutes.<pre>
Document doc = new Document();
doc.setFontSettings(new FontSettings());

// By default, a blank document always contains a system font source.
Assert.assertEquals(1, doc.getFontSettings().getFontsSources().length);

SystemFontSource systemFontSource = (SystemFontSource) doc.getFontSettings().getFontsSources()[0];
Assert.assertEquals(FontSourceType.SYSTEM_FONTS, systemFontSource.getType());
Assert.assertEquals(0, systemFontSource.getPriority());

if (SystemUtils.IS_OS_WINDOWS) {
    final String FONTS_PATH = "C:\\WINDOWS\\Fonts";
    Assert.assertEquals(FONTS_PATH.toLowerCase(), SystemFontSource.getSystemFontFolders()[0].toLowerCase());
}

for (String systemFontFolder : SystemFontSource.getSystemFontFolders()) {
    System.out.println(systemFontFolder);
}

// Set a font that exists in the Windows Fonts directory as a substitute for one that does not.
doc.getFontSettings().getSubstitutionSettings().getFontInfoSubstitution().setEnabled(true);
doc.getFontSettings().getSubstitutionSettings().getTableSubstitution().addSubstitutes("Kreon-Regular", "Calibri");

Assert.assertEquals(1, IterableUtils.size(doc.getFontSettings().getSubstitutionSettings().getTableSubstitution().getSubstitutes("Kreon-Regular")));
Assert.assertTrue(IterableUtils.toString(doc.getFontSettings().getSubstitutionSettings().getTableSubstitution().getSubstitutes("Kreon-Regular")).contains("Calibri"));

// Alternatively, we could add a folder font source in which the corresponding folder contains the font.
FolderFontSource folderFontSource = new FolderFontSource(getFontsDir(), false);
doc.getFontSettings().setFontsSources(new FontSourceBase[]{systemFontSource, folderFontSource});
Assert.assertEquals(2, doc.getFontSettings().getFontsSources().length);

// Resetting the font sources still leaves us with the system font source as well as our substitutes.
doc.getFontSettings().resetFontSources();

Assert.assertEquals(1, doc.getFontSettings().getFontsSources().length);
Assert.assertEquals(FontSourceType.SYSTEM_FONTS, doc.getFontSettings().getFontsSources()[0].getType());
Assert.assertEquals(1, IterableUtils.size(doc.getFontSettings().getSubstitutionSettings().getTableSubstitution().getSubstitutes("Kreon-Regular")));
Assert.assertTrue(doc.getFontSettings().getSubstitutionSettings().getFontNameSubstitution().getEnabled());</pre></example>
</DL>
<HR>

<A NAME="saveSearchCache(java.io.OutputStream)"><!-- --></A><A NAME="saveSearchCache-java.io.OutputStream-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>saveSearchCache</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>saveSearchCache</B>(java.io.OutputStream&nbsp;outputStream)
                    throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Saves the font search cache to the stream.
            </summary><remarks>
            See <cref><B>setFontsSources</B></cref> method description for more info.
            </remarks><DL><DT><B>Parameters:</B></DT><DD param="outputStream"><CODE>outputStream</CODE> - Output stream.</DD></DL><example><p><b>Example:</b></p>Shows how to speed up the font cache initialization process.<pre>
public void loadFontSearchCache() throws Exception
{
    final String CACHE_KEY_1 = "Arvo";
    final String CACHE_KEY_2 = "Arvo-Bold";
    FontSettings parsedFonts = new FontSettings();
    FontSettings loadedCache = new FontSettings();

    parsedFonts.setFontsSources(new FontSourceBase[]
            {
                    new FileFontSource(getFontsDir() + "Arvo-Regular.ttf", 0, CACHE_KEY_1),
                    new FileFontSource(getFontsDir() + "Arvo-Bold.ttf", 0, CACHE_KEY_2)
            });

    try (ByteArrayOutputStream cacheStream = new ByteArrayOutputStream())
    {
        parsedFonts.saveSearchCache(cacheStream);
        ByteArrayInputStream inputStream = new ByteArrayInputStream(cacheStream.toByteArray());
        loadedCache.setFontsSources(new FontSourceBase[]
                {
                        new SearchCacheStream(CACHE_KEY_1),
                        new MemoryFontSource(Files.readAllBytes(Paths.get(getFontsDir() + "Arvo-Bold.ttf")), 0, CACHE_KEY_2)
                }, inputStream);
    }

    Assert.assertEquals(parsedFonts.getFontsSources().length, loadedCache.getFontsSources().length);
}

/// &lt;summary&gt;
/// Load the font data only when required instead of storing it in the memory
/// for the entire lifetime of the "FontSettings" object.
/// &lt;/summary&gt;
private static class SearchCacheStream extends StreamFontSource
{
    public SearchCacheStream(String cacheKey)
    {
        super(0, cacheKey);

    }

    public FileInputStream openFontDataStream() throws Exception
    {
        return new FileInputStream(getFontsDir() + "Arvo-Regular.ttf");
    }
}</pre></example>
</DL>
<HR>

<A NAME="setFontsFolder(java.lang.String,boolean)"><!-- --></A><A NAME="setFontsFolder-java.lang.String-boolean-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>setFontsFolder</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>setFontsFolder</B>(java.lang.String&nbsp;fontFolder, boolean&nbsp;recursive)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Sets the folder where Aspose.Words looks for TrueType fonts when rendering documents or embedding fonts.
            This is a shortcut to <cref><A HREF="#setFontsFolders(java.lang.String[],boolean)" title="method in class com.aspose.words.FontSettings">setFontsFolders(java.lang.String[],boolean)</A></cref> for setting only one font directory.
            </summary><DL><DT><B>Parameters:</B></DT><DD param="fontFolder"><CODE>fontFolder</CODE> - The folder that contains TrueType fonts.</DD><DD param="recursive"><CODE>recursive</CODE> - True to scan the specified folders for fonts recursively.</DD></DL><example><p><b>Example:</b></p>Shows how to set a font source directory.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.getFont().setName("Arvo");
builder.writeln("Hello world!");
builder.getFont().setName("Amethysta");
builder.writeln("The quick brown fox jumps over the lazy dog.");

// Our font sources do not contain the font that we have used for text in this document.
// If we use these font settings while rendering this document,
// Aspose.Words will apply a fallback font to text which has a font that Aspose.Words cannot locate.
FontSourceBase[] originalFontSources = FontSettings.getDefaultInstance().getFontsSources();

Assert.assertEquals(1, originalFontSources.length);
Assert.assertTrue(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arial")));

// The default font sources are missing the two fonts that we are using in this document.
Assert.assertFalse(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arvo")));
Assert.assertFalse(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));

// Use the "SetFontsFolder" method to set a directory which will act as a new font source.
// Pass "false" as the "recursive" argument to include fonts from all the font files that are in the directory
// that we are passing in the first argument, but not include any fonts in any of that directory's subfolders.
// Pass "true" as the "recursive" argument to include all font files in the directory that we are passing
// in the first argument, as well as all the fonts in its subdirectories.
FontSettings.getDefaultInstance().setFontsFolder(getFontsDir(), recursive);

FontSourceBase[] newFontSources = FontSettings.getDefaultInstance().getFontsSources();

Assert.assertEquals(1, newFontSources.length);
Assert.assertFalse(IterableUtils.matchesAny(newFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arial")));
Assert.assertTrue(IterableUtils.matchesAny(newFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arvo")));

// The "Amethysta" font is in a subfolder of the font directory.
if (recursive) {
    Assert.assertEquals(25, newFontSources[0].getAvailableFonts().size());
    Assert.assertTrue(IterableUtils.matchesAny(newFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));
} else {
    Assert.assertEquals(18, newFontSources[0].getAvailableFonts().size());
    Assert.assertFalse(IterableUtils.matchesAny(newFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));
}

doc.save(getArtifactsDir() + "FontSettings.SetFontsFolder.pdf");

// Restore the original font sources.
FontSettings.getDefaultInstance().setFontsSources(originalFontSources);</pre></example>
</DL>
<HR>

<A NAME="setFontsFolders(java.lang.String[],boolean)"><!-- --></A><A NAME="setFontsFolders-java.lang.String:A-boolean-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>setFontsFolders</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>setFontsFolders</B>(java.lang.String[]&nbsp;fontsFolders, boolean&nbsp;recursive)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Sets the folders where Aspose.Words looks for TrueType fonts when rendering documents or embedding fonts.
            </summary><remarks><p>By default, Aspose.Words looks for fonts installed to the system.</p><p>Setting this property resets the cache of all previously loaded fonts.</p></remarks><DL><DT><B>Parameters:</B></DT><DD param="fontsFolders"><CODE>fontsFolders</CODE> - An array of folders that contain TrueType fonts.</DD><DD param="recursive"><CODE>recursive</CODE> - True to scan the specified folders for fonts recursively.</DD></DL><example><p><b>Example:</b></p>Shows how to set multiple font source directories.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.getFont().setName("Amethysta");
builder.writeln("The quick brown fox jumps over the lazy dog.");
builder.getFont().setName("Junction Light");
builder.writeln("The quick brown fox jumps over the lazy dog.");

// Our font sources do not contain the font that we have used for text in this document.
// If we use these font settings while rendering this document,
// Aspose.Words will apply a fallback font to text which has a font that Aspose.Words cannot locate.
FontSourceBase[] originalFontSources = FontSettings.getDefaultInstance().getFontsSources();

Assert.assertEquals(1, originalFontSources.length);
Assert.assertTrue(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arial")));

// The default font sources are missing the two fonts that we are using in this document.
Assert.assertFalse(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));
Assert.assertFalse(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Junction Light")));

// Use the "SetFontsFolders" method to create a font source from each font directory that we pass as the first argument.
// Pass "false" as the "recursive" argument to include fonts from all the font files that are in the directories
// that we are passing in the first argument, but not include any fonts from any of the directories' subfolders.
// Pass "true" as the "recursive" argument to include all font files in the directories that we are passing
// in the first argument, as well as all the fonts in their subdirectories.
FontSettings.getDefaultInstance().setFontsFolders(new String[]{getFontsDir() + "/Amethysta", getFontsDir() + "/Junction"}, recursive);

FontSourceBase[] newFontSources = FontSettings.getDefaultInstance().getFontsSources();

Assert.assertEquals(2, newFontSources.length);
Assert.assertFalse(IterableUtils.matchesAny(newFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arial")));
Assert.assertEquals(1, newFontSources[0].getAvailableFonts().size());
Assert.assertTrue(IterableUtils.matchesAny(newFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));

// The "Junction" folder itself contains no font files, but has subfolders that do.
if (recursive) {
    Assert.assertEquals(6, newFontSources[1].getAvailableFonts().size());
    Assert.assertTrue(IterableUtils.matchesAny(newFontSources[1].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Junction Light")));
} else {
    Assert.assertEquals(0, newFontSources[1].getAvailableFonts().size());
}

doc.save(getArtifactsDir() + "FontSettings.SetFontsFolders.pdf");

// Restore the original font sources.
FontSettings.getDefaultInstance().setFontsSources(originalFontSources);</pre></example>
</DL>
<HR>

<A NAME="setFontsSources(com.aspose.words.FontSourceBase[])"><!-- --></A><A NAME="setFontsSources-com.aspose.words.FontSourceBase:A-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>setFontsSources</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>setFontsSources</B>(<A HREF="FontSourceBase.html" title="class in com.aspose.words">FontSourceBase</A>[]&nbsp;sources)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Sets the sources where Aspose.Words looks for TrueType fonts when rendering documents or embedding fonts.
            </summary><remarks><p>By default, Aspose.Words looks for fonts installed to the system.</p><p>Setting this property resets the cache of all previously loaded fonts.</p></remarks><DL><DT><B>Parameters:</B></DT><DD param="sources"><CODE>sources</CODE> - An array of sources that contain TrueType fonts.</DD></DL><example><p><b>Example:</b></p>Shows how to add a font source to our existing font sources.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.getFont().setName("Arial");
builder.writeln("Hello world!");
builder.getFont().setName("Amethysta");
builder.writeln("The quick brown fox jumps over the lazy dog.");
builder.getFont().setName("Junction Light");
builder.writeln("The quick brown fox jumps over the lazy dog.");

FontSourceBase[] originalFontSources = FontSettings.getDefaultInstance().getFontsSources();

Assert.assertEquals(1, originalFontSources.length);

Assert.assertTrue(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arial")));

// The default font source is missing two of the fonts that we are using in our document.
// When we save this document, Aspose.Words will apply fallback fonts to all text formatted with inaccessible fonts.
Assert.assertFalse(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));
Assert.assertFalse(IterableUtils.matchesAny(originalFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Junction Light")));

// Create a font source from a folder that contains fonts.
FolderFontSource folderFontSource = new FolderFontSource(getFontsDir(), true);

// Apply a new array of font sources that contains the original font sources, as well as our custom fonts.
FontSourceBase[] updatedFontSources = {originalFontSources[0], folderFontSource};
FontSettings.getDefaultInstance().setFontsSources(updatedFontSources);

// Verify that Aspose.Words has access to all required fonts before we render the document to PDF.
updatedFontSources = FontSettings.getDefaultInstance().getFontsSources();

Assert.assertTrue(IterableUtils.matchesAny(updatedFontSources[0].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Arial")));
Assert.assertTrue(IterableUtils.matchesAny(updatedFontSources[1].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Amethysta")));
Assert.assertTrue(IterableUtils.matchesAny(updatedFontSources[1].getAvailableFonts(), f -&gt; f.getFullFontName().contains("Junction Light")));

doc.save(getArtifactsDir() + "FontSettings.AddFontSource.pdf");

// Restore the original font sources.
FontSettings.getDefaultInstance().setFontsSources(originalFontSources);</pre></example>
</DL>
<HR>

<A NAME="setFontsSources(com.aspose.words.FontSourceBase[],java.io.InputStream)"><!-- --></A><A NAME="setFontsSources-com.aspose.words.FontSourceBase:A-java.io.InputStream-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>setFontsSources</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>setFontsSources</B>(com.aspose.words.FontSourceBase[]&nbsp;sources, java.io.InputStream&nbsp;cacheInputStream)
                    throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Sets the sources where Aspose.Words looks for TrueType fonts and additionally loads previously saved
             font search cache.
             </summary><remarks><p>Loading previously saved font search cache will speed up the font cache initialization process. It is
             especially useful when access to font sources is complicated (e.g. when fonts are loaded via network).</p><p>When saving and loading font search cache, fonts in the provided sources are identified via cache key.
             For the fonts in the <cref><A HREF="SystemFontSource.html" title="class in com.aspose.words">SystemFontSource</A></cref> and <cref><A HREF="FolderFontSource.html" title="class in com.aspose.words">FolderFontSource</A></cref> cache key is the path
             to the font file. For <cref><A HREF="MemoryFontSource.html" title="class in com.aspose.words">MemoryFontSource</A></cref> and <cref><A HREF="StreamFontSource.html" title="class in com.aspose.words">StreamFontSource</A></cref> cache key is defined
             in the <cref><A HREF="MemoryFontSource.html#CacheKey" title="property in class com.aspose.words.MemoryFontSource">MemoryFontSource.CacheKey</A></cref> and <cref><A HREF="StreamFontSource.html#CacheKey" title="property in class com.aspose.words.StreamFontSource">StreamFontSource.CacheKey</A></cref> properties
             respectively. For the <cref><A HREF="FileFontSource.html" title="class in com.aspose.words">FileFontSource</A></cref> cache key is either <cref><A HREF="FileFontSource.html#CacheKey" title="property in class com.aspose.words.FileFontSource">FileFontSource.CacheKey</A></cref>
             property or a file path if the <cref><A HREF="FileFontSource.html#CacheKey" title="property in class com.aspose.words.FileFontSource">FileFontSource.CacheKey</A></cref> is <code>null</code>.</p><p>It is highly recommended to provide the same font sources when loading cache as at the time the cache was saved.
             Any changes in the font sources (e.g. adding new fonts, moving font files or changing the cache key) may lead to the
             inaccurate font resolving by Aspose.Words.</p></remarks>FontSettings
             <DL><DT><B>Parameters:</B></DT><DD param="sources"><CODE>sources</CODE> - An array of sources that contain TrueType fonts.</DD><DD param="cacheInputStream"><CODE>cacheInputStream</CODE> - Input stream with saved font search cache.</DD></DL><example><p><b>Example:</b></p>Shows how to speed up the font cache initialization process.<pre>
public void loadFontSearchCache() throws Exception
{
    final String CACHE_KEY_1 = "Arvo";
    final String CACHE_KEY_2 = "Arvo-Bold";
    FontSettings parsedFonts = new FontSettings();
    FontSettings loadedCache = new FontSettings();

    parsedFonts.setFontsSources(new FontSourceBase[]
            {
                    new FileFontSource(getFontsDir() + "Arvo-Regular.ttf", 0, CACHE_KEY_1),
                    new FileFontSource(getFontsDir() + "Arvo-Bold.ttf", 0, CACHE_KEY_2)
            });

    try (ByteArrayOutputStream cacheStream = new ByteArrayOutputStream())
    {
        parsedFonts.saveSearchCache(cacheStream);
        ByteArrayInputStream inputStream = new ByteArrayInputStream(cacheStream.toByteArray());
        loadedCache.setFontsSources(new FontSourceBase[]
                {
                        new SearchCacheStream(CACHE_KEY_1),
                        new MemoryFontSource(Files.readAllBytes(Paths.get(getFontsDir() + "Arvo-Bold.ttf")), 0, CACHE_KEY_2)
                }, inputStream);
    }

    Assert.assertEquals(parsedFonts.getFontsSources().length, loadedCache.getFontsSources().length);
}

/// &lt;summary&gt;
/// Load the font data only when required instead of storing it in the memory
/// for the entire lifetime of the "FontSettings" object.
/// &lt;/summary&gt;
private static class SearchCacheStream extends StreamFontSource
{
    public SearchCacheStream(String cacheKey)
    {
        super(0, cacheKey);

    }

    public FileInputStream openFontDataStream() throws Exception
    {
        return new FileInputStream(getFontsDir() + "Arvo-Regular.ttf");
    }
}</pre></example>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>