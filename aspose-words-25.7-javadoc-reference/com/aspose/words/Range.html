<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 19 Jul 2025 -->
<TITLE>Range</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Class Range</H2>
<PRE>
java.lang.Object
    <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>com.aspose.words.Range</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD>java.lang.Iterable</DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>Range </B><DT>extends java.lang.Object</DL>
</PRE>

<P>

<summary>
             Represents a contiguous area in a document.
             <p>To learn more, visit the <a href="https://docs.aspose.com/words/net/working-with-ranges/">Working with Ranges</a> documentation article.</p></summary><remarks><p>The document is represented by a tree of nodes and the nodes provide operations
             to work with the tree, but some operations are easier to perform if the document
             is treated as a contiguous sequence of text.</p><p><cref><i>Range</i></cref> is a "facade" interface that provide methods that treat the document
             or portions of the document as "flat" text regardless of the fact that the document
             nodes are stored in a tree-like object model.</p><p><cref><i>Range</i></cref> does not contain any text or nodes, it is merely a view or "window"
             over a fragment of a document.</p></remarks><example><p><b>Example:</b></p>Shows how to get the text contents of all the nodes that a range covers.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.write("Hello world!");

Assert.assertEquals("Hello world!", doc.getRange().getText().trim());</pre></example>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ========== PROPERTY SUMMARY =========== -->

<A NAME="property_summary"><!-- --></A>
<TABLE RULES="GROUPS" BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Property Getters/Setters Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="BookmarkCollection.html" title="class in com.aspose.words">BookmarkCollection</A></CODE></TD><TD><CODE><B><A HREF="#Bookmarks">getBookmarks</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns a <cref><i>Bookmarks</i></cref> collection that represents all bookmarks in the range.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="FieldCollection.html" title="class in com.aspose.words">FieldCollection</A></CODE></TD><TD><CODE><B><A HREF="#Fields">getFields</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns a <cref><i>Fields</i></cref> collection that represents all fields in the range.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="FormFieldCollection.html" title="class in com.aspose.words">FormFieldCollection</A></CODE></TD><TD><CODE><B><A HREF="#FormFields">getFormFields</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns a <cref><i>FormFields</i></cref> collection that represents all form fields in the range.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="RevisionCollection.html" title="class in com.aspose.words">RevisionCollection</A></CODE></TD><TD><CODE><B><A HREF="#Revisions">getRevisions</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets a collection of revisions (tracked changes) that exist in this range.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE><A HREF="StructuredDocumentTagCollection.html" title="class in com.aspose.words">StructuredDocumentTagCollection</A></CODE></TD><TD><CODE><B><A HREF="#StructuredDocumentTags">getStructuredDocumentTags</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Returns a <cref><i>StructuredDocumentTags</i></cref> collection that represents all structured document tags in the range.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><CODE>java.lang.String</CODE></TD><TD><CODE><B><A HREF="#Text">getText</A></B>()</CODE></TD><TD ALIGN="right" ></TD></TR><TR><TD></TD><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Gets the text of the range.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" RULES="GROUPS" FRAME="BOX" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#delete()">delete</A></B>()</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Deletes all characters of the range.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>java.util.Iterator&lt;<A HREF="Node.html" title="class in com.aspose.words">Node</A>&gt;</CODE></TD><TD><CODE><B><A HREF="#iterator()">iterator</A></B>()</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#normalizeFieldTypes()">normalizeFieldTypes</A></B>()</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Changes field type values <cref><A HREF="FieldChar.html#FieldType" title="property in class com.aspose.words.FieldChar">FieldChar.FieldType</A></cref> of <cref><A HREF="FieldStart.html" title="class in com.aspose.words">FieldStart</A></cref>, <cref><A HREF="FieldSeparator.html" title="class in com.aspose.words">FieldSeparator</A></cref>, <cref><A HREF="FieldEnd.html" title="class in com.aspose.words">FieldEnd</A></cref>
            in this range so that they correspond to the field types contained in the field codes.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>int</CODE></TD><TD><CODE><B><A HREF="#replace(java.lang.String,java.lang.String)">replace</A></B>(java.lang.String&nbsp;pattern, java.lang.String&nbsp;replacement)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Replaces all occurrences of a specified character string pattern with a replacement string.
             </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>int</CODE></TD><TD><CODE><B><A HREF="#replace(java.lang.String,java.lang.String,com.aspose.words.FindReplaceOptions)">replace</A></B>(java.lang.String&nbsp;pattern, java.lang.String&nbsp;replacement, <A HREF="FindReplaceOptions.html" title="class in com.aspose.words">FindReplaceOptions</A>&nbsp;options)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Replaces all occurrences of a specified character string pattern with a replacement string.
             </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>int</CODE></TD><TD><CODE><B><A HREF="#replace(java.util.regex.Pattern,java.lang.String)">replace</A></B>(java.util.regex.Pattern&nbsp;pattern, java.lang.String&nbsp;replacement)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Replaces all occurrences of a character pattern specified by a regular expression with another string.
             </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>int</CODE></TD><TD><CODE><B><A HREF="#replace(java.util.regex.Pattern,java.lang.String,com.aspose.words.FindReplaceOptions)">replace</A></B>(java.util.regex.Pattern&nbsp;pattern, java.lang.String&nbsp;replacement, <A HREF="FindReplaceOptions.html" title="class in com.aspose.words">FindReplaceOptions</A>&nbsp;options)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Replaces all occurrences of a character pattern specified by a regular expression with another string.
             </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE><A HREF="Document.html" title="class in com.aspose.words">Document</A></CODE></TD><TD><CODE><B><A HREF="#toDocument()">toDocument</A></B>()</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Constructs a new fully formed document that contains the range.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#unlinkFields()">unlinkFields</A></B>()</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Unlinks fields in this range.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>void</CODE></TD><TD><CODE><B><A HREF="#updateFields()">updateFields</A></B>()</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Updates the values of document fields in this range.
             </TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ============ PROPERTY DETAIL ========== -->

<A NAME="property_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Property Getters/Setters Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="Bookmarks"><!-- --></A><A NAME="getBookmarks()"><!-- --></A><A NAME="getBookmarks--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getBookmarks</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="BookmarkCollection.html" title="class in com.aspose.words">BookmarkCollection</A>&nbsp;<B>getBookmarks</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns a <cref><i>Bookmarks</i></cref> collection that represents all bookmarks in the range.
            </summary><example><p><b>Example:</b></p>Shows how to add bookmarks and update their contents.<pre>
public void createUpdateAndPrintBookmarks() throws Exception {
    // Create a document with three bookmarks, then use a custom document visitor implementation to print their contents.
    Document doc = createDocumentWithBookmarks(3);
    BookmarkCollection bookmarks = doc.getRange().getBookmarks();
    printAllBookmarkInfo(bookmarks);

    // Bookmarks can be accessed in the bookmark collection by index or name, and their names can be updated.
    bookmarks.get(0).setName("{bookmarks[0].Name}_NewName");
    bookmarks.get("MyBookmark_2").setText("Updated text contents of {bookmarks[1].Name}");

    // Print all bookmarks again to see updated values.
    printAllBookmarkInfo(bookmarks);
}

/// &lt;summary&gt;
/// Create a document with a given number of bookmarks.
/// &lt;/summary&gt;
private static Document createDocumentWithBookmarks(int numberOfBookmarks) throws Exception {
    Document doc = new Document();
    DocumentBuilder builder = new DocumentBuilder(doc);

    for (int i = 1; i &lt;= numberOfBookmarks; i++) {
        String bookmarkName = "MyBookmark_" + i;

        builder.write("Text before bookmark.");
        builder.startBookmark(bookmarkName);
        builder.write(MessageFormat.format("Text inside {0}.", bookmarkName));
        builder.endBookmark(bookmarkName);
        builder.writeln("Text after bookmark.");
    }

    return doc;
}

/// &lt;summary&gt;
/// Use an iterator and a visitor to print info of every bookmark in the collection.
/// &lt;/summary&gt;
private static void printAllBookmarkInfo(BookmarkCollection bookmarks) throws Exception {
    BookmarkInfoPrinter bookmarkVisitor = new BookmarkInfoPrinter();

    // Get each bookmark in the collection to accept a visitor that will print its contents.
    Iterator&lt;Bookmark&gt; enumerator = bookmarks.iterator();

    while (enumerator.hasNext()) {
        Bookmark currentBookmark = enumerator.next();

        if (currentBookmark != null) {
            currentBookmark.getBookmarkStart().accept(bookmarkVisitor);
            currentBookmark.getBookmarkEnd().accept(bookmarkVisitor);

            System.out.println(currentBookmark.getBookmarkStart().getText());
        }
    }
}

/// &lt;summary&gt;
/// Prints contents of every visited bookmark to the console.
/// &lt;/summary&gt;
public static class BookmarkInfoPrinter extends DocumentVisitor {
    public int visitBookmarkStart(BookmarkStart bookmarkStart) throws Exception {
        System.out.println(MessageFormat.format("BookmarkStart name: \"{0}\", Content: \"{1}\"", bookmarkStart.getName(),
                bookmarkStart.getBookmark().getText()));
        return VisitorAction.CONTINUE;
    }

    public int visitBookmarkEnd(BookmarkEnd bookmarkEnd) {
        System.out.println(MessageFormat.format("BookmarkEnd name: \"{0}\"", bookmarkEnd.getName()));
        return VisitorAction.CONTINUE;
    }
}</pre></example>
</DL>
<HR>

<A NAME="Fields"><!-- --></A><A NAME="getFields()"><!-- --></A><A NAME="getFields--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getFields</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="FieldCollection.html" title="class in com.aspose.words">FieldCollection</A>&nbsp;<B>getFields</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns a <cref><i>Fields</i></cref> collection that represents all fields in the range.
            </summary><example><p><b>Example:</b></p>Shows how customize node changing with a callback.<pre>
public void fontChangeViaCallback() throws Exception {
    Document doc = new Document();
    DocumentBuilder builder = new DocumentBuilder(doc);

    // Set the node changing callback to custom implementation,
    // then add/remove nodes to get it to generate a log.
    HandleNodeChangingFontChanger callback = new HandleNodeChangingFontChanger();
    doc.setNodeChangingCallback(callback);

    builder.writeln("Hello world!");
    builder.writeln("Hello again!");
    builder.insertField(" HYPERLINK \"https://www.google.com/\" ");
    builder.insertShape(ShapeType.RECTANGLE, 300.0, 300.0);

    doc.getRange().getFields().get(0).remove();

    System.out.println(callback.getLog());
}

/// &lt;summary&gt;
/// Logs the date and time of each node insertion and removal.
/// Sets a custom font name/size for the text contents of Run nodes.
/// &lt;/summary&gt;
public static class HandleNodeChangingFontChanger implements INodeChangingCallback {
    public void nodeInserted(NodeChangingArgs args) {
        mLog.append(MessageFormat.format("\tType:\t{0}", args.getNode().getNodeType()));
        mLog.append(MessageFormat.format("\tHash:\t{0}", args.getNode().hashCode()));

        if (args.getNode().getNodeType() == NodeType.RUN) {
            Font font = ((Run) args.getNode()).getFont();
            mLog.append(MessageFormat.format("\tFont:\tChanged from \"{0}\" {1}pt", font.getName(), font.getSize()));

            font.setSize(24.0);
            font.setName("Arial");

            mLog.append(MessageFormat.format(" to \"{0}\" {1}pt", font.getName(), font.getSize()));
            mLog.append(MessageFormat.format("\tContents:\n\t\t\"{0}\"", args.getNode().getText()));
        }
    }

    public void nodeInserting(NodeChangingArgs args) {
        mLog.append(MessageFormat.format("\n{0}\tNode insertion:", new Date()));
    }

    public void nodeRemoved(NodeChangingArgs args) {
        mLog.append(MessageFormat.format("\tType:\t{0}", args.getNode().getNodeType()));
        mLog.append(MessageFormat.format("\tHash code:\t{0}", args.getNode().hashCode()));
    }

    public void nodeRemoving(NodeChangingArgs args) {
        mLog.append(MessageFormat.format("\n{0}\tNode removal:", new Date()));
    }

    public String getLog() {
        return mLog.toString();
    }

    private final StringBuilder mLog = new StringBuilder();
}</pre></example>
</DL>
<HR>

<A NAME="FormFields"><!-- --></A><A NAME="getFormFields()"><!-- --></A><A NAME="getFormFields--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getFormFields</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="FormFieldCollection.html" title="class in com.aspose.words">FormFieldCollection</A>&nbsp;<B>getFormFields</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns a <cref><i>FormFields</i></cref> collection that represents all form fields in the range.
            </summary><example><p><b>Example:</b></p>Shows how insert different kinds of form fields into a document, and process them with using a document visitor implementation.<pre>
public void visitor() throws Exception {
    Document doc = new Document();
    DocumentBuilder builder = new DocumentBuilder(doc);

    // Use a document builder to insert a combo box.
    builder.write("Choose a value from this combo box: ");
    FormField comboBox = builder.insertComboBox("MyComboBox", new String[]{"One", "Two", "Three"}, 0);
    comboBox.setCalculateOnExit(true);
    Assert.assertEquals(3, comboBox.getDropDownItems().getCount());
    Assert.assertEquals(0, comboBox.getDropDownSelectedIndex());
    Assert.assertTrue(comboBox.getEnabled());

    builder.insertBreak(BreakType.PARAGRAPH_BREAK);

    // Use a document builder to insert a check box.
    builder.write("Click this check box to tick/untick it: ");
    FormField checkBox = builder.insertCheckBox("MyCheckBox", false, 50);
    checkBox.isCheckBoxExactSize(true);
    checkBox.setHelpText("Right click to check this box");
    checkBox.setOwnHelp(true);
    checkBox.setStatusText("Checkbox status text");
    checkBox.setOwnStatus(true);
    Assert.assertEquals(50.0d, checkBox.getCheckBoxSize());
    Assert.assertFalse(checkBox.getChecked());
    Assert.assertFalse(checkBox.getDefault());

    builder.insertBreak(BreakType.PARAGRAPH_BREAK);

    // Use a document builder to insert text input form field.
    builder.write("Enter text here: ");
    FormField textInput = builder.insertTextInput("MyTextInput", TextFormFieldType.REGULAR, "", "Placeholder text", 50);
    textInput.setEntryMacro("EntryMacro");
    textInput.setExitMacro("ExitMacro");
    textInput.setTextInputDefault("Regular");
    textInput.setTextInputFormat("FIRST CAPITAL");
    textInput.setTextInputValue("New placeholder text");
    Assert.assertEquals(TextFormFieldType.REGULAR, textInput.getTextInputType());
    Assert.assertEquals(50, textInput.getMaxLength());

    // This collection contains all our form fields.
    FormFieldCollection formFields = doc.getRange().getFormFields();
    Assert.assertEquals(3, formFields.getCount());

    // Fields display our form fields. We can see their field codes by opening this document
    // in Microsoft and pressing Alt + F9. These fields have no switches,
    // and members of the FormField object fully govern their form fields' content.
    Assert.assertEquals(3, doc.getRange().getFields().getCount());
    Assert.assertEquals(" FORMDROPDOWN \u0001", doc.getRange().getFields().get(0).getFieldCode());
    Assert.assertEquals(" FORMCHECKBOX \u0001", doc.getRange().getFields().get(1).getFieldCode());
    Assert.assertEquals(" FORMTEXT \u0001", doc.getRange().getFields().get(2).getFieldCode());

    // Allow each form field to accept a document visitor.
    FormFieldVisitor formFieldVisitor = new FormFieldVisitor();

    Iterator&lt;FormField&gt; fieldEnumerator = formFields.iterator();
    while (fieldEnumerator.hasNext())
        fieldEnumerator.next().accept(formFieldVisitor);

    System.out.println(formFieldVisitor.getText());

    doc.updateFields();
    doc.save(getArtifactsDir() + "FormFields.Visitor.html");
}

/// &lt;summary&gt;
/// Visitor implementation that prints details of form fields that it visits. 
/// &lt;/summary&gt;
public static class FormFieldVisitor extends DocumentVisitor {
    public FormFieldVisitor() {
        mBuilder = new StringBuilder();
    }

    /// &lt;summary&gt;
    /// Called when a FormField node is encountered in the document.
    /// &lt;/summary&gt;
    public /*override*/ /*VisitorAction*/int visitFormField(FormField formField) {
        appendLine(formField.getType() + ": \"" + formField.getName() + "\"");
        appendLine("\tStatus: " + (formField.getEnabled() ? "Enabled" : "Disabled"));
        appendLine("\tHelp Text:  " + formField.getHelpText());
        appendLine("\tEntry macro name: " + formField.getEntryMacro());
        appendLine("\tExit macro name: " + formField.getExitMacro());

        switch (formField.getType()) {
            case FieldType.FIELD_FORM_DROP_DOWN:
                appendLine("\tDrop down items count: " + formField.getDropDownItems().getCount() + ", default selected item index: " + formField.getDropDownSelectedIndex());
                appendLine("\tDrop down items: " + String.join(", ", formField.getDropDownItems()));
                break;
            case FieldType.FIELD_FORM_CHECK_BOX:
                appendLine("\tCheckbox size: " + formField.getCheckBoxSize());
                appendLine("\t" + "Checkbox is currently: " + (formField.getChecked() ? "checked, " : "unchecked, ") + "by default: " + (formField.getDefault() ? "checked" : "unchecked"));
                break;
            case FieldType.FIELD_FORM_TEXT_INPUT:
                appendLine("\tInput format: " + formField.getTextInputFormat());
                appendLine("\tCurrent contents: " + formField.getResult());
                break;
        }

        // Let the visitor continue visiting other nodes.
        return VisitorAction.CONTINUE;
    }

    /// &lt;summary&gt;
    /// Adds newline char-terminated text to the current output.
    /// &lt;/summary&gt;
    private void appendLine(String text) {
        mBuilder.append(text + '\n');
    }

    /// &lt;summary&gt;
    /// Gets the plain text of the document that was accumulated by the visitor.
    /// &lt;/summary&gt;
    public String getText() {
        return mBuilder.toString();
    }

    private final StringBuilder mBuilder;
}</pre></example>
</DL>
<HR>

<A NAME="Revisions"><!-- --></A><A NAME="getRevisions()"><!-- --></A><A NAME="getRevisions--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getRevisions</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="RevisionCollection.html" title="class in com.aspose.words">RevisionCollection</A>&nbsp;<B>getRevisions</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets a collection of revisions (tracked changes) that exist in this range.
            </summary><remarks><p>The returned collection is a "live" collection, which means if you remove parts of a document that contain
            revisions, the deleted revisions will automatically disappear from this collection.</p></remarks><example><p><b>Example:</b></p>Shows how to work with revisions in range.<pre>
Document doc = new Document(getMyDir() + "Revisions.docx");

Paragraph paragraph = doc.getFirstSection().getBody().getFirstParagraph();
for (Revision revision : paragraph.getRange().getRevisions())
{
    if (revision.getRevisionType() == RevisionType.DELETION)
        revision.accept();
}

// Reject the first section revisions.
doc.getFirstSection().getRange().getRevisions().rejectAll();</pre></example>
</DL>
<HR>

<A NAME="StructuredDocumentTags"><!-- --></A><A NAME="getStructuredDocumentTags()"><!-- --></A><A NAME="getStructuredDocumentTags--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getStructuredDocumentTags</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="StructuredDocumentTagCollection.html" title="class in com.aspose.words">StructuredDocumentTagCollection</A>&nbsp;<B>getStructuredDocumentTags</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Returns a <cref><i>StructuredDocumentTags</i></cref> collection that represents all structured document tags in the range.
            </summary><example><p><b>Example:</b></p>Shows how to remove structured document tag.<pre>
Document doc = new Document(getMyDir() + "Structured document tags.docx");

StructuredDocumentTagCollection structuredDocumentTags = doc.getRange().getStructuredDocumentTags();
IStructuredDocumentTag sdt;
for (int i = 0; i &lt; structuredDocumentTags.getCount(); i++)
{
    sdt = structuredDocumentTags.get(i);
    System.out.println(sdt.getTitle());
}

sdt = structuredDocumentTags.getById(1691867797);
Assert.assertEquals(1691867797, sdt.getId());

Assert.assertEquals(5, structuredDocumentTags.getCount());
// Remove the structured document tag by Id.
structuredDocumentTags.remove(1691867797);
// Remove the structured document tag at position 0.
structuredDocumentTags.removeAt(0);
Assert.assertEquals(3, structuredDocumentTags.getCount());</pre></example>
</DL>
<HR>

<A NAME="Text"><!-- --></A><A NAME="getText()"><!-- --></A><A NAME="getText--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>getText</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.lang.String&nbsp;<B>getText</B>()
</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Gets the text of the range.
            </summary><remarks><p>The returned string includes all control and special characters as described in <cref><A HREF="ControlChar.html" title="class in com.aspose.words">ControlChar</A></cref>.</p></remarks><example><p><b>Example:</b></p>Shows how to get the text contents of all the nodes that a range covers.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.write("Hello world!");

Assert.assertEquals("Hello world!", doc.getRange().getText().trim());</pre></example>
</DL>
<HR>



<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="delete()"><!-- --></A><A NAME="delete--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>delete</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>delete</B>()
           throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Deletes all characters of the range.
            </summary><example><p><b>Example:</b></p>Shows how to delete all the nodes from a range.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

// Add text to the first section in the document, and then add another section.
builder.write("Section 1. ");
builder.insertBreak(BreakType.SECTION_BREAK_CONTINUOUS);
builder.write("Section 2.");

Assert.assertEquals("Section 1. \fSection 2.", doc.getText().trim());

// Remove the first section entirely by removing all the nodes
// within its range, including the section itself.
doc.getSections().get(0).getRange().delete();

Assert.assertEquals(1, doc.getSections().getCount());
Assert.assertEquals("Section 2.", doc.getText().trim());</pre></example>
</DL>
<HR>

<A NAME="iterator()"><!-- --></A><A NAME="iterator--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>iterator</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public java.util.Iterator&lt;<A HREF="Node.html" title="class in com.aspose.words">Node</A>&gt;&nbsp;<B>iterator</B>()</PRE></TD></TR></TABLE>
<DL><DD><summary />
</DL>
<HR>

<A NAME="normalizeFieldTypes()"><!-- --></A><A NAME="normalizeFieldTypes--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>normalizeFieldTypes</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>normalizeFieldTypes</B>()
                        throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Changes field type values <cref><A HREF="FieldChar.html#FieldType" title="property in class com.aspose.words.FieldChar">FieldChar.FieldType</A></cref> of <cref><A HREF="FieldStart.html" title="class in com.aspose.words">FieldStart</A></cref>, <cref><A HREF="FieldSeparator.html" title="class in com.aspose.words">FieldSeparator</A></cref>, <cref><A HREF="FieldEnd.html" title="class in com.aspose.words">FieldEnd</A></cref>
            in this range so that they correspond to the field types contained in the field codes.
            </summary><remarks><p>Use this method after document changes that affect field types.</p><p>To change field type values in the whole document use <cref><A HREF="Document.html#normalizeFieldTypes()" title="method in class com.aspose.words.Document">Document.normalizeFieldTypes()</A></cref>.</p></remarks><example><p><b>Example:</b></p>Shows how to get the keep a field's type up to date with its field code.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

Field field = builder.insertField("DATE", null);

// Aspose.Words automatically detects field types based on field codes.
Assert.assertEquals(FieldType.FIELD_DATE, field.getType());

// Manually change the raw text of the field, which determines the field code.
Run fieldText = (Run) doc.getFirstSection().getBody().getFirstParagraph().getChildNodes(NodeType.RUN, true).get(0);
fieldText.setText("PAGE");

// Changing the field code has changed this field to one of a different type,
// but the field's type properties still display the old type.
Assert.assertEquals("PAGE", field.getFieldCode());
Assert.assertEquals(FieldType.FIELD_DATE, field.getType());
Assert.assertEquals(FieldType.FIELD_DATE, field.getStart().getFieldType());
Assert.assertEquals(FieldType.FIELD_DATE, field.getSeparator().getFieldType());
Assert.assertEquals(FieldType.FIELD_DATE, field.getEnd().getFieldType());

// Update those properties with this method to display current value.
doc.normalizeFieldTypes();

Assert.assertEquals(FieldType.FIELD_PAGE, field.getType());
Assert.assertEquals(FieldType.FIELD_PAGE, field.getStart().getFieldType());
Assert.assertEquals(FieldType.FIELD_PAGE, field.getSeparator().getFieldType());
Assert.assertEquals(FieldType.FIELD_PAGE, field.getEnd().getFieldType());</pre></example>
</DL>
<HR>

<A NAME="replace(java.lang.String,java.lang.String)"><!-- --></A><A NAME="replace-java.lang.String-java.lang.String-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>replace</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public int&nbsp;<B>replace</B>(java.lang.String&nbsp;pattern, java.lang.String&nbsp;replacement)
           throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Replaces all occurrences of a specified character string pattern with a replacement string.
             </summary><remarks><p>The pattern will not be used as regular expression.
             Please use <cref><A HREF="#replace(java.util.regex.Pattern,java.lang.String)" title="method in class com.aspose.words.Range">replace(java.util.regex.Pattern,java.lang.String)</A></cref> if you need regular expressions.</p><p>Used case-insensitive comparison.</p><p>Method is able to process breaks in both pattern and replacement strings.</p>
             You should use special meta-characters if you need to work with breaks:
             <ul><li><b>&amp;p</b> - paragraph break</li><li><b>&amp;b</b> - section break</li><li><b>&amp;m</b> - page break</li><li><b>&amp;l</b> - manual line break</li></ul>
             Use method <cref><A HREF="#replace(java.lang.String,java.lang.String,com.aspose.words.FindReplaceOptions)" title="method in class com.aspose.words.Range">replace(java.lang.String,java.lang.String,com.aspose.words.FindReplaceOptions)</A></cref> to have more flexible customization.
             </remarks><DL><DT><B>Parameters:</B></DT><DD param="pattern"><CODE>pattern</CODE> - A string to be replaced.</DD><DD param="replacement"><CODE>replacement</CODE> - A string to replace all occurrences of pattern.</DD></DL><DL><DT><B>Returns:</B></DT><DD returns="">The number of replacements made.</DD></DL><example><p><b>Example:</b></p>Shows how to add formatting to paragraphs in which a find-and-replace operation has found matches.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.writeln("Every paragraph that ends with a full stop like this one will be right aligned.");
builder.writeln("This one will not!");
builder.write("This one also will.");

ParagraphCollection paragraphs = doc.getFirstSection().getBody().getParagraphs();

Assert.assertEquals(ParagraphAlignment.LEFT, paragraphs.get(0).getParagraphFormat().getAlignment());
Assert.assertEquals(ParagraphAlignment.LEFT, paragraphs.get(1).getParagraphFormat().getAlignment());
Assert.assertEquals(ParagraphAlignment.LEFT, paragraphs.get(2).getParagraphFormat().getAlignment());

// We can use a "FindReplaceOptions" object to modify the find-and-replace process.
FindReplaceOptions options = new FindReplaceOptions();

// Set the "Alignment" property to "ParagraphAlignment.Right" to right-align every paragraph
// that contains a match that the find-and-replace operation finds.
options.getApplyParagraphFormat().setAlignment(ParagraphAlignment.RIGHT);

// Replace every full stop that is right before a paragraph break with an exclamation point.
int count = doc.getRange().replace(".&amp;p", "!&amp;p", options);

Assert.assertEquals(2, count);
Assert.assertEquals(ParagraphAlignment.RIGHT, paragraphs.get(0).getParagraphFormat().getAlignment());
Assert.assertEquals(ParagraphAlignment.LEFT, paragraphs.get(1).getParagraphFormat().getAlignment());
Assert.assertEquals(ParagraphAlignment.RIGHT, paragraphs.get(2).getParagraphFormat().getAlignment());
Assert.assertEquals("Every paragraph that ends with a full stop like this one will be right aligned!\r" +
        "This one will not!\r" +
        "This one also will!", doc.getText().trim());</pre></example><example><p><b>Example:</b></p>Shows how to perform a find-and-replace text operation on the contents of a document.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.writeln("Greetings, _FullName_!");

// Perform a find-and-replace operation on our document's contents and verify the number of replacements that took place.
int replacementCount = doc.getRange().replace("_FullName_", "John Doe");

Assert.assertEquals(1, replacementCount);
Assert.assertEquals("Greetings, John Doe!", doc.getText().trim());</pre></example><example><p><b>Example:</b></p><pre>
             Document doc = new Document();
             DocumentBuilder builder = new DocumentBuilder(doc);
             builder.Writeln("Numbers 1, 2, 3");
            
             // Inserts paragraph break after Numbers.
             doc.Range.Replace("Numbers", "Numbers&amp;p", new FindReplaceOptions());
             </pre></example>
</DL>
<HR>

<A NAME="replace(java.lang.String,java.lang.String,com.aspose.words.FindReplaceOptions)"><!-- --></A><A NAME="replace-java.lang.String-java.lang.String-com.aspose.words.FindReplaceOptions-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>replace</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public int&nbsp;<B>replace</B>(java.lang.String&nbsp;pattern, java.lang.String&nbsp;replacement, <A HREF="FindReplaceOptions.html" title="class in com.aspose.words">FindReplaceOptions</A>&nbsp;options)
           throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Replaces all occurrences of a specified character string pattern with a replacement string.
             </summary><remarks><p>The pattern will not be used as regular expression.
             Please use <cref><A HREF="#replace(java.util.regex.Pattern,java.lang.String,com.aspose.words.FindReplaceOptions)" title="method in class com.aspose.words.Range">replace(java.util.regex.Pattern,java.lang.String,com.aspose.words.FindReplaceOptions)</A></cref> if you need regular expressions.</p><p>Method is able to process breaks in both pattern and replacement strings.</p>
             You should use special meta-characters if you need to work with breaks:
             <ul><li><b>&amp;p</b> - paragraph break</li><li><b>&amp;b</b> - section break</li><li><b>&amp;m</b> - page break</li><li><b>&amp;l</b> - manual line break</li><li><b>&amp;&amp;</b> - &amp; character</li></ul></remarks><DL><DT><B>Parameters:</B></DT><DD param="pattern"><CODE>pattern</CODE> - A string to be replaced.</DD><DD param="replacement"><CODE>replacement</CODE> - A string to replace all occurrences of pattern.</DD><DD param="options"><CODE>options</CODE> - <cref><A HREF="FindReplaceOptions.html" title="class in com.aspose.words">FindReplaceOptions</A></cref> object to specify additional options.</DD></DL><DL><DT><B>Returns:</B></DT><DD returns="">The number of replacements made.</DD></DL><example><p><b>Example:</b></p>Shows how to replace all instances of String of text in a table and cell.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

Table table = builder.startTable();
builder.insertCell();
builder.write("Carrots");
builder.insertCell();
builder.write("50");
builder.endRow();
builder.insertCell();
builder.write("Potatoes");
builder.insertCell();
builder.write("50");
builder.endTable();

FindReplaceOptions options = new FindReplaceOptions();
options.setMatchCase(true);
options.setFindWholeWordsOnly(true);

// Perform a find-and-replace operation on an entire table.
table.getRange().replace("Carrots", "Eggs", options);

// Perform a find-and-replace operation on the last cell of the last row of the table.
table.getLastRow().getLastCell().getRange().replace("50", "20", options);

Assert.assertEquals("Eggs\u000750\u0007\u0007" +
                "Potatoes\u000720", table.getText().trim());</pre></example><example><p><b>Example:</b></p>Shows how to toggle standalone word-only find-and-replace operations.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.writeln("Jackson will meet you in Jacksonville.");

// We can use a "FindReplaceOptions" object to modify the find-and-replace process.
FindReplaceOptions options = new FindReplaceOptions();

// Set the "FindWholeWordsOnly" flag to "true" to replace the found text if it is not a part of another word.
// Set the "FindWholeWordsOnly" flag to "false" to replace all text regardless of its surroundings.
options.setFindWholeWordsOnly(findWholeWordsOnly);

doc.getRange().replace("Jackson", "Louis", options);

Assert.assertEquals(
        findWholeWordsOnly ? "Louis will meet you in Jacksonville." : "Louis will meet you in Louisville.",
        doc.getText().trim());</pre></example><example><p><b>Example:</b></p>Shows how to toggle case sensitivity when performing a find-and-replace operation.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.writeln("Ruby bought a ruby necklace.");

// We can use a "FindReplaceOptions" object to modify the find-and-replace process.
FindReplaceOptions options = new FindReplaceOptions();

// Set the "MatchCase" flag to "true" to apply case sensitivity while finding strings to replace.
// Set the "MatchCase" flag to "false" to ignore character case while searching for text to replace.
options.setMatchCase(matchCase);

doc.getRange().replace("Ruby", "Jade", options);

Assert.assertEquals(matchCase ? "Jade bought a ruby necklace." : "Jade bought a Jade necklace.",
        doc.getText().trim());</pre></example><example><p><b>Example:</b></p>Shows how to replace text in a document's footer.<pre>
Document doc = new Document(getMyDir() + "Footer.docx");

HeaderFooterCollection headersFooters = doc.getFirstSection().getHeadersFooters();
HeaderFooter footer = headersFooters.getByHeaderFooterType(HeaderFooterType.FOOTER_PRIMARY);

FindReplaceOptions options = new FindReplaceOptions();
options.setMatchCase(false);
options.setFindWholeWordsOnly(false);

int currentYear = Calendar.YEAR;
footer.getRange().replace("(C) 2006 Aspose Pty Ltd.", MessageFormat.format("Copyright (C) {0} by Aspose Pty Ltd.", currentYear), options);

doc.save(getArtifactsDir() + "HeaderFooter.ReplaceText.docx");</pre></example><example><p><b>Example:</b></p><pre>
             Document doc = new Document();
             DocumentBuilder builder = new DocumentBuilder(doc);
             builder.Writeln("Numbers 1, 2, 3");
            
             // Inserts paragraph break after Numbers.
             doc.Range.Replace("Numbers", "Numbers&amp;p", new FindReplaceOptions());
             </pre></example>
</DL>
<HR>

<A NAME="replace(java.util.regex.Pattern,java.lang.String)"><!-- --></A><A NAME="replace-java.util.regex.Pattern-java.lang.String-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>replace</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public int&nbsp;<B>replace</B>(java.util.regex.Pattern&nbsp;pattern, java.lang.String&nbsp;replacement)
           throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Replaces all occurrences of a character pattern specified by a regular expression with another string.
             </summary><remarks><p>Replaces the whole match captured by the regular expression.</p><p>Method is able to process breaks in both pattern and replacement strings.</p>
             You should use special meta-characters if you need to work with breaks:
             <ul><li><b>&amp;p</b> - paragraph break</li><li><b>&amp;b</b> - section break</li><li><b>&amp;m</b> - page break</li><li><b>&amp;l</b> - manual line break</li></ul>
             Use method <cref><A HREF="#replace(java.util.regex.Pattern,java.lang.String,com.aspose.words.FindReplaceOptions)" title="method in class com.aspose.words.Range">replace(java.util.regex.Pattern,java.lang.String,com.aspose.words.FindReplaceOptions)</A></cref> to have more flexible customization.
             </remarks><DL><DT><B>Parameters:</B></DT><DD param="pattern"><CODE>pattern</CODE> - A regular expression pattern used to find matches.</DD><DD param="replacement"><CODE>replacement</CODE> - A string to replace all occurrences of pattern.</DD></DL><DL><DT><B>Returns:</B></DT><DD returns="">The number of replacements made.</DD></DL><example><p><b>Example:</b></p>Shows how to replace all occurrences of a regular expression pattern with other text.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.writeln("I decided to get the curtains in gray, ideal for the grey-accented room.");

doc.getRange().replace(Pattern.compile("gr(a|e)y"), "lavender");

Assert.assertEquals("I decided to get the curtains in lavender, ideal for the lavender-accented room.", doc.getText().trim());</pre></example><example><p><b>Example:</b></p><pre>
             Document doc = new Document();
             DocumentBuilder builder = new DocumentBuilder(doc);
             builder.Writeln("a1, b2, c3");
            
             // Replaces each number with paragraph break.
             doc.Range.Replace(new Regex(@"\d+"), "&amp;p");
             </pre></example>
</DL>
<HR>

<A NAME="replace(java.util.regex.Pattern,java.lang.String,com.aspose.words.FindReplaceOptions)"><!-- --></A><A NAME="replace-java.util.regex.Pattern-java.lang.String-com.aspose.words.FindReplaceOptions-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>replace</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public int&nbsp;<B>replace</B>(java.util.regex.Pattern&nbsp;pattern, java.lang.String&nbsp;replacement, <A HREF="FindReplaceOptions.html" title="class in com.aspose.words">FindReplaceOptions</A>&nbsp;options)
           throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Replaces all occurrences of a character pattern specified by a regular expression with another string.
             </summary><remarks><p>Replaces the whole match captured by the regular expression.</p><p>Method is able to process breaks in both pattern and replacement strings.</p>
             You should use special meta-characters if you need to work with breaks:
             <ul><li><b>&amp;p</b> - paragraph break</li><li><b>&amp;b</b> - section break</li><li><b>&amp;m</b> - page break</li><li><b>&amp;l</b> - manual line break</li><li><b>&amp;&amp;</b> - &amp; character</li></ul></remarks><DL><DT><B>Parameters:</B></DT><DD param="pattern"><CODE>pattern</CODE> - A regular expression pattern used to find matches.</DD><DD param="replacement"><CODE>replacement</CODE> - A string to replace all occurrences of pattern.</DD><DD param="options"><CODE>options</CODE> - <cref><A HREF="FindReplaceOptions.html" title="class in com.aspose.words">FindReplaceOptions</A></cref> object to specify additional options.</DD></DL><DL><DT><B>Returns:</B></DT><DD returns="">The number of replacements made.</DD></DL><example><p><b>Example:</b></p>Shows how to insert an entire document's contents as a replacement of a match in a find-and-replace operation.<pre>
public void insertDocumentAtReplace() throws Exception {
    Document mainDoc = new Document(getMyDir() + "Document insertion destination.docx");

    // We can use a "FindReplaceOptions" object to modify the find-and-replace process.
    FindReplaceOptions options = new FindReplaceOptions();
    options.setReplacingCallback(new InsertDocumentAtReplaceHandler());

    mainDoc.getRange().replace(Pattern.compile("\\[MY_DOCUMENT\\]"), "", options);
    mainDoc.save(getArtifactsDir() + "InsertDocument.InsertDocumentAtReplace.docx");

}

private static class InsertDocumentAtReplaceHandler implements IReplacingCallback {
    public int replacing(ReplacingArgs args) throws Exception {
        Document subDoc = new Document(getMyDir() + "Document.docx");

        // Insert a document after the paragraph containing the matched text.
        Paragraph para = (Paragraph) args.getMatchNode().getParentNode();
        insertDocument(para, subDoc);

        // Remove the paragraph with the matched text.
        para.remove();

        return ReplaceAction.SKIP;
    }
}

/// &lt;summary&gt;
/// Inserts all the nodes of another document after a paragraph or table.
/// &lt;/summary&gt;
private static void insertDocument(Node insertionDestination, Document docToInsert) {
    if (((insertionDestination.getNodeType()) == (NodeType.PARAGRAPH)) || ((insertionDestination.getNodeType()) == (NodeType.TABLE))) {
        CompositeNode dstStory = insertionDestination.getParentNode();

        NodeImporter importer =
                new NodeImporter(docToInsert, insertionDestination.getDocument(), ImportFormatMode.KEEP_SOURCE_FORMATTING);

        for (Section srcSection : docToInsert.getSections())
            for (Node srcNode : srcSection.getBody()) {
                // Skip the node if it is the last empty paragraph in a section.
                if (((srcNode.getNodeType()) == (NodeType.PARAGRAPH))) {
                    Paragraph para = (Paragraph) srcNode;
                    if (para.isEndOfSection() &amp;&amp; !para.hasChildNodes())
                        continue;
                }

                Node newNode = importer.importNode(srcNode, true);

                dstStory.insertAfter(newNode, insertionDestination);
                insertionDestination = newNode;
            }
    } else {
        throw new IllegalArgumentException("The destination node must be either a paragraph or table.");
    }
}</pre></example><example><p><b>Example:</b></p>Shows how to replace all occurrences of a regular expression pattern with another string, while tracking all such replacements.<pre>
public void replaceWithCallback() throws Exception {
    Document doc = new Document();
    DocumentBuilder builder = new DocumentBuilder(doc);

    builder.writeln("Our new location in New York City is opening tomorrow. " +
            "Hope to see all our NYC-based customers at the opening!");

    // We can use a "FindReplaceOptions" object to modify the find-and-replace process.
    FindReplaceOptions options = new FindReplaceOptions();

    // Set a callback that tracks any replacements that the "Replace" method will make.
    TextFindAndReplacementLogger logger = new TextFindAndReplacementLogger();
    options.setReplacingCallback(logger);

    doc.getRange().replace(Pattern.compile("New York City|NYC"), "Washington", options);

    Assert.assertEquals("Our new location in (Old value:\"New York City\") Washington is opening tomorrow. " +
            "Hope to see all our (Old value:\"NYC\") Washington-based customers at the opening!", doc.getText().trim());

    Assert.assertEquals("\"New York City\" converted to \"Washington\" 20 characters into a 21 node." +
            "\"NYC\" converted to \"Washington\" 42 characters into a 21 node.", logger.getLog().trim());
}

/// &lt;summary&gt;
/// Maintains a log of every text replacement done by a find-and-replace operation
/// and notes the original matched text's value.
/// &lt;/summary&gt;
private static class TextFindAndReplacementLogger implements IReplacingCallback {
    public int replacing(ReplacingArgs args) {
        mLog.append(MessageFormat.format("\"{0}\" converted to \"{1}\" {2} characters into a {3} node.", args.getMatch().group(0), args.getReplacement(), args.getMatchOffset(), args.getMatchNode().getNodeType()));

        args.setReplacement(MessageFormat.format("(Old value:\"{0}\") {1}", args.getMatch().group(0), args.getReplacement()));
        return ReplaceAction.REPLACE;
    }

    public String getLog() {
        return mLog.toString();
    }

    private final StringBuilder mLog = new StringBuilder();
}</pre></example><example><p><b>Example:</b></p><pre>
             Document doc = new Document();
             DocumentBuilder builder = new DocumentBuilder(doc);
             builder.Writeln("a1, b2, c3");
            
             // Replaces each number with paragraph break.
             doc.Range.Replace(new Regex(@"\d+"), "&amp;p", new FindReplaceOptions());
             </pre></example>
</DL>
<HR>

<A NAME="toDocument()"><!-- --></A><A NAME="toDocument--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>toDocument</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public <A HREF="Document.html" title="class in com.aspose.words">Document</A>&nbsp;<B>toDocument</B>()
                   throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Constructs a new fully formed document that contains the range.
            </summary>
</DL>
<HR>

<A NAME="unlinkFields()"><!-- --></A><A NAME="unlinkFields--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>unlinkFields</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>unlinkFields</B>()
                 throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Unlinks fields in this range.
            </summary><remarks><p>Replaces all the fields in this range with their most recent results.</p><p>To unlink fields in the whole document use <cref><i>unlinkFields()</i></cref>.</p></remarks><example><p><b>Example:</b></p>Shows how to unlink all fields in a range.<pre>
Document doc = new Document(getMyDir() + "Linked fields.docx");

Section newSection = (Section) doc.getSections().get(0).deepClone(true);
doc.getSections().add(newSection);

doc.getSections().get(1).getRange().unlinkFields();</pre></example>
</DL>
<HR>

<A NAME="updateFields()"><!-- --></A><A NAME="updateFields--"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>updateFields</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public void&nbsp;<B>updateFields</B>()
                 throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Updates the values of document fields in this range.
             </summary><remarks><p>When you open, modify and then save a document, Aspose.Words does not update fields automatically, it keeps them intact.
Therefore, you would usually want to call this method before saving if you have modified the document
programmatically and want to make sure the proper (calculated) field values appear in the saved document.</p><p>There is no need to update fields after executing a mail merge because mail merge is a kind of field update
and automatically updates all fields in the document.</p><p>This method does not update all field types. For the detailed list of supported field types, see the Programmers Guide.</p><p>This method does not update fields that are related to the page layout algorithms (e.g. PAGE, PAGES, PAGEREF).
The page layout-related fields are updated when you render a document or call <cref><A HREF="Document.html#updatePageLayout()" title="method in class com.aspose.words.Document">Document.updatePageLayout()</A></cref>.</p><p>To update fields in the whole document use <cref><A HREF="Document.html#updateFields()" title="method in class com.aspose.words.Document">Document.updateFields()</A></cref>.</p></remarks><example><p><b>Example:</b></p>Shows how to update all the fields in a range.<pre>
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);

builder.insertField(" DOCPROPERTY Category");
builder.insertBreak(BreakType.SECTION_BREAK_EVEN_PAGE);
builder.insertField(" DOCPROPERTY Category");

// The above DOCPROPERTY fields will display the value of this built-in document property.
doc.getBuiltInDocumentProperties().setCategory("MyCategory");

// If we update the value of a document property, we will need to update all the DOCPROPERTY fields to display it.
Assert.assertEquals("", doc.getRange().getFields().get(0).getResult());
Assert.assertEquals("", doc.getRange().getFields().get(1).getResult());

// Update all the fields that are in the range of the first section.
doc.getFirstSection().getRange().updateFields();

Assert.assertEquals("MyCategory", doc.getRange().getFields().get(0).getResult());
Assert.assertEquals("", doc.getRange().getFields().get(1).getResult());</pre></example>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>