<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
><HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- Generated by javadoc - compatibility string-->
<!-- Generated by Aspose.JavaDoc 19 Jul 2025 -->
<TITLE>FileFormatUtil</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style"></HEAD>
<BODY BGCOLOR="white">
<!-- ======== START OF CLASS DATA ======== -->
<H2><a href="package-summary.html"><FONT SIZE="-1">
com.aspose.words
</FONT></a><BR>Class FileFormatUtil</H2>
<PRE>
java.lang.Object
    <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>com.aspose.words.FileFormatUtil</B>
</PRE>
<HR>
<DL>
<DT><PRE>public abstract class <B>FileFormatUtil </B><DT>extends java.lang.Object</DL>
</PRE>

<P>

<summary>
            Provides utility methods for working with file formats, such as detecting file format
            or converting file extensions to/from file format enums.
            <p>To learn more, visit the <a href="https://docs.aspose.com/words/net/detect-file-format-and-check-format-compatibility/">Detect File Format and Check Format Compatibility</a> documentation article.</p></summary><example><p><b>Example:</b></p>Shows how to detect encoding in an html file.<pre>
FileFormatInfo info = FileFormatUtil.detectFileFormat(getMyDir() + "Document.html");

Assert.assertEquals(LoadFormat.HTML, info.getLoadFormat());

// The Encoding property is used only when we create a FileFormatInfo object for an html document.
Assert.assertEquals("windows-1252", info.getEncoding().name());</pre></example>
<HR>
<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" RULES="GROUPS" FRAME="BOX" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<COLGROUP></COLGROUP><COLGROUP SPAN="2"></COLGROUP><THEAD><TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="3"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR></THEAD>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;int</CODE></TD><TD><CODE><B><A HREF="#contentTypeToLoadFormat(java.lang.String)">contentTypeToLoadFormat</A></B>(java.lang.String&nbsp;contentType)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts IANA content type into a load format enumerated value.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;int</CODE></TD><TD><CODE><B><A HREF="#contentTypeToSaveFormat(java.lang.String)">contentTypeToSaveFormat</A></B>(java.lang.String&nbsp;contentType)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts IANA content type into a save format enumerated value.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;<A HREF="FileFormatInfo.html" title="class in com.aspose.words">FileFormatInfo</A></CODE></TD><TD><CODE><B><A HREF="#detectFileFormat(java.io.InputStream)">detectFileFormat</A></B>(java.io.InputStream&nbsp;stream)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Detects and returns the information about a format of a document stored in a stream.
             </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;<A HREF="FileFormatInfo.html" title="class in com.aspose.words">FileFormatInfo</A></CODE></TD><TD><CODE><B><A HREF="#detectFileFormat(java.lang.String)">detectFileFormat</A></B>(java.lang.String&nbsp;fileName)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
             Detects and returns the information about a format of a document stored in a disk file.
             </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;int</CODE></TD><TD><CODE><B><A HREF="#extensionToSaveFormat(java.lang.String)">extensionToSaveFormat</A></B>(java.lang.String&nbsp;extension)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts a file name extension into a <cref><A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A></cref> value.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;java.lang.String</CODE></TD><TD><CODE><B><A HREF="#imageTypeToExtension(int)">imageTypeToExtension</A></B>(int&nbsp;imageType)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts an Aspose.Words image type enumerated value into a file extension. The returned extension is a lower-case string with a leading dot.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;java.lang.String</CODE></TD><TD><CODE><B><A HREF="#loadFormatToExtension(int)">loadFormatToExtension</A></B>(int&nbsp;loadFormat)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts a load format enumerated value into a file extension. The returned extension is a lower-case string with a leading dot.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;int</CODE></TD><TD><CODE><B><A HREF="#loadFormatToSaveFormat(int)">loadFormatToSaveFormat</A></B>(int&nbsp;loadFormat)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts a <cref><A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A></cref> value to a <cref><A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A></cref> value if possible.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;java.lang.String</CODE></TD><TD><CODE><B><A HREF="#saveFormatToExtension(int)">saveFormatToExtension</A></B>(int&nbsp;saveFormat)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts a save format enumerated value into a file extension. The returned extension is a lower-case string with a leading dot.
            </TD>
</TR></TBODY>

<TBODY><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ROWSPAN="2" ALIGN="right" VALIGN="top" WIDTH="1%">
<CODE>static&nbsp;int</CODE></TD><TD><CODE><B><A HREF="#saveFormatToLoadFormat(int)">saveFormatToLoadFormat</A></B>(int&nbsp;saveFormat)</CODE></TD><TD ALIGN="right" ></TD>
</TR><TR><TD COLSPAN="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Converts a <cref><A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A></cref> value to a <cref><A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A></cref> value if possible.
            </TD>
</TR></TBODY>
</TABLE>&nbsp;<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="contentTypeToLoadFormat(java.lang.String)"><!-- --></A><A NAME="contentTypeToLoadFormat-java.lang.String-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>contentTypeToLoadFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;int&nbsp;<B>contentTypeToLoadFormat</B>(java.lang.String&nbsp;contentType)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts IANA content type into a load format enumerated value.
            </summary><example><p><b>Example:</b></p>Shows how to find the corresponding Aspose load/save format from each media type string.<pre>
// The ContentTypeToSaveFormat/ContentTypeToLoadFormat methods only accept official IANA media type names, also known as MIME types. 
// All valid media types are listed here: https://www.iana.org/assignments/media-types/media-types.xhtml.

// Trying to associate a SaveFormat with a partial media type string will not work.
Assert.assertThrows(IllegalArgumentException.class, () -&gt; FileFormatUtil.contentTypeToSaveFormat("jpeg"));

// If Aspose.Words does not have a corresponding save/load format for a content type, an exception will also be thrown.
Assert.assertThrows(IllegalArgumentException.class, () -&gt; FileFormatUtil.contentTypeToSaveFormat("application/zip"));

// Files of the types listed below can be saved, but not loaded using Aspose.Words.
Assert.assertThrows(IllegalArgumentException.class, () -&gt; FileFormatUtil.contentTypeToLoadFormat("image/jpeg"));

Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("image/jpeg"), SaveFormat.JPEG);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("image/png"), SaveFormat.PNG);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("image/tiff"), SaveFormat.TIFF);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("image/gif"), SaveFormat.GIF);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("image/x-emf"), SaveFormat.EMF);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("application/vnd.ms-xpsdocument"), SaveFormat.XPS);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("application/pdf"), SaveFormat.PDF);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("image/svg+xml"), SaveFormat.SVG);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("application/epub+zip"), SaveFormat.EPUB);

// For file types that can be saved and loaded, we can match a media type to both a load format and a save format.
Assert.assertEquals(FileFormatUtil.contentTypeToLoadFormat("application/msword"), LoadFormat.DOC);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("application/msword"), SaveFormat.DOC);

Assert.assertEquals(FileFormatUtil.contentTypeToLoadFormat("application/vnd.openxmlformats-officedocument.wordprocessingml.document"), LoadFormat.DOCX);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("application/vnd.openxmlformats-officedocument.wordprocessingml.document"), SaveFormat.DOCX);

Assert.assertEquals(FileFormatUtil.contentTypeToLoadFormat("text/plain"), LoadFormat.TEXT);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("text/plain"), SaveFormat.TEXT);

Assert.assertEquals(FileFormatUtil.contentTypeToLoadFormat("application/rtf"), LoadFormat.RTF);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("application/rtf"), SaveFormat.RTF);

Assert.assertEquals(FileFormatUtil.contentTypeToLoadFormat("text/html"), LoadFormat.HTML);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("text/html"), SaveFormat.HTML);

Assert.assertEquals(FileFormatUtil.contentTypeToLoadFormat("multipart/related"), LoadFormat.MHTML);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("multipart/related"), SaveFormat.MHTML);</pre></example>
</DL>
<HR>

<A NAME="contentTypeToSaveFormat(java.lang.String)"><!-- --></A><A NAME="contentTypeToSaveFormat-java.lang.String-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>contentTypeToSaveFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;int&nbsp;<B>contentTypeToSaveFormat</B>(java.lang.String&nbsp;contentType)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts IANA content type into a save format enumerated value.
            </summary><example><p><b>Example:</b></p>Shows how to find the corresponding Aspose load/save format from each media type string.<pre>
// The ContentTypeToSaveFormat/ContentTypeToLoadFormat methods only accept official IANA media type names, also known as MIME types. 
// All valid media types are listed here: https://www.iana.org/assignments/media-types/media-types.xhtml.

// Trying to associate a SaveFormat with a partial media type string will not work.
Assert.assertThrows(IllegalArgumentException.class, () -&gt; FileFormatUtil.contentTypeToSaveFormat("jpeg"));

// If Aspose.Words does not have a corresponding save/load format for a content type, an exception will also be thrown.
Assert.assertThrows(IllegalArgumentException.class, () -&gt; FileFormatUtil.contentTypeToSaveFormat("application/zip"));

// Files of the types listed below can be saved, but not loaded using Aspose.Words.
Assert.assertThrows(IllegalArgumentException.class, () -&gt; FileFormatUtil.contentTypeToLoadFormat("image/jpeg"));

Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("image/jpeg"), SaveFormat.JPEG);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("image/png"), SaveFormat.PNG);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("image/tiff"), SaveFormat.TIFF);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("image/gif"), SaveFormat.GIF);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("image/x-emf"), SaveFormat.EMF);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("application/vnd.ms-xpsdocument"), SaveFormat.XPS);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("application/pdf"), SaveFormat.PDF);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("image/svg+xml"), SaveFormat.SVG);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("application/epub+zip"), SaveFormat.EPUB);

// For file types that can be saved and loaded, we can match a media type to both a load format and a save format.
Assert.assertEquals(FileFormatUtil.contentTypeToLoadFormat("application/msword"), LoadFormat.DOC);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("application/msword"), SaveFormat.DOC);

Assert.assertEquals(FileFormatUtil.contentTypeToLoadFormat("application/vnd.openxmlformats-officedocument.wordprocessingml.document"), LoadFormat.DOCX);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("application/vnd.openxmlformats-officedocument.wordprocessingml.document"), SaveFormat.DOCX);

Assert.assertEquals(FileFormatUtil.contentTypeToLoadFormat("text/plain"), LoadFormat.TEXT);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("text/plain"), SaveFormat.TEXT);

Assert.assertEquals(FileFormatUtil.contentTypeToLoadFormat("application/rtf"), LoadFormat.RTF);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("application/rtf"), SaveFormat.RTF);

Assert.assertEquals(FileFormatUtil.contentTypeToLoadFormat("text/html"), LoadFormat.HTML);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("text/html"), SaveFormat.HTML);

Assert.assertEquals(FileFormatUtil.contentTypeToLoadFormat("multipart/related"), LoadFormat.MHTML);
Assert.assertEquals(FileFormatUtil.contentTypeToSaveFormat("multipart/related"), SaveFormat.MHTML);</pre></example>
</DL>
<HR>

<A NAME="detectFileFormat(java.io.InputStream)"><!-- --></A><A NAME="detectFileFormat-java.io.InputStream-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>detectFileFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;<A HREF="FileFormatInfo.html" title="class in com.aspose.words">FileFormatInfo</A>&nbsp;<B>detectFileFormat</B>(java.io.InputStream&nbsp;stream)
                                           throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Detects and returns the information about a format of a document stored in a stream.
             </summary><remarks><p>The stream must be positioned at the beginning of the document.</p><p>Detecting a file format might require seeking to various positions in the stream. Because java.io.InputStream
             is not seekable, this method loads the whole stream into memory temporarily. When this method returns,
             the stream is positioned at the end of the document.</p><p>Even if this method detects the document format, it does not guarantee
             that the specified document is valid. This method only detects the document format by
             reading data that is sufficient for detection. To fully verify that a document is valid
             you need to load the document into a <cref><A HREF="Document.html" title="class in com.aspose.words">Document</A></cref> object.</p><p>This method throws <cref><A HREF="FileCorruptedException.html" title="class in com.aspose.words">FileCorruptedException</A></cref> when the format is
             recognized, but the detection cannot complete because of corruption.</p></remarks><DL><DT><B>Parameters:</B></DT><DD param="stream"><CODE>stream</CODE> - The stream.</DD></DL><DL><DT><B>Returns:</B></DT><DD returns="">A <cref><A HREF="FileFormatInfo.html" title="class in com.aspose.words">FileFormatInfo</A></cref> object that contains the detected information.</DD></DL><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil methods to detect the format of a document.<pre>
// Load a document from a file that is missing a file extension, and then detect its file format.
FileInputStream docStream = new FileInputStream(getMyDir() + "Word document with missing file extension");

FileFormatInfo info = FileFormatUtil.detectFileFormat(docStream);
/*LoadFormat*/
int loadFormat = info.getLoadFormat();

Assert.assertEquals(LoadFormat.DOC, loadFormat);

// Below are two methods of converting a LoadFormat to its corresponding SaveFormat.
// 1 -  Get the file extension string for the LoadFormat, then get the corresponding SaveFormat from that string:
String fileExtension = FileFormatUtil.loadFormatToExtension(loadFormat);
/*SaveFormat*/
int saveFormat = FileFormatUtil.extensionToSaveFormat(fileExtension);

// 2 -  Convert the LoadFormat directly to its SaveFormat:
saveFormat = FileFormatUtil.loadFormatToSaveFormat(loadFormat);

// Load a document from the stream, and then save it to the automatically detected file extension.
Document doc = new Document(docStream);

Assert.assertEquals(".doc", FileFormatUtil.saveFormatToExtension(saveFormat));

doc.save(getArtifactsDir() + "File.SaveToDetectedFileFormat" + FileFormatUtil.saveFormatToExtension(saveFormat));</pre></example>
</DL>
<HR>

<A NAME="detectFileFormat(java.lang.String)"><!-- --></A><A NAME="detectFileFormat-java.lang.String-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>detectFileFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;<A HREF="FileFormatInfo.html" title="class in com.aspose.words">FileFormatInfo</A>&nbsp;<B>detectFileFormat</B>(java.lang.String&nbsp;fileName)
                                           throws java.lang.Exception</PRE></TD></TR></TABLE>
<DL><DD><summary>
             Detects and returns the information about a format of a document stored in a disk file.
             </summary><remarks><p>Even if this method detects the document format, it does not guarantee
             that the specified document is valid. This method only detects the document format by
             reading data that is sufficient for detection. To fully verify that a document is valid
             you need to load the document into a <cref><A HREF="Document.html" title="class in com.aspose.words">Document</A></cref> object.</p><p>This method throws <cref><A HREF="FileCorruptedException.html" title="class in com.aspose.words">FileCorruptedException</A></cref> when the format is
             recognized, but the detection cannot complete because of corruption.</p></remarks><DL><DT><B>Parameters:</B></DT><DD param="fileName"><CODE>fileName</CODE> - The file name.</DD></DL><DL><DT><B>Returns:</B></DT><DD returns="">A <cref><A HREF="FileFormatInfo.html" title="class in com.aspose.words">FileFormatInfo</A></cref> object that contains the detected information.</DD></DL><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil class to detect the document format and presence of digital signatures.<pre>
// Use a FileFormatInfo instance to verify that a document is not digitally signed.
FileFormatInfo info = FileFormatUtil.detectFileFormat(getMyDir() + "Document.docx");

Assert.assertEquals(".docx", FileFormatUtil.loadFormatToExtension(info.getLoadFormat()));
Assert.assertFalse(info.hasDigitalSignature());

CertificateHolder certificateHolder = CertificateHolder.create(getMyDir() + "morzal.pfx", "aw", null);
DigitalSignatureUtil.sign(getMyDir() + "Document.docx", getArtifactsDir() + "File.DetectDigitalSignatures.docx",
        certificateHolder);

// Use a new FileFormatInstance to confirm that it is signed.
info = FileFormatUtil.detectFileFormat(getArtifactsDir() + "File.DetectDigitalSignatures.docx");

Assert.assertTrue(info.hasDigitalSignature());

// We can load and access the signatures of a signed document in a collection like this.
Assert.assertEquals(1, DigitalSignatureUtil.loadSignatures(getArtifactsDir() + "File.DetectDigitalSignatures.docx").getCount());</pre></example><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil class to detect the document format and encryption.<pre>
Document doc = new Document();

// Configure a SaveOptions object to encrypt the document
// with a password when we save it, and then save the document.
OdtSaveOptions saveOptions = new OdtSaveOptions(SaveFormat.ODT);
saveOptions.setPassword("MyPassword");

doc.save(getArtifactsDir() + "File.DetectDocumentEncryption.odt", saveOptions);

// Verify the file type of our document, and its encryption status.
FileFormatInfo info = FileFormatUtil.detectFileFormat(getArtifactsDir() + "File.DetectDocumentEncryption.odt");

Assert.assertEquals(".odt", FileFormatUtil.loadFormatToExtension(info.getLoadFormat()));
Assert.assertTrue(info.isEncrypted());</pre></example>
</DL>
<HR>

<A NAME="extensionToSaveFormat(java.lang.String)"><!-- --></A><A NAME="extensionToSaveFormat-java.lang.String-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>extensionToSaveFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;int&nbsp;<B>extensionToSaveFormat</B>(java.lang.String&nbsp;extension)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts a file name extension into a <cref><A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A></cref> value.
            </summary><remarks><p>If the extension cannot be recognized, returns <cref><A HREF="SaveFormat.html#UNKNOWN" title="field in class com.aspose.words.SaveFormat">SaveFormat.UNKNOWN</A></cref>.</p></remarks><DL><DT><B>Parameters:</B></DT><DD param="extension"><CODE>extension</CODE> - The file extension. Can be with or without a leading dot. Case-insensitive.</DD></DL><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil methods to detect the format of a document.<pre>
// Load a document from a file that is missing a file extension, and then detect its file format.
FileInputStream docStream = new FileInputStream(getMyDir() + "Word document with missing file extension");

FileFormatInfo info = FileFormatUtil.detectFileFormat(docStream);
/*LoadFormat*/
int loadFormat = info.getLoadFormat();

Assert.assertEquals(LoadFormat.DOC, loadFormat);

// Below are two methods of converting a LoadFormat to its corresponding SaveFormat.
// 1 -  Get the file extension string for the LoadFormat, then get the corresponding SaveFormat from that string:
String fileExtension = FileFormatUtil.loadFormatToExtension(loadFormat);
/*SaveFormat*/
int saveFormat = FileFormatUtil.extensionToSaveFormat(fileExtension);

// 2 -  Convert the LoadFormat directly to its SaveFormat:
saveFormat = FileFormatUtil.loadFormatToSaveFormat(loadFormat);

// Load a document from the stream, and then save it to the automatically detected file extension.
Document doc = new Document(docStream);

Assert.assertEquals(".doc", FileFormatUtil.saveFormatToExtension(saveFormat));

doc.save(getArtifactsDir() + "File.SaveToDetectedFileFormat" + FileFormatUtil.saveFormatToExtension(saveFormat));</pre></example>
</DL>
<HR>

<A NAME="imageTypeToExtension(int)"><!-- --></A><A NAME="imageTypeToExtension-int-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>imageTypeToExtension</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;java.lang.String&nbsp;<B>imageTypeToExtension</B>(int&nbsp;imageType)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts an Aspose.Words image type enumerated value into a file extension. The returned extension is a lower-case string with a leading dot.
            </summary><DL><DT><B>Parameters:</B></DT><DD><CODE>imageType</CODE> - A <A HREF="ImageType.html" title="Utility class in com.aspose.words">ImageType</A> value.</DD></DL><example><p><b>Example:</b></p>Shows how to extract images from a document, and save them to the local file system as individual files.<pre>
Document doc = new Document(getMyDir() + "Images.docx");

// Get the collection of shapes from the document,
// and save the image data of every shape with an image as a file to the local file system.
NodeCollection shapes = doc.getChildNodes(NodeType.SHAPE, true);

int imageIndex = 0;
for (Shape shape : (Iterable&lt;Shape&gt;) shapes) {
    if (shape.hasImage()) {
        // The image data of shapes may contain images of many possible image formats. 
        // We can determine a file extension for each image automatically, based on its format.
        String imageFileName = MessageFormat.format("File.ExtractImages.{0}{1}", imageIndex, FileFormatUtil.imageTypeToExtension(shape.getImageData().getImageType()));
        shape.getImageData().save(getArtifactsDir() + imageFileName);
        imageIndex++;
    }
}</pre></example>
</DL>
<HR>

<A NAME="loadFormatToExtension(int)"><!-- --></A><A NAME="loadFormatToExtension-int-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>loadFormatToExtension</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;java.lang.String&nbsp;<B>loadFormatToExtension</B>(int&nbsp;loadFormat)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts a load format enumerated value into a file extension. The returned extension is a lower-case string with a leading dot.
            </summary><remarks><p>The <cref><A HREF="SaveFormat.html#WORD_ML" title="field in class com.aspose.words.SaveFormat">SaveFormat.WORD_ML</A></cref> value is converted to ".wml".</p></remarks><DL><DT><B>Parameters:</B></DT><DD><CODE>loadFormat</CODE> - A <A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A> value.</DD></DL><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil methods to detect the format of a document.<pre>
// Load a document from a file that is missing a file extension, and then detect its file format.
FileInputStream docStream = new FileInputStream(getMyDir() + "Word document with missing file extension");

FileFormatInfo info = FileFormatUtil.detectFileFormat(docStream);
/*LoadFormat*/
int loadFormat = info.getLoadFormat();

Assert.assertEquals(LoadFormat.DOC, loadFormat);

// Below are two methods of converting a LoadFormat to its corresponding SaveFormat.
// 1 -  Get the file extension string for the LoadFormat, then get the corresponding SaveFormat from that string:
String fileExtension = FileFormatUtil.loadFormatToExtension(loadFormat);
/*SaveFormat*/
int saveFormat = FileFormatUtil.extensionToSaveFormat(fileExtension);

// 2 -  Convert the LoadFormat directly to its SaveFormat:
saveFormat = FileFormatUtil.loadFormatToSaveFormat(loadFormat);

// Load a document from the stream, and then save it to the automatically detected file extension.
Document doc = new Document(docStream);

Assert.assertEquals(".doc", FileFormatUtil.saveFormatToExtension(saveFormat));

doc.save(getArtifactsDir() + "File.SaveToDetectedFileFormat" + FileFormatUtil.saveFormatToExtension(saveFormat));</pre></example>
</DL>
<HR>

<A NAME="loadFormatToSaveFormat(int)"><!-- --></A><A NAME="loadFormatToSaveFormat-int-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>loadFormatToSaveFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;int&nbsp;<B>loadFormatToSaveFormat</B>(int&nbsp;loadFormat)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts a <cref><A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A></cref> value to a <cref><A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A></cref> value if possible.
            </summary><DL><DT><B>Parameters:</B></DT><DD><CODE>loadFormat</CODE> - A <A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A> value.</DD></DL><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil methods to detect the format of a document.<pre>
// Load a document from a file that is missing a file extension, and then detect its file format.
FileInputStream docStream = new FileInputStream(getMyDir() + "Word document with missing file extension");

FileFormatInfo info = FileFormatUtil.detectFileFormat(docStream);
/*LoadFormat*/
int loadFormat = info.getLoadFormat();

Assert.assertEquals(LoadFormat.DOC, loadFormat);

// Below are two methods of converting a LoadFormat to its corresponding SaveFormat.
// 1 -  Get the file extension string for the LoadFormat, then get the corresponding SaveFormat from that string:
String fileExtension = FileFormatUtil.loadFormatToExtension(loadFormat);
/*SaveFormat*/
int saveFormat = FileFormatUtil.extensionToSaveFormat(fileExtension);

// 2 -  Convert the LoadFormat directly to its SaveFormat:
saveFormat = FileFormatUtil.loadFormatToSaveFormat(loadFormat);

// Load a document from the stream, and then save it to the automatically detected file extension.
Document doc = new Document(docStream);

Assert.assertEquals(".doc", FileFormatUtil.saveFormatToExtension(saveFormat));

doc.save(getArtifactsDir() + "File.SaveToDetectedFileFormat" + FileFormatUtil.saveFormatToExtension(saveFormat));</pre></example>
</DL>
<HR>

<A NAME="saveFormatToExtension(int)"><!-- --></A><A NAME="saveFormatToExtension-int-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>saveFormatToExtension</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;java.lang.String&nbsp;<B>saveFormatToExtension</B>(int&nbsp;saveFormat)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts a save format enumerated value into a file extension. The returned extension is a lower-case string with a leading dot.
            </summary><remarks><p>The <cref><A HREF="SaveFormat.html#WORD_ML" title="field in class com.aspose.words.SaveFormat">SaveFormat.WORD_ML</A></cref> value is converted to ".wml".</p><p>The <cref><A HREF="SaveFormat.html#FLAT_OPC" title="field in class com.aspose.words.SaveFormat">SaveFormat.FLAT_OPC</A></cref> value is converted to ".fopc".</p></remarks><DL><DT><B>Parameters:</B></DT><DD><CODE>saveFormat</CODE> - A <A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A> value.</DD></DL><example><p><b>Example:</b></p>Shows how to use the FileFormatUtil methods to detect the format of a document.<pre>
// Load a document from a file that is missing a file extension, and then detect its file format.
FileInputStream docStream = new FileInputStream(getMyDir() + "Word document with missing file extension");

FileFormatInfo info = FileFormatUtil.detectFileFormat(docStream);
/*LoadFormat*/
int loadFormat = info.getLoadFormat();

Assert.assertEquals(LoadFormat.DOC, loadFormat);

// Below are two methods of converting a LoadFormat to its corresponding SaveFormat.
// 1 -  Get the file extension string for the LoadFormat, then get the corresponding SaveFormat from that string:
String fileExtension = FileFormatUtil.loadFormatToExtension(loadFormat);
/*SaveFormat*/
int saveFormat = FileFormatUtil.extensionToSaveFormat(fileExtension);

// 2 -  Convert the LoadFormat directly to its SaveFormat:
saveFormat = FileFormatUtil.loadFormatToSaveFormat(loadFormat);

// Load a document from the stream, and then save it to the automatically detected file extension.
Document doc = new Document(docStream);

Assert.assertEquals(".doc", FileFormatUtil.saveFormatToExtension(saveFormat));

doc.save(getArtifactsDir() + "File.SaveToDetectedFileFormat" + FileFormatUtil.saveFormatToExtension(saveFormat));</pre></example>
</DL>
<HR>

<A NAME="saveFormatToLoadFormat(int)"><!-- --></A><A NAME="saveFormatToLoadFormat-int-"><!-- --></A>
<TABLE WIDTH="100%" CELLPADDING="3" CELLSPACING="0" ><TR><TD><H3>saveFormatToLoadFormat</H3></TD><TD ALIGN="right" VALIGN="top"></TD></TR>
<TR><TD COLSPAN="2"><PRE>
public static&nbsp;int&nbsp;<B>saveFormatToLoadFormat</B>(int&nbsp;saveFormat)</PRE></TD></TR></TABLE>
<DL><DD><summary>
            Converts a <cref><A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A></cref> value to a <cref><A HREF="LoadFormat.html" title="Utility class in com.aspose.words">LoadFormat</A></cref> value if possible.
            </summary><DL><DT><B>Parameters:</B></DT><DD><CODE>saveFormat</CODE> - A <A HREF="SaveFormat.html" title="Utility class in com.aspose.words">SaveFormat</A> value.</DD></DL><example><p><b>Example:</b></p>Shows how to convert a save format to its corresponding load format.<pre>
Assert.assertEquals(LoadFormat.HTML, FileFormatUtil.saveFormatToLoadFormat(SaveFormat.HTML));

// Some file types can have documents saved to, but not loaded from using Aspose.Words.
// If we attempt to convert a save format of such a type to a load format, an exception will be thrown.
Assert.assertThrows(IllegalArgumentException.class, () -&gt; FileFormatUtil.saveFormatToLoadFormat(SaveFormat.JPEG));</pre></example>
</DL>
<HR>

<B>See Also:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Products/Aspose.Words/Api/index.html" TARGET="_blank">Aspose.Words Documentation</A> - the home page for the Aspose.Words Product Documentation.<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A href="http://www.aspose.com/Community/forums/ShowForum.aspx?ForumID=75" TARGET="_blank">Aspose.Words Support Forum</A> - our preferred method of support.<P>
<div class="footer"><hr><p><a href='http://www.aspose.com/Wiki/default.aspx/Aspose.Corporate/ContactAspose.html'>We guarantee a prompt response to any inquiry!</a></p><p>&copy; 2003-2007 Aspose Pty Ltd. All rights reserved.</p></div></BODY></HTML>